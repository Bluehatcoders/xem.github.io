<!doctype html>
<html>
<head>
  <meta charset=utf-8>
  <link rel=stylesheet href="../style.css">
  <title>Maxime Euzière</title>
</head>
<body>
  <div class=menu>
    <div class=header>
      <h1>Maxime Euzière</h1>
      Front-end experiments
      <br>
      HTML / CSS / JS
      <br>
      <br>
      <a href="../index.html">Home</a>
      <a href="../articles" class=active>Articles</a>
      <a href="../techwatch">Tech watch</a>
      <a href="../projects">Projects / experiments</a>
      <a href="../talks">Talks</a>
      <a href="../golfing">JS Code golfing</a>
      <a href="../other">Other stuff</a>
    </div>
    <div class=footer>© <script type="text/javascript">document.write(new Date().getFullYear())</script> - <a href="//github.com/xem" target=_blank>Github</a> - <a href="../cv/cv-en.html" target=_blank>CV</a></div>
  </div>
  <div class=aside>
    <h2>Summary</h2>
    <ul>
      <li><a href='#fatigue'>Shitty systems fatigue</a>
      <li><a href='#webgl_quest'>WebGL quest</a>
      <li><a href='#js1k2016'>JS1k 2016</a>
      <li><a href='#obfuscatweet_url_en'>Obfusc-a-tweet reloaded</a>
      <li><a href='#js13k2015'>JS13kGames 2015</a>
      <li><a href='#js1k2015'>JS1k 2015</a>
      <li><a href='#js13k2014'>JS13k 2014</a>
      <li><a href='#dom'>DOM oddities</a>
      <li><a href='#js1k_2pgames'>JS1k'14: 2P Games</a>
      <li><a href='#js1k_floppydragon'>JS1k 2014</a>
      <li><a href='#implicitgetelementbyid_en'>getElementById</a>
      <li><a href='#textshadows_en'>Text-shadows</a>
      <li><a href='#lists_en'>Lists</a>
      <li><a href='#contenteditable_en'>Contenteditable</a>
      <li><a href='#doctype_fr'>Doctype</a>
    </ul>
  </div>
  <div class=body>

  
<div class=section id=fatigue>
  <h2>Shitty systems & superfluous hacking fatigue</h2>
  <b>or: How we waste most of our lives struggling to obtain the most basic features from overly complicated and badly designed systems</b>
	<h3>june 2016</h3>
  <p>For once, this isn't a regular front-end blog post. It's a rant post, complaining about the fatigue of having to hack our way through the shitty systems that surround us more and more everyday. Heck, I'm an old engineer, I'm used to shitty systems. My work even consists in dealing with some of the most shitty systems out there: Web browsers. But today, I'll complain about what they call "smart" phones. Warning: curses inside.
  <p>I won't mention my own phone, as it's a Lumia 735 that comes from a batch built with some shitty component that makes it <a href="https://www.google.com/search?q=lumia+735+reboot&ie=utf-8&oe=utf-8&client=firefox-b-ab">reboot randomly</a>, and which is not even capable of installing or updating any application since I (painfully) installed Windows 10 on it. So I'm already screwed in this domain.
  <p>But as every engineer, I have relatives that think it's my job to "know these things" and my passion to make them work.
  <p>Anyway, my mom has a relatively new Samsung Galaxy S5 Mini smartphone, running on Android 4.4. She makes a very basic usage of it, besides calling people: she takes a ton of pictures, "edits" them through the Google Photos app and posts them on Facebook.
  <p>It all began when she wanted "more memory", translate: more space to store the photos on the phone, even if they're backed up in the cloud. Sure, whatever, a 64GB Samsung microSD card is less than 25€ nowadays, so let's buy one and install it.
  <p>Rightaway, I try to use my PC to transfer all the photos from the internal 16GB memory to the microSD card... For some reason, i'm not allowed to do it, and have to use the embedded shitty file explorer to do it directly on the phone. It takes hours, and in the process, changes the creation date of every file to the present day, which results in many albums being mixed up in Google Photos. Screw you, file explorer. 
  <p>Fast forward a few days, I get a complaint that the phone freezes every couple hours, and that Google Photos pops a write error everytime we try to edit a photo and save it. And since I'm the last one who touched it, It's my fault, obviously.
  <p>So I take the phone back and try to figure out what the fuck is shittening... After a long search, it turns out this version of Android has a default setting that locks writes on the MicroSD card for most non-native applications, for the user's safety or some shit like that. That's why the default camera app could take pictures and save them on the card, but Google Photos, installed via the Play Store, couldn't edit them in place. And even if I have no proof, I'm pretty certain that Google Photos provoked some sort of memory leak because of this card lock, which was responsible of the freezes. But I digress. Also, I won't mention the fact that an OS made by Google forbids an application made by Google to write on my SD card for my safety, because fuck logic.
  <p>Before going further, I take a look at the "firmware update" page of the phone settings, which tells me that a 900MB update to Android 5 is downloaded and ready to install, but every attempt to start the upgrade fails lamentably and there's no solution. WHATEVER. 
  <p>Okay so how can I disable this default SD lock on 4.4? Turns out, it's just a matter of setting a value to "true" in a XML file stored in the system partition of the phone. But it would be too simple if this partition was visible with a file explorer or a PC. No, I have to install one of the dozens "SD unlock" apps of the Play Store, which will do that for me.
  <p>But here's the joke, all those apps weigh a few MB and require something called "root access". Yes. All that, just to edit a fucking line in a fucking XML file. Okay whatever Google, tell me how I can root your shitty OS, I'm tired now.
  <p>Rooting an S5 Mini, for some reason, is not as easy as any other fucking Android phone. On this one, the regular rooting solutions fail, and tell me to try somewhere else, generally redirecting me to a Windows software with better success rates.
  <p>I plug the phone to my laptop using the mini-USB data cable of my Windows Phone (that's the only one I have on me)... Error: Unrecognized peripheral. Moving to the USB3 port... it works. ah, no. Ah, yes. Ah, no. this motherfucker blinks, and alternates between connected and disconnected every second. The fuck! Root tutorials tell me to install a fork of the Samsung USB drivers without some shitty adware that they include in every exe... impossible to find a live download link. Fuck it, I install the official drivers. It changes nothing. FUCK. Just to be sure, I borrow a genuine Samsung mini-USB data cable... oh. well, it seems to work, but I wouldn't call it stable (still makes some disconnection blinks every minute or so.) Modern Android systems don't behave like a hard drive when connected to a PC but use another shitty "multimedia storage" protocol that seem to be the reason why it's so unstable. Whatever I try, I gotta do it very quickly. I start KingoRoot (the only software that seems genuine in the middle of all the scams), and it tells me to enable the "USB debugging" feature of my phone.
  <p>Huh? No USB debugging in the settings.
  <p>- Me: "Google, WTF?"
  <br>- Google: "USB debugging is in the developper settings ( ͡° ͜ʖ ͡°)".
  <br>- Me: "Oh okay, cool... wait, Google, where are the developper settings?"
  <br>- Google: "They're hidden, for your safety ( ͡° ͜ʖ ͡°)".
  <br>- Me: "FUCK YOU GOOGLE, HOW DO I SHOW THEM?"
  <br>- Google: "Go in System Settings and tap eight times the 'version number' line ( ͡° ͜ʖ ͡°)".
  <br>- Me: "(╯°□°)╯︵ ┻━┻".
  <br>- Google: "¯\_(ツ)_/¯"
  <p>A few minutes later, KingoRoot agrees to start working, and at 70%, the phone restarts. Wait, what? Is that part of the process? Of course not. KingoRoot hangs, the phone reboots half-rooted, which is as useful as no rooted at all.
  <p>Second try: plug the phone, launch KingoRoot, wait until 100%, and both KingoRoot and the phone tell me victoriously that the root has been successful... ly... removed. THE FUCK? all it did was removing the previous root attempt.
  <p>Third try: Same process, it arrives to 100%, and this time it tells me that it seems to have worked.
  <p>I launch the SD unlock app, it asks me the permission to request root access, I say OK, it says "processing...", then "Failed. Your phone may not be rooted.". EAT MY ASS, PHONE!
  <p>I install and launch another 25MB (!) app called Root Checker whose only purpose is to tell me if my phone is rooted, and the answer is yes. GODDAMMIT.
  <p>I retry the SD unlock app, allow it to ask root access, "processing...", and then it tells me that it's sorry but my XML file has already been successfully edited. GO BURN IN HELL, APP.
  <p>I finally made it, after hours of shitty hacking. Hours of my life wasted because of shitty systems, with shitty protections, shitty drivers, shitty protocols and shitty error handling. And it's not the first time something like that happens to me or to someone I know! But apart from tiring the hell out of me, this adventure made me wonder...
  <p>How could a non-engineer, or someone who doesn't have an entire day to waste could have resolved this problem? How could my mother could have done one percent of what I did? She doesn't even have a computer! Are non-tech-savvy people doomed to live with more and more buggy products? Will they soon be rejected by the society, where only the best hackers will be able to make modern devices work? Will we reach a point where even the best hackers, or the people who make these systems, won't event be able to use them?
  <p>Or will there be a savior, a company that builds better systems than Google, Apple and Windows, systems that just work, without any hack? Free startup idea for you, guys! How about me? I won this battle, but the shit-hack fatigue got me. I'm gonna live in the wood and tame goats. See ya.
  <p><b>Xem</b>
</div>


<div class=section id=webgl_quest>
  <h2>The quest of the 🌍🔬🕸🇬🇱🎠 (World's Smallest WebGL Playground)</h2>
	<h3>april to june 2016</h3>
  <p>During the last few weeks, the codegolf team (including Mathieu 'p01' Henri, Martin 'Aemkei' Kleppe, Subzey, Anders Kaare, ...) has welcomed new members (Elias Schütt & HellMood, authors of JS1K 2016 winning entry <a href="http://js1k.com/2016-elemental/demo/2552">Romanesco 2.0</a>) and gave itself a nice challenge: develop the smallest possible HTML/JS (ES6) boilerplate that's able to run a WebGL fragment shader. It's currently as short as <b>349b</b>, and looks like this:
  <pre class=code style=padding:5px>&lt;canvas id=a>&lt;svg onload='for(i in g=a.getContext`webgl`)g[i[0]+i[6]]=g[i];with(g)vA(P=cP(setInterval(x=>dr(6,vertexAttrib1f(1,NO++),3),A=s=>sS(S=cS(FN++),id+"varying lowp vec4 p,t;void main(){gl_"+s)|ce(S)|!aS(P,S))),2,5120,bD(B=ET-3,Int8Array.of(A`FragColor=<b>[SHADER]</b>}`,B,!eV(bf(B,cB(id="attribute vec4 P,T;"))),A`Position=p=P;t=T;}`),B+82),!lo(P),ug(P))'></pre>
  <p>See <a href=#webgl_detailed_code>detailed source code</a> below!
  <p>With this boilerplate, you have access to a time counter <b>t.x</b> (a frame counter), the clip space coordinates <b>c</b> (representing gl_PointCoord), and all you need to do is replace <b>[SHADER]</b> with the value set by your shader to gl_FragColor, for example: <b style=background:#def>p+sin(atan(p.y,p.x)*9.)*sin(p*t.x/40.+9./dot(p,p)+t.x/40.);</b> (<a href=demos/webgl/psych.html>DEMO</a>).
  <p><u>Optional:</u>
  <p>- You can set the size of the canvas with things like <b style=background:#def>a.width=a.height=600;</b> or <b style=background:#def>a.width=outerWidth;a.height=outerHeight;</b> at the beinning of the JS code.
  <br>- You can change the animation speed by changing the way t is incremented, <b>NO+=.1</b> (t incremented by 0.1 at each frame) is often a better trade-off than <b>NO++</b> (t incremented by 1 at each frame).
  <p>Here are <a href="http://dev.elias.media/MiniShadertoy/">some gorgeous demos</a> made by Elias, with this template, in less than 512b.
  <p><a href="http://dev.elias.media/MiniShadertoy/"><img src="./images/webgl/elias.jpg" width=600 style="border:1px solid"></a>
  <p>For code-golfers and demosceners, this boilerplate offers a total of 163b dedicated to the shader in a 512b demo (or 675b in a 1kb demo, not counting the gain of RegPack or gzip): more than never before in the history of WebGL demo'ing!
  <br>
  <br>
  <hr>
  <br>
  <h3>Making-of & Interactive playground</h3>
  <p>Between 2014 and 2015, it took us nearly 60 golfing iterations to make the Codepen clone <a href="//xem.github.io/miniCodeEditor">miniCodeEditor</a> fit in 158b. Since then, I talked with Subzey and wondered if we could do something similar with WebGL, maybe a clone of <a href="//shadertoy.com">Shadertoy</a>. I tried many times to understand / simplify the source code of shadertoy, but it was too big and too complex (694kb of JS, with 148kb really dedicated to the app's engine.)
  <p>So I reversed the problem and decided to start from a finished, milimalist WebGL demo and try to make it editable, like on ShaderToy.
  <p>WebGL implementation is very (very) cryptic, but by chance, Elias's post-mortem gave me all the keys to get started.
  <blockquote class="twitter-tweet" data-lang="fr"><p lang="en" dir="ltr"><a href="https://twitter.com/elias_schuett">@elias_schuett</a> <a href="https://twitter.com/subzey">@subzey</a> well, this answers our questions about WebGL golfing. Thank for the post mortem! :)</p>&mdash; xem (@MaximeEuziere) <a href="https://twitter.com/MaximeEuziere/status/723863692245258240">23 avril 2016</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
  <p>As a result, we managed to release, and golf <a href="//xem.github.io/MiniShadertoy">MiniShadertoy</a>, including almost all the features of Shadertoy in less than 1kb...
   <br>
  <br>
  <img src="./images/webgl/minishadertoy.jpg" width=600>
  <br>
  <p>and then <a href="//xem.github.io/MiniShadertoyLite">MiniShadertoyLite</a>, allowing to fiddle with just a fragment shader in less than 512b.
  <br>
  <br>
  <img src="./images/webgl/minishadertoylite.jpg" width=600>
  <br>
  <p>While we were discussing about it, and how we could golf it even better, Aemkei had the idea to make a "static" boilerplate, basically the same thing as MiniShadertoy, but not editable. Just the strict minimum required to play a hardcoded shader.
  <p><br><a href="https://jsbin.com/qafebosibu/edit?html,output"><img src="./images/webgl/boilerplate.png" width=400><br></a>
  <p>You'll find below a sumary of all the golfing steps that led it to its final, almost unreadable form, and a "clean", commented version.
  <br>
  If you're not familiar with WebGL, you can start by reading the commented source code of MiniShadertoyLite <a href="https://github.com/xem/MiniShadertoyLite/blob/ab7a4b7f137745020d283a155b5210676055731a/index.html#L28-L92">HERE</a>. 
<p>How we code-golfed it, step by step:
<pre style="white-space:pre">
<b>// Step 1: start from MiniShadertoyLite, ignore the textarea, minify, apply RegPack's webgl method hashing, replace all the constants with their numeric value</b>

&lt;body onload='for(i in g=a.getContext(`webgl`))g[i[0]+i[7]+[i[13]]]=g[i];setInterval(`g.uniform1f(g.goa(P,"T"),T++);g.da(6,0,3)`,9);with(g)P=cr(),so(S=ch(35633),`attribute vec2 P;${V="void main(){gl_"}Position=vec4(P,0,1);}`),cS(S),ah(P,S),so(S=ch(35632),`precision lowp float;uniform float T;${V}FragColor=[SHADER]}`),cS(S),ah(P,S),lg(P),ur(P),bf(B=34962,cu()),eet(T=0),vto(0,2,5120,0,0,0),ba(B,new Int8Array([-3,1,1,-3,1,1]),35044)'>&lt;canvas id=a>

<b>// Step 2: simplify `gl_Position=vec4(P,0,1)` to `gl_Position.xy=P`</b>

&lt;body onload='for(i in g=a.getContext(`webgl`))g[i[0]+i[7]+[i[13]]]=g[i];setInterval(`g.uniform1f(g.goa(P,"T"),T++);g.da(6,0,3)`,9);with(g)P=cr(),so(S=ch(35633),`attribute vec2 P;${V="void main(){gl_"}Position.xy=P;}`),cS(S),ah(P,S),so(S=ch(35632),`precision lowp float;uniform float T;${V}FragColor=[SHADER]}`),cS(S),ah(P,S),lg(P),ur(P),bf(B=34962,cu()),eet(T=0),vto(0,2,5120,0,0,0),ba(B,new Int8Array([-3,1,1,-3,1,1]),35044)'>&lt;canvas id=a>

<b>// Step 3: place the `;` in the template, reuse B at the end</b>

&lt;body onload='for(i in g=a.getContext(`webgl`))g[i[0]+i[7]+[i[13]]]=g[i];setInterval(`g.uniform1f(g.goa(P,"T"),T++);g.da(6,0,3)`,9);with(g)P=cr(),so(S=ch(35633),`attribute vec2 P${V=";void main(){gl_"}Position.xy=P;}`),cS(S),ah(P,S),so(S=ch(35632),`precision lowp float;uniform float T${V}FragColor=[SHADER]}`),cS(S),ah(P,S),lg(P),ur(P),bf(B=34962,cu()),eet(T=0),vto(0,2,5120,0,0,0),ba(B,new Int8Array([-3,1,1,-3,1,1]),B+82)'>&lt;canvas id=a>

<b>// Step 4: `with(g)` including the setInterval, arrow function inside setInterval, `int8array.of()`</b>

&lt;body onload='for(i in g=a.getContext(`webgl`))g[i[0]+i[7]+[i[13]]]=g[i];with(g)setInterval(x=>uniform1f(goa(P,"T"),T++)+da(6,0,3),9),P=cr(),so(S=ch(35633),`attribute vec4 P${V=";varying lowp vec4 c;void main(){gl_"}Position=c=P;}`),(A=x=>cS(S)+ah(P,S))(),so(S=ch(35632),`uniform lowp float T${V}FragColor=[SHADER]}`),A(),lg(P),ur(P),bf(B=34962,cu()),eet(T=0),vto(0,2,5120,0,0,0),ba(B,Int8Array.of(-3,1,1,-3,1,1),B+82)'>&lt;canvas id=a>

<b>// Step 5: move some reused code inside the `A()` function, and reuse B better</b>

&lt;body onload='for(i in g=a.getContext(`webgl`))g[i[0]+i[7]+[i[13]]]=g[i];with(g)setInterval(x=>uniform1f(goa(P,"T"),T++)+da(6,0,3),9),P=cr(),B=35633,(A=s=>so(S=ch(B--),s)+cS(S)+ah(P,S))(`attribute vec4 P${V=";varying lowp vec4 c;void main(){gl_"}Position=c=P;}`),A(`uniform lowp float T${V}FragColor=[SHADER]}`),lg(P),ur(P),bf(B=34962,cu()),eet(T=0),vto(0,2,5120,0,0,0),ba(B,Int8Array.of(-3,1,1,-3,1,1),B+82)'>&lt;canvas id=a>

<b>// Step 6: replace "body onload=..." with "svg onload=..."</b>

&lt;canvas id=a>&lt;svg onload='for(i in g=a.getContext(`webgl`))g[i[0]+i[7]+[i[13]]]=g[i];with(g)setInterval(x=>uniform1f(goa(P,"T"),T++)+da(6,0,3),9),P=cr(),B=35633,(A=s=>so(S=ch(B--),s)+cS(S)+ah(P,S))(`attribute vec4 P${V=";varying lowp vec4 c;void main(){gl_"}Position=c=P;}`),A(`uniform lowp float T${V}FragColor=[SHADER]}`),lg(P),ur(P),bf(B=34962,cu()),eet(T=0),vto(0,2,5120,0,0,0),ba(B,Int8Array.of(-3,1,1,-3,1,1),B+82)'>

<b>// Step 7: use a simpler hashing (`g[i[0]+i[6]]` instead of `g[i[0]+i[7]+[i[13]]]`)</b>

&lt;canvas id=a>&lt;svg onload='for(i in g=a.getContext(`webgl`))g[i[0]+i[6]]=g[i];with(g)setInterval(x=>uniform1f(gf(P,"T"),T++)+dr(6,0,3),9),P=cP(),B=35633,(A=s=>sS(S=cS(B--),s)+ce(S)+aS(P,S))(`attribute vec4 P${V=";varying lowp vec4 c;void main(){gl_"}Position=c=P;}`),A(`uniform lowp float T${V}FragColor=[SHADER]}`),lo(P),ug(P),bf(B=34962,cB()),eV(T=0),vA(0,2,5120,0,0,0),bD(B,Int8Array.of(-3,1,1,-3,1,1),B+82)'>

<b>// Step 8: replace the first usages of `B` (36532, 36533) with hashed properties (`g.FN` and `g.FN+1`, simplified to `g.FN++` called twice)</b>

&lt;canvas id=a>&lt;svg onload='for(i in g=a.getContext(`webgl`))g[i[0]+i[6]]=g[i];with(g)setInterval(x=>uniform1f(gf(P,"T"),T++)+dr(6,0,3),9),P=cP(),(A=s=>sS(S=cS(FN++),s)+ce(S)+aS(P,S))(`uniform lowp float T${V=";varying lowp vec4 c;void main(){gl_"}FragColor=[SHADER]}`),A(`attribute vec4 P${V}Position=c=P;}`),lo(P),ug(P),bf(B=34962,cB()),eV(T=0),vA(0,2,5120,0,0,0),bD(B,Int8Array.of(-3,1,1,-3,1,1),B+82)'>

<b>// Step 9: replace `T` with `g.NO`, which is already set to 0</b>

&lt;canvas id=a>&lt;svg onload='for(i in g=a.getContext(`webgl`))g[i[0]+i[6]]=g[i];with(g)setInterval(x=>uniform1f(gf(P,"T"),NO++)+dr(6,0,3),9),P=cP(),(A=s=>sS(S=cS(FN++),s)+ce(S)+aS(P,S))(`uniform lowp float T${V=";varying lowp vec4 c;void main(){gl_"}FragColor=[SHADER]}`),A(`attribute vec4 P${V}Position=c=P;}`),lo(P),ug(P),bf(B=34962,cB()),eV(0),vA(0,2,5120,0,0,0),bD(B,Int8Array.of(-3,1,1,-3,1,1),B+82)'>

<b>// Step 10: simplify the constant `34962` with `g.ET-3`</b>

&lt;canvas id=a>&lt;svg onload='for(i in g=a.getContext(`webgl`))g[i[0]+i[6]]=g[i];with(g)setInterval(x=>uniform1f(gf(P,"T"),NO++)+dr(6,0,3),9),P=cP(),(A=s=>sS(S=cS(FN++),s)+ce(S)+aS(P,S))(`uniform lowp float T${V=";varying lowp vec4 c;void main(){gl_"}FragColor=[SHADER]}`),A(`attribute vec4 P${V}Position=c=P;}`),lo(P),ug(P),bf(B=ET-3,cB()),eV(0),vA(0,2,5120,0,0,0),bD(B,Int8Array.of(-3,1,1,-3,1,1),B+82)'>

<b>// Step 11: Subzey joins the game... remove `getContext` parenthesis, replace the second param of `g.dr` (0) with the result of the neighbour function `uniform1f()`. Renamem c into p and T to t</b>

&lt;canvas id=a>&lt;svg onload='for(i in g=a.getContext`webgl`)g[i[0]+i[6]]=g[i];with(g)setInterval(x=>dr(6,uniform1f(gf(P,"t"),NO++),3),P=cP(),(A=s=>sS(S=cS(FN++),s)+ce(S)+aS(P,S))(`uniform lowp float t${V=";varying lowp vec4 p;void main(){gl_"}FragColor=[SHADER]}`),A(`attribute vec4 P${V}Position=p=P;}`),lo(P),ug(P),bf(B=ET-3,cB()),eV(0),vA(0,2,5120,0,0,0),bD(B,Int8Array.of(-3,1,1,-3,1,1),B+82))'>

<b>// Step 12: get rid of some more zeros</b>
&lt;canvas id=a>&lt;svg onload='for(i in g=a.getContext`webgl`)g[i[0]+i[6]]=g[i];with(g)setInterval(x=>dr(6,uniform1f(gf(P,"t"),NO++),3),P=cP(),(A=s=>sS(S=cS(FN++),s)+ce(S)+aS(P,S))(`uniform lowp float t${V=";varying lowp vec4 p;void main(){gl_"}FragColor=[SHADER]}`),vA(A(`attribute vec4 P${V}Position=p=P;}`),2,5120,lo(P),ug(P),eV(bf(B=ET-3,cB()))),bD(B,Int8Array.of(-3,1,1,-3,1,1),B+82))'>

<b>// Step 13: move `A` declaration into `cP()`</b>

&lt;canvas id=a>&lt;svg onload='for(i in g=a.getContext`webgl`)g[i[0]+i[6]]=g[i];with(g)setInterval(x=>dr(6,uniform1f(gf(P,"t"),NO++),3),P=cP(A=s=>sS(S=cS(FN++),s)+ce(S)+aS(P,S)),A(`uniform lowp float t${V=";varying lowp vec4 p;void main(){gl_"}FragColor=[SHADER]}`),vA(A(`attribute vec4 P${V}Position=p=P;}`),2,5120,lo(P),ug(P),eV(bf(B=ET-3,cB()))),bD(B,Int8Array.of(-3,1,1,-3,1,1),B+82))'>

<b>// Step 14: move `vA`, replace the ones in `Int8Array.of()` with neighbor functions</b>

&lt;canvas id=a>&lt;svg onload='for(i in g=a.getContext`webgl`)g[i[0]+i[6]]=g[i];with(g)setInterval(x=>dr(6,uniform1f(gf(P,"t"),NO++),3),!vA(P=cP(A=s=>sS(S=cS(FN++),s)+ce(S)+aS(P,S)),2,5120,A(`uniform lowp float t${V=";varying lowp vec4 p;void main(){gl_"}FragColor=[SHADER]}`),eV(bf(B=ET-3,cB())),bD(B,Int8Array.of(-3,1,!A(`attribute vec4 P${V}Position=p=P;}`),-3,!lo(P),!ug(P)),B+82)))'>

<b>// Step 15: move `vA(P=cP(...))` around the `setInterval`</b>

&lt;canvas id=a>&lt;svg onload='for(i in g=a.getContext`webgl`)g[i[0]+i[6]]=g[i];with(g)vA(P=cP(setInterval(x=>dr(6,uniform1f(gf(P,"t"),NO++),3),A=s=>sS(S=cS(FN++),s)+ce(S)+aS(P,S))),2,5120,A(`uniform lowp float t${V=";varying lowp vec4 p;void main(){gl_"}FragColor=[SHADER]}`),eV(bf(B=ET-3,cB())),bD(B,Int8Array.of(-3,1,!A(`attribute vec4 P${V}Position=p=P;}`),-3,!lo(P),!ug(P)),B+82))'>

<b>// Step 16: change the Int8Array's vertices to `3,-1,-1,3,-1,-1` and use `~` to turn `null` into `-1`</b>

&lt;canvas id=a>&lt;svg onload='for(i in g=a.getContext`webgl`)g[i[0]+i[6]]=g[i];with(g)vA(P=cP(setInterval(x=>dr(6,uniform1f(gf(P,"t"),NO++),3),A=s=>sS(S=cS(FN++),s)+ce(S)+aS(P,S))),2,5120,A(`uniform lowp float t${V=";varying lowp vec4 p;void main(){gl_"}FragColor=[SHADER]}`),eV(bf(B=ET-3,cB())),bD(B,Int8Array.of(3,-1,~A(`attribute vec4 P${V}Position=p=P;}`),3,~lo(P),~ug(P)),B+82))'>

<b>// Step 17: Make `A()` always return `-1`</b>

&lt;canvas id=a>&lt;svg onload='for(i in g=a.getContext`webgl`)g[i[0]+i[6]]=g[i];with(g)vA(P=cP(setInterval(x=>dr(6,uniform1f(gf(P,"t"),NO++),3),A=s=>sS(S=cS(FN++),s)|ce(S)|~aS(P,S))),2,5120,0,eV(bf(B=ET-3,cB())),bD(B,Int8Array.of(3,A(`uniform lowp float t${V=";varying lowp vec4 p;void main(){gl_"}FragColor=[SHADER]}`),A(`attribute vec4 P${V}Position=p=P;}`),3,~lo(P),~ug(P)),B+82))'>

<b>// Step 18: change the shape of the triangle, using the return value of `setInterval` (usually between 1 and 127) as first param of `Int8Array`</b>

&lt;canvas id=a>&lt;svg onload='for(i in g=a.getContext`webgl`)g[i[0]+i[6]]=g[i];with(g)vA(P=cP(),2,5120,bD(B=ET-3,Int8Array.of(B,setInterval(x=>dr(6,uniform1f(gf(P,"t"),NO++),3),A=s=>sS(S=cS(FN++),s)|ce(S)|aS(P,S)),!A(`uniform lowp float t${V=";varying lowp vec4 p;void main(){gl_"}FragColor=[SHADER]}`),B,!eV(bf(B,cB())),!A(`attribute vec4 P${V}Position=p=P;}`)),B+82),lo(P),ug(P))'>

<b>// Step 19: introduce C and T as attributes, set `t.x=T.x`, and use `vA` (vertexAttrib1f) instead of `uniform1f`</b>

&lt;canvas id=a>&lt;svg onload='for(i in g=a.getContext`webgl`)g[i[0]+i[6]]=g[i];with(g)vA(P=cP(),2,5120,bD(B=ET-3,Int8Array.of(B,setInterval(x=>dr(6,vertexAttrib1f(1,NO++),3),A=s=>sS(S=cS(FN++),s)|ce(S)|aS(P,S)),!A(`${V="varying lowp vec4 p,t;void main(){gl_"}FragColor=[SHADER]}`),B,!eV(bf(B,cB())),!A(`attribute vec4 P,T;${V}Position=p=P;t.x=T.x;}`)),B+82),lo(P),ug(P))'>

<b>// Step 20: Set `t=T` directly</b>

&lt;canvas id=a>&lt;svg onload='for(i in g=a.getContext`webgl`)g[i[0]+i[6]]=g[i];with(g)vA(P=cP(),2,5120,bD(B=ET-3,Int8Array.of(B,setInterval(x=>dr(6,vertexAttrib1f(1,NO++),3),A=s=>sS(S=cS(FN++),s)|ce(S)|aS(P,S)),!A(`${V="varying lowp vec4 p,t;void main(){gl_"}FragColor=[SHADER]}`),B,!eV(bf(B,cB())),!A(`attribute vec4 P,T;${V}Position=p=P;t=T;}`)),B+82),lo(P),ug(P))'>

<b>// Step 21: Set 5th parameter of vA (i.e. `vertexAttribPointer`), stride, to 1, to  make the coordinate pairs overlap: `int8Array.of(x1 = 1, y1 = x2 = -3, y2 = x3 = 1, y3 = 1)`. Also, the setTimeout is moved into `cP` (i.e. `createProgram`)</b>

&lt;canvas id=a>&lt;svg onload='for(i in g=a.getContext`webgl`)g[i[0]+i[6]]=g[i];with(g)vA(P=cP(setInterval(x=>dr(6,vertexAttrib1f(1,NO++),3),A=s=>sS(S=cS(FN++),s)|ce(S)|aS(P,S))),2,5120,bD(B=ET-3,Int8Array.of(!A(`${V="varying lowp vec4 p,t;void main(){gl_"}FragColor=[SHADER]}`),B,!eV(bf(B,cB())),!A(`attribute vec4 P,T;${V}Position=p=P;t=T;}`)),B+82),!lo(P),ug(P))'>

<b>// Step 22: Make `A` return 1 in order to avoid calling `!A()` with a `!` twice</b>

&lt;canvas id=a>&lt;svg onload='for(i in g=a.getContext`webgl`)g[i[0]+i[6]]=g[i];with(g)vA(P=cP(setInterval(x=>dr(6,vertexAttrib1f(1,NO++),3),A=s=>sS(S=cS(FN++),s)|ce(S)|!aS(P,S))),2,5120,bD(B=ET-3,Int8Array.of(A(`${V="varying lowp vec4 p,t;void main(){gl_"}FragColor=[SHADER]}`),B,!eV(bf(B,cB())),A(`attribute vec4 P,T;${V}Position=p=P;t=T;}`)),B+82),!lo(P),ug(P))'>

<b>// Step 23: Rearrange `Int8Array.of()` arguments to place `!eV()` first, anc move `V` declaration into `cb()`</b>

&lt;canvas id=a>&lt;svg onload='for(i in g=a.getContext`webgl`)g[i[0]+i[6]]=g[i];with(g)vA(P=cP(setInterval(x=>dr(6,vertexAttrib1f(1,NO++),3),A=s=>sS(S=cS(FN++),s)|ce(S)|!aS(P,S))),2,5120,bD(B=ET-3,Int8Array.of(!eV(bf(B,cB(V="varying lowp vec4 p,t;void main(){gl_"))),B,A(V+`FragColor=[SHADER]}`),A(`attribute vec4 P,T;${V}Position=p=P;t=T;}`)),B+82),!lo(P),ug(P))'>

<b>// Step 24: use the svg's id (which is an empty string)</b>

&lt;canvas id=a>&lt;svg onload='for(i in g=a.getContext`webgl`)g[i[0]+i[6]]=g[i];with(g)vA(P=cP(setInterval(x=>dr(6,vertexAttrib1f(1,NO++),3),A=s=>sS(S=cS(FN++),id+"varying lowp vec4 p,t;void main(){gl_"+s)|ce(S)|!aS(P,S))),2,5120,bD(B=ET-3,Int8Array.of(A`FragColor=[SHADER]}`,B,!eV(bf(B,cB(id="attribute vec4 P,T;"))),A`Position=p=P;t=T;}`),B+82),!lo(P),ug(P))'>

</pre>

<p>Mini WebGL boilerplate, commented:

<pre style="white-space:pre" id=webgl_detailed_code>
&lt;canvas id=a>
&lt;script>

// Canvas methods hashing:
// This loop creates tiny shortcuts for all the webgl context's methods/constants we need:
// g.createProgram => g.cP
// g.shaderSource => g.sS
// g.createShader => g.cS
// g.compileShader => g.ce
// g.attachShader => g.aS
// g.linkProgram => g.lo
// g.useProgram => g.ug
// g.bindBuffer => g.bf
// g.createBuffer => cB
// g.enableVertexAttribArray => g.eV
// g.vertexAttribPointer => g.vA
// g.bufferData => g.bD
// g.getUniformLocation => g.gf
// g.drawArrays => g.dr
// g.NO_ERROR => g.NO (value = 0)
// g.FRAGMENT_SHADER => g.FN (value: 35632)
// g.ELEMENT_ARRAY_BUFFER_BINDING => g.ET (value: 34965)

// The following code is minified and placed in an &lt;svg onload="...">. The variable "id" below is therefore an empty string, until we rename it. 

for(i in g=a.getContext(`webgl`)){
  g[i[0]+i[6]]=g[i];
}

with(g){                                    // Keep g into scope for future function calls (ex: vA == g.vA)
  vA(                                       // Call vA (vertexAttribPointer) with the following params: vertex_index = 0, components_per_vertex_attribute = 2, vertex_attributes_type = g.BYTE = 5120, normalized = 0, stride = 1, offset = 0.
    P=cP(                                   // Call cP (createProgram) to create the program P and return 0 as 1st param of vA
      setInterval(                          // Start the main loop
        x=>dr(6,vertexAttrib1f(1,NO++),3),  // Inside the loop, increase the uniform variable T (by reusing g.NO, initialized at 0) and call g.drawArrays with the params: mode = g.TRIANGLE_FAN = 6, first = 0, count = 3.
        A=s=>{                              // Then define the function A that takes a source string s...
          sS(                               // set the shader's source (sS = shaderSource)...
            S=cS(FN++),                     // with a new shader (cs = createShader), increases g.FN...
            id                              // and use as source the svg's id, plus a constant piece of code, plus s.
            +
            "varying lowp vec4 p,t;void main(){gl_"
            +
            s                               
          )
          |ce(S)                            // compiles the shader (ce = compileShader)...
          |!aS(P,S)                         // attaches the shader to P (aS = attachShader), and return 1 because Firefox needs a positive integer as the 2nd param of setInterval.
        }
      )
    ),                                      
    2,                                      // 2nd param of vA
    5120,                                   // 3rd param of vA
    bD(                                     // Fill bD (bufferData), and return 0 as 4th param of vA
      B=ET-3,                               // Initialize B (1st param of bD) to g.ARRAY_BUFFER = 34962 = g.ET - 3. we can't use g.AB as it's overwritten during hashing, and doesn't correspond to g.ARRAY_BUFFER anymore)
      Int8Array.of(                         // Set the coordinates of a big triangle surrounding the canvas (x1=1, y1=x2=B, y2=x3=1, y3=1) as the 2nd param of bD. The coordinates overlap because the "stride" param of vA is set to 1.
        A`FragColor=[SHADER]}`,             // x1 = A("FragColor=[SHADER]}") = 1. We call A() a first time to define the fragment shader (at this moment, g.FN = g.FRAGMENT_SHADER = 36532)
        B,                                  // y1 = x2 = B = 34962
        !eV(                                // y2 = x3 = !eV(0) = !enableVertexAttribArray(0) = 1
          bf(                               // Use bf (bindBuffer) to bind the buffer created on-the-fly with cB and return 0
            B,                              // g.ARRAY_BUFFER
            cB(                             // g.createBuffer
              id="attribute vec4 P,T;"      // set the id of the svg, as a prefix for the next time we call A()
            )                               
          )
        ),
        A`Position=p=P;t=T;}`               // y3 = A(Position=p=P;t=T;}) = 1. We call A() a second time to create the vertex shader (at this moment, g.FN = 35633 = g.VERTEX_SHADER)
      ),
      B+82                                  // 3rd param of bD: g.STATIC_DRAW = 35044 = 34962 + 82
    ),
    !lo(P),                                 // Link the program P (lo = linkProgram), return 1 as 5th param of vA
    ug(P)                                   // Use the program P (ug = useProgram), return 0 as 6th param of vA
  )
}

&lt;/script>
</pre>

<br>
<br>
<hr>
<br>
<p>With all this progress, MiniShadertoyLite became a little outdated... so we made a new version including all the previous improvements.
<br>
There's now enough space to include a fullscreen canvas and a contenteditable body and remain under 512b!
<br>
Here's the <a href="http://xem.github.io/MiniShadertoyLite/">last version of MiniShadertoyLite</a>:
<br>
<br>
<a href="http://xem.github.io/MiniShadertoyLite/"><img src="./images/webgl/minishadertoylite2.png" width=600 style="border: 1px solid"></a>

<p>And thanks to <b>@innovati</b> for the Emoji title: 🌍🔬🕸🇬🇱🎠 !
<br>
<p>Cheers!
<p><b>The Codegolf team</b>
</div>

<div class=section id=js1k2016>
  <h2>JS1k 2016</h2>
	<h3>febuary - march 2016</h3>
  <p><a href="//js1k.com">JS1k</a> is certainly code-golfing event that makes me wait for febuary to come, during all the rest of the year.
  <p>This year, the theme was <b>EleMental</b>, and I decided to make two chemistry-related demos with the help of my friends <b>Innovati</b> and <b>Subzey</b> (a.k.a. The Codegolf Team), plus a couple of entries by myself.
  <p>If you're curious about how they were made or how they can fit in 1kb, take a look at the detailed source code. It's very detailed.
  <p>If you want to support us for the "social prize", you can upvote the demos on reddit!
  <br>
  <br>
  <hr>
  <br>
  <h3>PERIOD1k</h3>
  <p>Our first challenge was to draw a pretty periodic table of chemical elements with as much information as possible. After long efforts of data compression dead-ends and successes, we released PERIOD1k. It was the first entry of the compo.
  <br>
  <br>
  <img src="http://codegolf.github.io/period1k/wallpaper1.png" style=width:95%>
  <br>
  <br>- <a href="http://js1k.com/2016-elemental/demo/2402">The entry on js1k</a> (1024b)
  <br>- <a href="https://www.reddit.com/r/js1k/comments/43xi81/demo_2402_period1k_by_codegolf_team_canvas_1024/">The post on reddit</a>
  <br>- <a href="https://github.com/codegolf/period1k">The project (with bonuses) on Github</a>
  <br>- <a href="https://github.com/codegolf/period1k/blob/gh-pages/final.html">The detailed source code</a>
  <br>
  <br>
  <hr>
  <br>
  <h3>JSOTOPES</h3>
  <p>We then gave ourselves another compression challenge: draw a complete table of isotopes (or table of nuclides). This time, there was so much data to include th the app that the JS code used to draw the chart only takes ~10% of the demo, all the rest is used for the position, number and decay types of all the known isotopes.
  <br>
  <br>
  <img src="images/js1k2016/jsotopes.png" style=width:95%>
  <br>
  <br>- <a href="http://js1k.com/2016-elemental/demo/2420">The entry on js1k</a> (1023b)
  <br>- <a href="https://www.reddit.com/r/js1k/comments/45pcv4/demo_2420_jsotopes_by_codegolf_team_canvas_1023/">The post on reddit</a>
  <br>- <a href="https://github.com/codegolf/JSotopes">The project (with bonuses) on Github</a>
  <br>- <a href="https://github.com/codegolf/JSotopes/blob/gh-pages/index.html">The detailed source code</a>
  <br>
  <p>PS: In febuary, researchers discovered the tetraneutron particle. I didn't manage to include it in our demo in less than 1025b. ARRGGH.
  <br>
  <hr>
  <br>
  <h3>UN1kODE</h3>
  <p>For my first individual entry, I wanted to revisit a Unicode slideshow that I made a few months earlier, called <a href="https://github.com/xem/MiniUnicode#readme">MiniUnicode</a>. It's actually a collection of slideshows made to fit in 64b, 128b, 256b, 512b, 4kb, 512kb, including more and more details at each version. The 512b version only shows the assigned code points, but the 4kb version includes all the Unicode blocks names. I decided to do something in the middle: a demo that shows all the assigned code points, but is also aware of all the blocks sizes, and able to start the animation from any of these blocks. That required a lot of compression and transformation of the original code, but it worked!
  <br>
  <br>
  <img src="images/js1k2016/un1kode.jpg" style=width:40%>
  <br>
  <br>- <a href="http://js1k.com/2016-elemental/demo/2440">The entry on js1k</a> (1024b)
  <br>- <a href="https://www.reddit.com/r/js1k/comments/46e3k7/demo_2440_un1kode_by_maxime_euzi%C3%A8re_pure_1024/">The post on reddit</a>
  <br>- <a href="https://github.com/xem/miniUnicode#readme">The project on Github</a>
  <br>- <a href="https://github.com/xem/miniUnicode/blob/gh-pages/js1k.html">The detailed source code</a>
  <br>
  <br>
  <hr>
  <br>
  <h3>MiniBeautifier</h3>
  <p>This final challenge came as a surprise, while I was developping my <a href="http://codegolf.github.io/codegolfIDE">code-golfing IDE</a>. Subzey suggested that I add a code beautifier to see the "unminified" version of our code in real time, so I decided to develop one from scratch. Subzey also told me it was impossible to achieve this task using RegExes, so I took it as a personal challenge, and succeeded. Then I golfed my code a little and realized it could fit in 1kb with some extra compression. And that's what I did.
  <br>
  <br>
  <img src="images/js1k2016/minibeautifier.png" style=width:95%>
  <br>
  <br>- <a href="http://js1k.com/2016-elemental/demo/2484">The entry on js1k</a> (1022b)
  <br>- <a href="https://www.reddit.com/r/js1k/comments/47sewf/demo_2484_minibeautifier_by_maxime_euzi%C3%A8re_pure/">The post on reddit</a>
  <br>- <a href="https://github.com/xem/miniBeautifier">The project on Github</a>
  <br>- <a href="https://github.com/xem/miniBeautifier/blob/gh-pages/index.html#L317">The detailed source code</a>
  <br>
  <br>
  <hr>
  <br>
  <h3>Bonus: emulation!</h3>
  <p>There are some other 1kb projects that I started to prepare before febuary, but they weren't good enough (or small enough) to be submitted. Here they are in exclusivity, just for you:
  <br>
  <br>Here's <a href="http://xem.github.io/chip8/c8.decompiler.min.pack.html">a Chip8 ROM decompiler</a> (1024b gzipped)
  <br>
  <br>
  <img src="images/js1k2016/c8decompiler.png" style=width:50%>
  <br>
  <br>
  <br>And <a href="https://rawgit.com/xem/chip8/js1k/emu.html">a Chip8 emulator with sound, packed in a js1k shim</a> (~1040b regpacked, but still buggy)
  <br>
  <br>
  <img src="images/js1k2016/c8.png" style=width:50%>
  <br>
  <br>
  (Both are inspired by my old <a href="http://xem.github.io/chip8">Chip8 emulator</a> project, where I had made a PNG-bootstrapped Chip8 emulator, without sound, in 1028b).
  <br>
  <br>
  <hr>
  <br>
  <h3>Bonus 2: Compilations!</h3>
  <br>I also prepared two compilations including all the tiny apps and games that I golfed with the team <br>(<b>@p01</b>, <b>@subzey</b>, <b>@aemkei</b>, <b>@0ndras</b>, <b>@maettig</b> and <b>@ilesinge</b>) during the past year.
  <br>Sadly, none of them fits in 1kb but you can try them here!
  <br>
  <br><h3><a href="demos/js1k16/games.html">4 Games</a> (1230b)</h3>
  <br>(Featuring <a href="https://github.com/xem/miniGameOfBraille">MiniGameOfBraille</a>, <a href="https://github.com/codegolf/miniFlappyBraille">MiniFlappyBraille</a>, <a href="https://github.com/codegolf/ping">Ping</a> & <a href="">Pacman</a>)
  <br>
  <br>
  <img src="images/js1k2016/games.png" style=width:95%>
  <br>
  <br><h3><a href="demos/js1k16/apps.html">7 Apps</a> (1157b)</h3>
  <br>(Featuring <a href="https://github.com/xem/miniMandelbrot">MiniMandelbrot</a>, <a href="https://jsbin.com/kinihavigo/edit?html,js,output">MiniMandelbrot ASCII</a>, <a href="https://github.com/xem/miniBookmarklet">MiniBookmarklet</a>, <a href="https://jsbin.com/nahegi/edit?html,output">Countdown 2017</a>, <a href="https://jsfiddle.net/subzey/oahnujcv/">Xmas trees</a>, <a href="https://github.com/xem/miniKeyCode">MiniKeyCode</a> & <a href="https://github.com/xem/miniUnicode">MiniUnicode</a>)
  <br>
  <br>
  <img src="images/js1k2016/apps.png" style=width:95%>
  <br>
  <br>
  <hr>
  <br>
  <br>
  Cheers,
  <br>
  <b>xem</b>
</div>

<div class=section id=obfuscatweet_url_en>
  <h2>Obfusc-a-tweet reloaded</h2>
	<h3>november-december 2015</h3>
  <br>
  TL;DR - the app is here: <a href="http://xem.github.io/obfuscatweet-reloaded">xem.github.io/obfuscatweet-reloaded</a>
  <br>
  <br>
  <hr>
  <br>
	<p>Last year, <b>Subzey</b> and I introduced <a href="../golfing/#jstweet_en">Obfusc-a-tweet</a>, allowing to fit 190 chars of JavaScript in a single 140-chars tweet, by packing a pair of ASCII chars in 95 Unicode symbols and using the other 45 chars to unpack and execute them.
  <p>This time, the idea is to take advantage of Twitter's URL shortener!
  <p>When you tweet an URL, Twitter currently shrinks it (or lenghtens it) into a 23-chars URL, in the form <b>https://t.co/xxxxxxxxxx</b>.
  <p>In the final tweet, your original URL can appear truncated on the left or on the right, or both, according to <a href="https://twitter.com/MaximeEuziere/status/669865248447438849">this rule</a>.
  <p>But when you copy-paste such a tweet from Twitter to a text editor or a JS console, you get the entire original URL (instead of the shortened URL or the truncated URL), followed by a space and an "…" ellipsis character.
  <br>
  <hr>
  <br>
  <h3>Testing the limits</h3>
  <p>I made some experiments so find the limits of this system and here's what I found:
  <ul>
  <li>A tweet can contain up to 5 URLs, separated by a space or a punctuation. (5 URLs take 119 chars. If you add a 6th one, it would overflow to 143 chars)
  <li>A tweeted URL can be up to 4096 chars long. If it's longer, <a href="images/twitter-4097-chars-url.png">an alert will tell you that your tweet is longer than 140 chars</a>, even if the counter disagrees.
  <li>International domain names (IDN) are not well supported. For example, you can tweet "http://mañana.com" and it will work fine. If you tweet a 140-chars-long URL like "http://mañññ(...)ññññññana.com", it will appear as text instead of a link, and if you try to tweet an IDN longer than 140 chars, <a href="images/twitter-unicode-url.png">Twitter will encounter an internal server error and the char counter will go nuts</a>.
  <li>If you stick to regular domain names (limited to letters, numbers and dashes), and if you choose a two-letter-long top-level domain like ".fr", the URL's domain name can take up to 4086 letters or numbers. The 10 remaining chars will be used by the automatic "http://" and the TLD ".fr". As you can imagine, this is not very interesting to store JS code.
  <li>But if you choose a one letter-long domain-name and a two-letter-long top-level-domain (like "a.fr/..."), the URL can contain up to 4084 chars after the slash. (The 12 remaining chars will be used by "http://a.fr/"). This is interesting to store JS code, because these 4084 chars can include any url-encoded text... and more!
  </ul>
  <br>
  <hr>
  <br>
  <h3>Packing JS code</h3>
  <p>So, if we want to store a lot of text in a 140-chars tweet, the theorical limit is about 5 x 4084 url-encoded chars (stored into 5 URLs) + 4 spaces or punctuations between each URL + 21 other characters.
  <p>But our goal is to have an executable tweet, that can be copied as-is into a JS console and run instantly. Thus, the tweet needs to contain some long URLs plus a small JS unpacker and executer. After a lot of trial and error, here is the most efficient solution I could find: (it contains only 4 URLs and uses all the other chars to unpack and execute the JS code).
  <pre class=code>eval(decodeURI(" 🖝http://a.fr/WWW http://a.fr/XXX http://a.fr/YYY http://a.fr/ZZZ".replace(/ .{1,14}/g,'')))</pre>
  <p>... where WWW, XXX, YYY and ZZZ are url-encoded strings up to 4084 chars long.
  <p>Note that the four URLs are placed into a long string, surrounded by JS code.
  <p>When this message is tweeted, it takes exactly 140 characters.
  <p>When it's copy-pasted from Twitter to a JS console, the result is almost the same thing, the only difference being the spaces and ellipsis added after each URL:
  <pre class=code>eval(decodeURI(" 🖝http://a.fr/WWW … http://a.fr/XXX … http://a.fr/YYY … http://a.fr/ZZZ …".replace(/ .{1,14}/g,'')))</pre>
  <p>When you execute that into a JS console, here's what happens:
  <pre class=code>
// step 0: copy-paste the tweet

eval(decodeURI(" 🖝http://a.fr/WWW … http://a.fr/XXX … http://a.fr/YYY … http://a.fr/ZZZ …".replace(/ .{1,14}/g,'')))

// step 1: the replace(/ .{1,14}/g,'') transforms the string to keep only the interesting parts
// it removes the beginning: " 🖝http://a.fr/", because it's a space followed by 14 characters.
// The "🖝" is an astral Unicode character. It counts as two chars in JS, but only one on Twitter.
// It also removes the three occurences of " … http://a.fr/" (space + 14 chars)
// And it also removes the end: " …" (space + 1 char).
// After the replace, here's the remaining string:

eval(decodeURI("WWWXXXYYYZZZ"))

// step 2: the remaining string is url-decoded to produce the final code
// for example, any occurrence of "%7D" will be decoded to a tilde ("~"), etc.

eval("final code")

// step 3: the remaining string (our final JS code) is evaluated
  </pre>
  <p>The 🖝 symbol can be replaced by any astral Unicode symbol (U+10000 - U+10FFFF).
  <p>At this point, we can potentially store up to 4 * 4084 = 16336 chars in a single tweet! But this total includes escape sequences for many characters that can't be used into URLs (such sequences take <a href="http://xem.github.io/escape/">3 to 12 chars each</a>).
  <hr>
  <br>
  <h3>A word about encoded URIs</h3>
  <p>Here are the 95 printable ASCII chars:
  <pre class=code> !"#$%&'()*+,-./0123456789:;&lt;=>?
@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^
_`abcdefghijklmnopqrstuvwxyz{|}~</pre>
  <p>Here are the same chars after passing them through JS's encodeURI:
  <pre class=code>%20!%22#$%25&'()*+,-./0123456789:;%3C=%3E?
@ABCDEFGHIJKLMNOPQRSTUVWXYZ%5B%5D%5E
_%60abcdefghijklmnopqrstuvwxyz%7B%7C%7D~</pre>
  <p>Basically, according to JS, the only chars that need to be escaped are <b>space, ", %, &lt;, >, [, \, ], ^, `, {, | and }</b>.
  <p>But Twitter has some quirks: it doesn't support URLs containing empty parenthesis like "()" or unbalanced parenthesis like "a(a)a)" or "(a(a)a" and on the other hand, it supports URLs containing <b>%, [, ] and |</b>.
  <p>We need to take that into account to build a packer as effective as possible. (We will keep parenthesis and percent signs escaped to avoid weird parsing bugs, and we will keep <b>[, ] and |</b> unescaped because they are safe enough to be used like that in our URLs).
  <br>
  <hr>
  <br>
  <h3>Building the packer</h3>
  <p>To sum things up, if we want to make a JS packer, the mission is to take a JS string as input, URL-encode it, URL-encode the parenthesis characters that can cause problems on Twitter, decode the three chars that don't need to be encoded (<b>[, ], |</b>), split the result in 4084-char blocks, pack these blocks in URLs, surround these URLs with an unpacker/executer, and output the result as a tweetable message.
  <p>Here's <a href="http://xem.github.io/obfuscatweet-reloaded">the packer!</a> (use the first option to test the above technique)
  <p>And <a href="https://twitter.com/MaximeEuziere/status/671025119402270720">here's a demo tweet that alerts a 12641-char text</a>
  <br>
  <hr>
  <br>
  <h3>UPDATE #1: Go further with charcode shifting!</h3>
  <p>After releasing the first version of this packer, I realized with <b>Anders Kaare</b> that a lot of non-ASCII chars were actually useable in Twitter's URLs. After some manual research, we discovered that there's actually a total of 483 chars that can be used safely.
  <pre class="code">!#$&'()*+,-./0123456789:;=?@ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz[]|~ÀÁÂÃÄÅÆÇÈÉÊËÌÍÎÏÐÑÒÓÔÕÖØÙÚÛÜÝÞßàáâãäåæçèéêëìíîïðñòóôõöøùúûüýþÿĀāĂăĄąĆćĈĉĊċČčĎďĐđĒēĔĕĖėĘęĚěĜĝĞğĠġĢģĤĥĦħĨĩĪīĬĭĮįİıĲĳĴĵĶķĸĹĺĻļĽľĿŀŁłŃńŅņŇňŉŊŋŌōŎŏŐőŒœŔŕŖŗŘřŚśŜŝŞşŠšŢţŤťŦŧŨũŪūŬŭŮůŰűŲųŴŵŶŷŸŹźŻżŽžſƀƁƂƃƄƅƆƇƈƉƊƋƌƍƎƏƐƑƒƓƔƕƖƗƘƙƚƛƜƝƞƟƠơƢƣƤƥƦƧƨƩƪƫƬƭƮƯưƱƲƳƴƵƶƷƸƹƺƻƼƽƾƿǀǁǂǃǄǅǆǇǈǉǊǋǌǍǎǏǐǑǒǓǔǕǖǗǘǙǚǛǜǝǞǟǠǡǢǣǤǥǦǧǨǩǪǫǬǭǮǯǰǱǲǳǴǵǶǷǸǹǺǻǼǽǾǿȀȁȂȃȄȅȆȇȈȉȊȋȌȍȎȏȐȑȒȓȔȕȖȗȘșȚțȜȝȞȟȠȡȢȣȤȥȦȧȨȩȪȫȬȭȮȯȰȱȲȳȴȵȶȷȸȹȺȻȼȽȾȿɀɁɂɃɄɅɆɇɈɉɊɋɌɍɎɏ</pre>
  <p>This represents a subset of the Unicode blocks "Basic Latin" and "Latin-1 supplement" plus the whole blocks "Latin-extended-A" and "Latin-extended-B", containing respectively 128 and 256 characters.
  <p>So I had the idea to "shift" all the ASCII characters present in the JS source code (U+0000 - U+007F), to represent them with Latin-extended-A characters (U+0100 - U+017F). The advantage here is to avoid all the escape sequences needed to represent the special chars of our JS code in an URL. All we need to do is to add 0x100 to each charcode. 
  <p>With the previous version, a 14-chars string like "Hello World ^^" was URL-encoded as "Hello%20World%20%5E%5E" (which is 22 chars long). With this "shift", it's converted to "ňťŬŬůĠŗůŲŬŤĠŞŞ" (which is only 14 chars long).
  <p>Of course, this shifted code is not directly executable, it needs to be unshifted first. Here's the unshifter I wrote with the help of <b>Subzey</b>:
  <pre class="code">eval(unescape(escape('...shifted code...').replace(/u../g,'')))</pre>
  <p>If you're confused by this code, you can read an explanation <a href="http://xem.github.io/golfing/#jstweet_en">here</a>. (we used the same principle in the original obfusc-a-tweet app)
  <p>We don't have room in the tweet itself to include this unshifter, because the tweet is already filled with the URLs and their unpacker and executer, so we need to place this code directly inside our URLs.
  <p>Here's an example of a complete tweet:
  <pre class="code">eval(decodeURI(" 🖝http://a.fr/eval%28unescape%28escape%28'WWW … http://a.fr/XXX … http://a.fr/YYY … http://a.fr/ZZZ'%29.replace(/u../g,'')%29%29 …".replace(/ .{1,14}/g,'')))</pre>
  <p>where WWW, XXX, YYY and ZZZ respectively represent shifted code up to 4056, 4084, 4084 and 4055 chars long.
  <p>Note that the first URL starts with an URL-encoded version of <b>eval(unescape(escape('</b> and the last URL ends with an URL-encoded version of <b>').replace(/u../g,'')))</b>.
  <p>Here's what happens when this tweet is executed:
  <pre class="code">
// step 0: copy-paste the tweet

eval(decodeURI(" 🖝http://a.fr/eval%28unescape%28escape%28'WWW … http://a.fr/XXX … http://a.fr/YYY … http://a.fr/ZZZ'%29.replace(/u../g,'')%29%29 …".replace(/ .{1,14}/g,'')))

// Unpacker-side:

// step 1: the replace() transforms the string to keep only the interesting parts
// After the replace, here's the remaining string:

eval(decodeURI("eval%28unescape%28escape%28'WWWXXXYYYZZZ'%29.replace(/u../g,'')%29%29"))

// step 2: the remaining string is url-decoded:

eval("eval(unescape(escape('WWWXXXYYYZZZ').replace(/u../g,'')))")

// step 3: the remaining string is evaluated:

eval(unescape(escape('WWWXXXYYYZZZ').replace(/u../g,'')))

// Unshifter-side:

// Step 4: the string is unshifted to produce the final code

eval('final code')

// Step 5: the remaining string is evaluated.
</pre>
  <p>This unshifter consumes 57 chars of our URLs, but it removes all risk of escape sequences. So we're now sure to store up to 16,279 chars of JS in a tweet.
  <p>Here's <a href="http://xem.github.io/obfuscatweet-reloaded">the updated packer!</a> (choose the second option under the input section to use the shifter)
  <p>And <a href="https://twitter.com/MaximeEuziere/status/671972517771354112">here's a demo tweet that alerts a 16271-char text</a>
  <br>
  <hr>
  <br>
  <h3>UPDATE #2: Go even further with shift + PNG bootstrapping</h3>
  <p>So, if we sum up our possibilities right now, we can either execute up to 16,336 chars of JS (including the escape sequences for all the chars that are not URL-safe), or execute up to 16,279 chars of JS (shifted to avoid using any escape sequence). This works fine with minified and even RegPacked code. But what if we could gzip our JS code, embed it into our 16,279 shifted chars, and add a little bit of extra code to extract and execute it?
  <p>Well, some people already kinda had this idea, and it's called <a href="http://creativejs.com/2012/06/jsexe-javascript-compressor/">JsExe</a>. JsExe encodes the chars of any JS code in the pixels of a greyscale PNG image. The PNG format is natively gzipped. The PNG is then saved as a HTML page that includes itself in an IMG, draws it on a canvas, and reads the pixels to retrieve and execute the original JS code. Even though the extre code takes about 200 bytes, this "PNG bootstrapping" technique is generally more efficient than RegPack, even for demos as small as 1kb.
  <p>So we decided to try that. First, <b>Subzey</b> and I developed <a href="http://codegolf.github.io/zpng">zpng</a>, a pure JS clone of JsExe. It turned out to be even more efficient than JsExe thanks to the use of zopfli compression!
  <p>Then I took the code that generates PNG from zpng and included it in obfuscatweet-reloaded.
  <p>I made it encode the JS source code into a PNG, converted the PNG bytes into extended ASCII, shifted them, and it gave me something like that:
  <pre class=code>
// Source code
alert("Hello World ^^");

// PNG as dataURI
data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAABCAAAAAAOB1pJAAAAIklEQVR4AWNIzEktKtFQ8kjNyclXCM8vyklRiItT0rRmAABw4wfh
  
// PNG's content, as text

‰PNG


IHDRZI"IDATxcHÌI-*ÑPòHÍÉÉWÏ/ÊIQˆ‹SÒ´fpãá
  
// PNG's content, as shifted text
ƉŐŎŇčĊĚĊĀĀĀčŉňńŒĀĀĀęĀĀĀāĈĀĀĀĀĎćŚŉĀĀĀĢŉńŁŔŸāţňǌŉĭĪǑŐǲňǍǉǉŗĈǏįǊŉőƈƋœǒƴŦĀĀŰǣćǡ
</pre>
  <p>Cool, so now the PNG's content is tweetable. In order to use it, we have to unshift it, convert it in dataURI, put it in an image, draw that image on a canvas, read the pixels of the canvas, transform it in JS and execute the JS.
  <p>The principle is the following:
  <pre class="code">
var png = "ƉŐŎŇčĊĚĊĀĀĀčŉňńŒĀĀĀęĀĀĀāĈĀĀĀĀĎćŚŉĀĀĀĢŉńŁŔŸāţňǌŉĭĪǑŐǲňǍǉǉŗĈǏįǊŉőƈƋœǒƴŦĀĀŰǣćǡ";
var g;
// (snip) unshift png and put the result in g
z=new Image;
z.src='data:image/png;base64,'+btoa(g);
V=document.createElement('canvas');
C=V.getContext("2d");
for($=_=''; C.drawImage(z,$--,0), X=(q=C.getImageData(0,0,64,32)).data[0]; _+=String.fromCharCode(X)){};
(e=eval)(_);
  </pre>
  <p>Let's golf it:
  <pre class="code">
(z=new Image).src='data:;base64,'+btoa(g);C=document.createElement('canvas').getContext('2d');for($=_='';C.drawImage(z,$--,0),X=(q=C.getImageData(0,0,64,32)).data[0];_+=String.fromCharCode(X));(e=eval)(_)
  </pre>
  <p>204 bytes. Great! Now here's the real trick. The PNG content is stored as shifted text. This bootstrap code should also be shifted, to use as few chars as possible. So the idea is to put the two shifted blocks in the same string:
  <pre class="code">
var tmp = 'ĨźĽŮťŷĠŉŭšŧťĩĮųŲţĽħŤšŴšĺĻŢšųťĶĴĬħīŢŴůšĨŧĮųŬũţťĨĲıĵĩĩĻŃĽŤůţŵŭťŮŴĮţŲťšŴťŅŬťŭťŮŴĨħţšŮŶšųħĩĮŧťŴŃůŮŴťŸŴĨħĲŤħĩĻŦůŲĨĤĽşĽħħĻŃĮŤŲšŷŉŭšŧťĨźĬĤĭĭĬİĩĬŘĽĨűĽŃĮŧťŴŉŭšŧťńšŴšĨİĬİĬĶĴĬĳĲĩĩĮŤšŴšśİŝĻşīĽœŴŲũŮŧĮŦŲůŭŃŨšŲŃůŤťĨŘĩĩĻĨťĽťŶšŬĩĨşĩ' /*bootstrap*/ + 'ƉŐŎŇčĊĚĊĀĀĀčŉňńŒĀĀĀęĀĀĀāĈĀĀĀĀĎćŚŉĀĀĀĢŉńŁŔŸāţňǌŉĭĪǑŐǲňǍǉǉŗĈǏįǊŉőƈƋœǒƴŦĀĀŰǣćǡ' /* PNG */
  </pre>
  <p>Then unshift this string, as we already did in the previous chapter, an put the result in g:
  <pre class="code">
g=unescape(escape('ĨźĽŮťŷĠŉŭšŧťĩĮųŲţĽħŤšŴšĺĻŢšųťĶĴĬħīŢŴůšĨŧĮųŬũţťĨĲıĵĩĩĻŃĽŤůţŵŭťŮŴĮţŲťšŴťŅŬťŭťŮŴĨħţšŮŶšųħĩĮŧťŴŃůŮŴťŸŴĨħĲŤħĩĻŦůŲĨĤĽşĽħħĻŃĮŤŲšŷŉŭšŧťĨźĬĤĭĭĬİĩĬŘĽĨűĽŃĮŧťŴŉŭšŧťńšŴšĨİĬİĬĶĴĬĳĲĩĩĮŤšŴšśİŝĻşīĽœŴŲũŮŧĮŦŲůŭŃŨšŲŃůŤťĨŘĩĩĻĨťĽťŶšŬĩĨşĩƉŐŎŇčĊĚĊĀĀĀčŉňńŒĀĀĀęĀĀĀāĈĀĀĀĀĎćŚŉĀĀĀĢŉńŁŔŸāţňǌŉĭĪǑŐǲňǍǉǉŗĈǏįǊŉőƈƋœǒƴŦĀĀŰǣćǡ').replace(/u../g,''))
  </pre>
  <p>Then we execute only the first 204 chars of g.
  <pre class="code">
eval((g=unescape(escape('ĨźĽŮťŷĠŉŭšŧťĩĮųŲţĽħŤšŴšĺĻŢšųťĶĴĬħīŢŴůšĨŧĮųŬũţťĨĲıĵĩĩĻŃĽŤůţŵŭťŮŴĮţŲťšŴťŅŬťŭťŮŴĨħţšŮŶšųħĩĮŧťŴŃůŮŴťŸŴĨħĲŤħĩĻŦůŲĨĤĽşĽħħĻŃĮŤŲšŷŉŭšŧťĨźĬĤĭĭĬİĩĬŘĽĨűĽŃĮŧťŴŉŭšŧťńšŴšĨİĬİĬĶĴĬĳĲĩĩĮŤšŴšśİŝĻşīĽœŴŲũŮŧĮŦŲůŭŃŨšŲŃůŤťĨŘĩĩĻĨťĽťŶšŬĩĨşĩƉŐŎŇčĊĚĊĀĀĀčŉňńŒĀĀĀęĀĀĀāĈĀĀĀĀĎćŚŉĀĀĀĢŉńŁŔŸāţňǌŉĭĪǑŐǲňǍǉǉŗĈǏįǊŉőƈƋœǒƴŦĀĀŰǣćǡ').replace(/u../g,''))).slice(0,204))
  </pre>
  <p>Let's go back to the bootstrap code. Instead of creating a dataURI from g, it needs to create it from g.slice(204).
  <pre class="code">
(z=new Image).src='data:;base64,'+btoa(g.slice(204));C=document.createElement('canvas').getContext('2d');for($=_='';C.drawImage(z,$--,0),X=(q=C.getImageData(0,0,64,32)).data[0];_+=String.fromCharCode(X));(e=eval)(_)
  </pre>
  But the ".slice(204)" adds 11 chars to the bootstrap, so we need to replace 204 to 215 everywhere:
  <pre class="code">
// In bootstrap
(z=new Image).src='data:;base64,'+btoa(g.slice(215));C=document.createElement('canvas').getContext('2d');for($=_='';C.drawImage(z,$--,0),X=(q=C.getImageData(0,0,64,32)).data[0];_+=String.fromCharCode(X));(e=eval)(_)

// In unshifter
eval((g=unescape(escape('ĨźĽŮťŷĠŉŭšŧťĩĮųŲţĽħŤšŴšĺĻŢšųťĶĴĬħīŢŴůšĨŧĮųŬũţťĨĲıĵĩĩĻŃĽŤůţŵŭťŮŴĮţŲťšŴťŅŬťŭťŮŴĨħţšŮŶšųħĩĮŧťŴŃůŮŴťŸŴĨħĲŤħĩĻŦůŲĨĤĽşĽħħĻŃĮŤŲšŷŉŭšŧťĨźĬĤĭĭĬİĩĬŘĽĨűĽŃĮŧťŴŉŭšŧťńšŴšĨİĬİĬĶĴĬĳĲĩĩĮŤšŴšśİŝĻşīĽœŴŲũŮŧĮŦŲůŭŃŨšŲŃůŤťĨŘĩĩĻĨťĽťŶšŬĩĨşĩƉŐŎŇčĊĚĊĀĀĀčŉňńŒĀĀĀęĀĀĀāĈĀĀĀĀĎćŚŉĀĀĀĢŉńŁŔŸāţňǌŉĭĪǑŐǲňǍǉǉŗĈǏįǊŉőƈƋœǒƴŦĀĀŰǣćǡ').replace(/u../g,''))).slice(0,215))
  </pre>
  <p>And we're done! Phew! So, here's what happens when we tweet a PNG bootstrapped code:
  <pre class="code">
// step 0: copy-paste the tweet
// WWW, XXX, YYY and ZZZ represent the shifted string containing the bootstrap code and the PNG
eval(decodeURI(" 🖝http://h.ck/eval%28%28g=unescape%28escape%28'WWW … http://h.ck/XXX … http://h.ck/YYY … http://h.ck/ZZZ'%29.replace(/u../g,'')%29%29.slice(0,215)%29 …".replace(/ .{1,14}/g,'')))

// Unpacker-side:

// step 1: the replace() transforms the string to keep only the interesting parts
// After the replace, here's the remaining string:

eval(decodeURI("eval%28%28g=unescape%28escape%28'WWWXXXYYYZZZ'%29.replace(/u../g,'')%29%29.slice(0,215)%29"))

// step 2: the remaining string is url-decoded:

eval("eval((g=unescape(escape('WWWXXXYYYZZZ').replace(/u../g,''))).slice(0,215))")

// step 3: the remaining string is evaluated:

eval((g=unescape(escape('WWWXXXYYYZZZ').replace(/u../g,''))).slice(0,215))


// Unshifter-side:

// Step 4: unshift, g contains all the unshifted string, and the first 215 chars are evaluated

g = "(z=new Image).src='data:;base64,'+btoa(g.slice(215));C=document.createElement('canvas').getContext('2d');for($=_='';C.drawImage(z,$--,0),X=(q=C.getImageData(0,0,64,32)).data[0];_+=String.fromCharCode(X));(e=eval)(_) // +  PNG content";

eval(g.slice(0,215))

// PNG bootstrap side

// z contains an image whose src is g.slice(215)
// C contains a canvas context2d
// _ contains our final JS code
// e is a shortcut for eval
e(_)

// Step 5: the final code is evaluated.
</pre>
  <p>We successfully embedded a PNG bootstrap technique in a tweet. Now let's break some record! (The last record was 16,279b of JS executed.)
  <p>Here's <a href="http://xem.github.io/obfuscatweet-reloaded">the updated packer!</a> (choose the third option under the input section to use the PNG bootstrap mode)
  <p>And <a href="https://twitter.com/MaximeEuziere/status/681109264744747008">here's a demo tweet that logs 37,867 chars of Moby Dick in the browser's console!</a>
  <p>Unfortunately, this kind of code currently doesn't work on MS Edge, nor Firefox.
  <p>If you insist a little, Firefox agrees to execute up to 16kb of JS packed into a PNG, but not more.
  <br>
  <hr>
  <br>
  <h3>UPDATE #3: ...PAUSE... </h3>
  <p>We have many more ideas, based on different image compressions and base-483 radix conversion, but Twitter recently announced they will extend the tweets limit to 10,000 characters. Let's wait for that "revolution" before going further!
  <p><b>To be continued!</b>
  <hr>
  <br>
  <!--h3>UPDATE #3: Go EVEN MORE FURTHER with base-483?</h3>
  <p>Why would we stop there? We have 483 different chars that we can use in our URLs, and they all count as 1 character out of 4096.
  <p>Our JS source code generally uses all or a subset of ASCII. (i.e. less than 95 different chars, if we count printable characters, or 128 chars if we include all control characters).
  <p>So <b>Anders Kaare</b> had the idea to perform a radix conversion from base "95-or-so" to base 483...
  <p><b>To be continued!</b>
  <hr>
  <br-->
  
  <p>Cheers,
  <br>
  <b>@MaximeEuziere</b>
</div>
  
<div class=section id=js13k2015>
  <img src="images/js13k15/screen-small.png" style="float:right;">
  <h2>JS13kGames 2015 post-mortem: GeoQuiz</h2>
  <h3>august-september 2015</h3>
  <br>
  <p>>>> <a href="http://js13kgames.com/entries/geoquiz">PLAY THE GAME HERE</a> <<<
  <br>
  <p><a href="http://xem.github.io/JS13k15/">Play enhanced version on Github</a><br><a href="https://github.com/xem/JS13k15">source code</a><br><a href="https://www.reddit.com/r/tinycode/comments/3ky4jk/geoquiz_a_js_game_featuring_the_whole_world_in/">Reddit discussion</a>
  <br>
  <br>
  <p>13kb seems small, but actually it's huge... even for a full-featured HTML5 game.<br>(<a href="http://js13kgames.com/entries/alchemixer">Last year</a>, despite my efforts, I didn't manage to use more than 9kb).<br>But rules are rules, and this year again, we have a month to fill a 13kb zip with a high-quality game for... <b><a href="http://js13kgames.com/">js13kgames.com</a></b> !
  <p>To avoid being annoyed by such a high limit, I decided to make something big, something so big that people will ask themselves how it can fit in just 13kb. <br>Something big enough that I would also wonder how I will pack it in 13kb... and develop my own tools to achieve that goal.<br>Then yes, JS13kGames would be a great code-golfing and compression challenge!
  <p>Games contain code and data. 13kb of golfed code is very hard to write, so I decided to make a game that uses a lot of data.<br>Hey... how about putting the whole world in my game?<br>There was this Flash game that I liked a lot at university: <a href="http://www.travelpod.com/traveler-iq">Traveller's IQ challenge</a>.<br>Its goal was to find famous places (cities, capitols, monuments...) on a World map.<br>I chose to make a game like that, but with my own style.
  <br>
  <br>
  <hr>
  <br>
  <h3>A few days before the compo...</h3>
  <p><i>The final game doesn't contain any code or data produced before the beginning of the compo. During this couple of days, I just began to develop my design tools and produced dummy data that would be replaced afterwards.</i>
  <p>As I was waiting for the compo to start, I started experimenting with different techniques to draw and store efficiently all the countries, capitols and famous places of the world. I chose <a href="images/js13k15/model.png">a good-looking, yet outdated World map</a> (I did not want a Mercator projection - It's too stretched and unrealistic around the poles) and hacked a little tool that would let me draw the outline of each country with my mouse, on a canvas. The logic was a bit similar to <a href='#js1k_floppydragon'>what I did for Flappy Dragon during JS1k 2014</a>, but with less precision, because this time, I had to draw more than 197 countries. After many experiments, I chose the following way: I placed the model of my map on a 1024 by 512px canvas. Then, for each country and for each point I clicked, the tool would gather two mouse coordinates on the map (X and Y), and append the value of X/4 and Y/2, converted in Unicode, to a string representing the given country. X/4 and Y/2 turned out to be bounded between 0 and 253, so I could use two chars to represent each point, and the character 255 ("ÿ") as a separator for the countries (like Canada) consisting of multiple islands or territories. The capitol's coordinates are appended at the end. With this technique, I could fill a JSON file that looked like this:
  <br>
  <br>
  <p><pre class="code">
{
    ...
    'Brazil,Brasilia': '?É?½5¢0¦/8;ABNJ»D¿BÎÿD²',
    'Bulgaria,Sofia': '{?AD|Eÿ|B',

    'Canada,Ottawa': '8"9<\nFOB\nBGA!<(...);A9D3:7?=;A9;.D+7ÿ%)\r11ÿ+\n/4/\rÿ5:4ÿ8<9\r5ÿ3=',
    <b>//   &#11014;                      &#11014;                           &#11014;      &#11014;        &#11014;           &#11014;&#11014;
    // Country, capitol    Sequence of X/Y coordinates      Islands separators    Capitol coordinates</b>

    'Chile,Santiago': '7ë4È6¹2±4Ý7ï=õ;ï7ëÿ4Ì',
    'China,Beijing': '©7¢I¨W°^·\\ºj¾gÂkÈdÉXÄHËBË8Ã2ÄB¼MÿÁmÃlÂpÁoÿÂI',
    ...
}</pre>
  <br>
  <p><i>You can try the editor <a href="http://xem.github.io/JS13k15/old/editor.html">here</a>. (use left click to place a point, right click to start a new island and spacebar to start a new country. The coordinates are appended to the text under the map)</i>
  <br>
  <br>
  <p>Then, I tried to draw the map from that JSON, and it wasn't as easy and straightforward as I imagined... here are a few screenshots of my first tests:
  <br>
  <br>
  <img src="images/js13k15/1.png" style="width: 600px; border: 1px solid">
  <br>
  <i>fig. 1: Unicode madness, most countries leak everywhere and half of Russia somehow gets drawn over south America.</i>
  <br>
  <br>
  <img src="images/js13k15/2.png" style="width: 600px; border: 1px solid">
  <br>
  <i>fig. 2: Debugging, displaying small dots for the capitols, redrawing countries that had corrupted data...</i>
  <br>
  <br>
  <img src="images/js13k15/3.png" style="width: 600px; border: 1px solid">
  <br>
  <i>fig. 3: More debugging... and realizing that many territories like Greenland and Western Sahara are not countries... Damn, Earth! :)</i>
  <br>
  <br>
  <p>These tests confirmed that this project was possible. Indeed, the names, shapes and capitols of all the countries on Earth can fit in just 6.2kb in JSON. Now I'm sure there is plenty of room left for a more detailed map, plus the game's code, the music and even more data!
  <p>But I didn't stop there. I used the unused char U+254 ("þ") as a separator, and made a big string with all my JSON's data...
  <pre class="code">Algeria,AlgiersþtfpRqLiOjVc]noÿmNþArgentina,Buenos Airesþ6¸?Ã>Ï@Ö<Ù;ï7ë4Èÿ<ñ=õ@õÿ>Ðþ ... </pre>
  <p>Then I made a tool that converts this string in a binary file. After gzipping, I saw my data fell from 6.2kb to 5.6kb! 600 bytes saved, <a href="https://twitter.com/MaximeEuziere/status/630818472608534528">that's a great news</a>! If you're wondering why this conversion is so efficient, it's for two main reasons. First, the JSON contained some escape sequences ("\\" instead of "\", "\r" and "\n" instead of line breaks, \' instead of quotes) that became a single byte in binary (the escape was no longer necessary). But most of the savings come from the "code point-to-binary" conversion for all the characters between U+80 and U+FF (these characters take 2 bytes each in UTF-8, as opposed to just 1 byte if we store their code points in binary). You can find more info about how many bytes are used for each character in each charset on <a href="http://xem.github.io/charsets">this page</a>.
  
  <p>Here's a golfed encoder that does this conversion in about 230b:
  <pre class="code">
// Unicode to binary encoder
// Input (m) can contain chars between U+0 and U+255
// Output (download) is a binary file
m=m.replace(/\\\\/g,"\\").replace(/\\r/g,"\r").replace(/\\n/g,"\n").replace(/\\'/g,"'");y=[];for(i in m)y.push(m.charCodeAt(i));location="data:application/octet-stream;base64,"+btoa(String.fromCharCode.apply(!1,new Uint8Array(y)))</pre>

  <p>Of course, at some point, this binary data needs to be read and converted back as a long Unicode string. I made a little JS program that does it in about 160bytes. It's totally worth the overhead, considered the hundreds of bytes that can be saved through binary.
  
  <pre class="code">
// Binary to Unicode decoder
// After execution, h contains the decoded string.
with(new XMLHttpRequest)open("GET","data.bin"),responseType='arraybuffer',send(),onload=function(){h="";for(i in u=new Uint8Array(response))h+=String.fromCharCode(u[i])}</pre>
  <p><b>Golf tip:</b> instead of data.bin, you can name your binary file "0" (or any number), without extension. It will reduce the name used in open() but also make the quotes unnecessary:
<pre class="code">with(new XMLHttpRequest)open("GET",0), ... </pre>
  <br>
  <br>
  <hr>
  <br>
  <h3>Compo: Day 1</h3>
  
  <p>When the compo started, my map editor was functional, and I could start developing my game for real. But before that, I wanted to experiment another thing: to represent the Earth on a 3D-looking sphere instead of always a flat map.
  <p>I didn't want to use (or make) a 3D engine just for that. I was looking for a very lightweight solution to give the illusion of a real sphere using a few tricks of trigonometry-fu, like <b>Aemkei</b> did for his <a href="http://aem1k.com/world/">1kb world</a>. I'm not an expert but, by chance, my friend <b>Subzey</b> helped me write these simple equations that turn instantly some map coordinates into a projected globe's coordinates:
  
  <pre class="code">
// map_x and map_y placed in the interval [-1:1]
globe_x = Math.sin(map_x * Math.PI) * Math.cos(map_y * Math.PI / 2);
globe_y = Math.sin(map_y * Math.PI/2);</pre>
  <br>
  <img src="images/js13k15/4.png" style="width: 250px; border: 1px solid; float: right; margin: 0 0 20px 20px">
  For more info, tke a look at <a href="http://codepen.io/subzey/pen/rVoXQx">this demo by Subzey</a>.
  <br>
  <br>
  Here's <a href="images/js13k15/5.png">what I saw when I tried to adapt this technique to my map</a>.
  <br>
  <br>
  After debugging, here's a <a href="demos/js13k15/globe1.html">demo using my world map (animated)</a>
  <br>
  <br>
  <p>After long hours fighting with Canada and Russia (because they are too large to behave correctly where the "-1" and the "1" are connected), I managed to hide the back side of the globe and thus, make it much more realistic.
  <br>
  <br>
  Here's a <a href="demos/js13k15/globe2.html">demo with only the front face of the globe (animated)</a>
  <br>
  <br>
  <p>Great! Everything works. All that's left to do now is to develop the game in a few kilobytes, use another couple of kb for music, and all the rest of my zip will be used to store as many data as possible.  
  <p>The first thing I developed in the game was a "Home screen" (featuring the rotating 3D globe in more realistic colors, plus slightly blinking stars scrolling in the background), and a presentation screen for each "level" of the game.
  <br>
  <br>
  <img src="images/js13k15/6.png" style="width: 600px; border: 1px solid">
  <br>
  <br>
  <img src="images/js13k15/7.png" style="width: 600px; border: 1px solid">
  <br>
  <blockquote class="twitter-tweet" lang="fr"><p lang="en" dir="ltr">Day 1: I already initialized 46 variables and wrote 430 lines of code for my game. (2.7kb mini/1.2k gzip) Just the beginning! :)&#10;<a href="https://twitter.com/hashtag/js13kgames?src=hash">#js13kgames</a></p>&mdash; xem (@MaximeEuziere) <a href="https://twitter.com/MaximeEuziere/status/631898962954465281">13 Août 2015</a></blockquote>
  <script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
  <br>
  <hr>
  <br>
  <h3>Compo: Day 2</h3>
  <p>I improved the graphics with better colors and gradients.
  <br>
  <br>
  <img src="images/js13k15/8.png" style="width: 600px; border: 1px solid">
  <br>
  <br>
  <img src="images/js13k15/9.png" style="width: 600px; border: 1px solid">
  <br>
  <p>I also began to implement a basic interactivity: showing the name of a target and a 10-second timer, clicking on the map, telling if the target has been clicked, and restarting with the next puzzle.
  <br>
  <br>
  <img src="images/js13k15/11.png" style="width: 600px; border: 1px solid">
  <br>
  <p>To find if a country is clicked, I use the canvas function "ctx.isPointInPath(mouseX, mouseY)" just after drawing the country in yellow. It's very handy! But when we click outside of the country, I have to loop on all the points of the country, compute which one is the closest (computing distances using Pythagore), and use it for the green flag and the red line.
  <br>
  <br>
  <img src="images/js13k15/10.png" style="width: 600px; border: 1px solid">
  <br>
  <blockquote class="twitter-tweet" lang="fr"><p lang="en" dir="ltr">Day 2: game specs are almost finalized, the design takes shape. it&#39;s a little playable already :)&#10;48 vars, 4.2kb min, 1.8kb zip&#10;<a href="https://twitter.com/hashtag/js13kgames?src=hash">#js13kgames</a></p>&mdash; xem (@MaximeEuziere) <a href="https://twitter.com/MaximeEuziere/status/632279653504393216">14 Août 2015</a></blockquote>
  <script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
  <br>
  <hr>
  <br>
  <h3>Days 3 & 4</h3>
  <p>During this weekend, I started refactoring some code and compressed my data a little bit more (about 200b) by removing some separator bytes in my binary file. (But *spoiler alert* there will be a big data overhaul in a few days, so I'll talk more about it later!).
  <p>I also worked on the gameplay and added an distance counter that tells you an idea of how far you are from a target. This number will be used to compute the player's score.
  <br>
  <br>
  <img src="images/js13k15/12.PNG" style="width: 600px; border: 1px solid">
  <br>
  <p>Of course, Pythagore isn't a great solution to compute distances on a sphere projected on a map, it works well enough for a mini-game.
  <p>I also worked on the gameplay of the level 2 (finding capitols):
  <br>
  <br>
  <img src="images/js13k15/13.png" style="width: 600px; border: 1px solid">
  <br>
  <br>
  <img src="images/js13k15/14.png" style="width: 600px; border: 1px solid">
  <p>... and worked on the scoring system (your "error gauge" decreases after every mistake and if it reaches 0, the game is over).
  <br>
  <p>Also, with a little help from my friends and my Twitter friends, I produced an important chunk of data: the names and positions of 100 famous places on Earth, separated in 3 categories (easy, medium, hard). The data looks like this in JSON, and of course, it will be part of the final binary file:
  <pre class="code">{
  "Christ the Redeemer": "Hº",
  "The Great Chinese Wall": "ÁI",
  "The Great Sphinx": "Z",
  "The Eiffel Tower", "m9"
  ...
}</pre>

  <br>
  <hr>
  <br>
  <h3>Days 5-11</h3>
    <p>I knew I had too much free space, so I spent the spare time I had this week adding the U.S.A. states and capitols to my database. Same format as the World's cities and capitols, but I directly drew the "final map", i.e. with all the little details I could draw. This brought my total data counter to 7.9kb zipped.
    <br>
    <br>
    <img src="images/js13k15/15.png" style="width: 600px; border: 1px solid">
    <p>I also decided to reorganize and optimize my data once again, to make it as small and compressible as possible:
    <ul>
    <li>First, I separated the text (the places' names) and the binary data. Having all my names stored in the JS code and all the coordinates stored in a binary file will reduce the effort to retrieve the data I need from the binary file, and will help the compression too (because "just text" or "just random bytes" compresses better than if all is mixed up).
    <li>I also changed the order of the data to put all the places first, then all the capitols, then all the US capitols, then all the countries, then all the US states. The advantage of this is that I don't need any separators in the first three datasets. I just have to store all the places/capitols/US capitols coordinates sequencially and I'll just read them two by two when I'll try to retrieve the data.
    <li>Finally, I gathered all my names in a big JS tring, but without any separators: to distinguish them, I'll just use the uppercase letters at the beginning of each name. So the names now look like this:
    <pre class=code>Cape canaveralChrist the redeemerThe great chinese wallThe great sphinxThe eiffel towerTower of pisaMount everestSagrada familiaBig benThe statue of libertyForbidden cityThe pyramids of gizaThe palace of versailles...</pre>
    
    <p>After zipping, I discovered that this overhaul made me lose (I mean, earn) 800 bytes of data, so that's a great news!
    
    <blockquote class="twitter-tweet" lang="fr"><p lang="en" dir="ltr">Today I saved 800b in my zip just by organizing my game&#39;s data in a smarter and more compressible way. 7.9kb =&gt; 7.1kb. Yay :D&#10;<a href="https://twitter.com/hashtag/js13kgames?src=hash">#js13kgames</a></p>&mdash; xem (@MaximeEuziere) <a href="https://twitter.com/MaximeEuziere/status/634610685914284032">21 Août 2015</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
  <hr>
  <br>
  <h3>Days 12 - 18</h3>
  <p>I spent that week rewriting the game to adapt it to the new data format, and revamped all the code to make it more logic and easy to maintain.
  <br>
  <br>
  <hr>
  <br>
  <h3>Days 19 - 25</h3>
  <p>I spent that week fixing the gameplay of the 13 levels of the game. <a href)"https://twitter.com/MaximeEuziere/status/638677982844952576">and tweeted about it</a>
  <br>
  <br>
  <hr>
  <br>
  <h3>Days 26 - 32: Last week</h3>
  <p>I spent that last week redrawing the final world map in high quality, debugging all the little artifacts that were remaining, and added some last minute features to respect the theme "Reversed" and make the game a little more interesting: the maps get reversed every five puzzles, and the fronteers disappear during the last 5 puzzles of each level. I also inserted some little last-minute hacks to make the game better and better-looking without spending a lot of time on it. One weird hack I discovered and used, was about the data shuffling. I initially did that on page load and remarked that the puzzles order were often very similar, as if there was no real randomness in the shuffle function. I assumed that Math.random() was influenced by the JS execution time, so I delayed all the data shuffling from the page load to the moment where the player clicks on "START". The puzzles looked much more random after that.
  <p>On friday, I asked my colleagues to test my game, and the result was very good. They loved it, and they played it very well!
  <br>
  <blockquote class="twitter-tweet" lang="fr"><p lang="en" dir="ltr">Hiring my colleagues to beta test my <a href="https://twitter.com/hashtag/js13k?src=hash">#js13k</a> game. They&#39;re very good! One of them reached level 13! <a href="http://t.co/dBiRHQKSxi">pic.twitter.com/dBiRHQKSxi</a></p>&mdash; xem (@MaximeEuziere) <a href="https://twitter.com/MaximeEuziere/status/642250536180404224">11 Septembre 2015</a></blockquote>
<script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
  <style>#js13k2015 .twitter-tweet[data-tweet-id="642250536180404224"]{height:430px!important}</style>
  <br>
  <p>Oh, and... how about the size? Well, it was surprisingly small: 10.9kb. And it still lacked sound or music, because I have absolutely no talent for that. I launched <a href="https://twitter.com/MaximeEuziere/status/642302415098769409">a desperate cry for help on Twitter</a> and a great guy (<a href="https://twitter.com/sqaxomonophonen">Anders Kaare</a>) answered my prayers and agreed to compose a musical theme for GeoQuiz in less than 24h. He did such a great job, he also included a reversed variation for the puzzles where the map is reversed, plus a "blacker" variation for the puzzles where the map is black, and without fronteers. Kudos to him!
  <p>I released the final build a few hours before the end of the compo. My final zip weighs 11.9kb... Once again, I failed at filling the whole 13kb allowed by the contest, but I'm happy with the result, even if I could have made it even better with more time... and if these damn <a href="http://apps.timwhitlock.info/emoji/tables/iso3166">Unicode flags</a> were already useable in browsers!
  <br>
  <br>
  <hr>
  <br>
  <h3>One week after</h3>
  <p>I received a lot of <a href="https://twitter.com/McFunkypants/status/644350930075254786">great</a> <a href="https://twitter.com/mhcurylo/status/645337527570857988">feedbacks</a> for my game, and it also appeared on some <a href="https://twitter.com/keithkarnage/status/643842201433317380">video tests</a>. Some people asked for a little enhancement to make it a better learning tool: in the "capitols" puzzles, they asked me to display the name of the country in which the capitol is located. So I added this feature on the Github version of my game.
  <br>
  <br>
  <img src="images/js13k15/16.png" style="width: 600px; border: 1px solid">
  <br>
  <br>
  <hr>
  <br>
  <h3>Conclusion</h3>
  <p>See you next year, js13kgames! And thanks for existing! It was fun to code for you!
  <br>
  <br>
  <p><i>PS: I invite you to take a look at the entry <a href="http://js13kgames.com/entries/mug-gniwech">Mug-Gniwech</a>, it was made by one of my colleagues whom I'm introducing to the fine art of JS code-golfing, and I contributed a little to his game during the brainstorming phase, the graphics creation, and the code's organization. :)</i>
  <br>
  <br>
  <p>Cheers,
  <br>
  <b>@MaximeEuziere</b>
</div>

<div class=section id=js1k2015>
  <h2>JS1k 2015 post-mortem</h2>
  <h3>february 2015</h3>
  <p>This month was very busy! I spent almost all my free time <s>working</s> golfing for JS1k.</p>
  <br>
  <p>➾ I contributed to <a href="http://subzey.github.io/js1k2015invitro/" target=_blank>the great invitro</a> made by @subzey, by finding a brand new compression technique, allowing to hash the canvas properties as well as the canvas functions.
  <br>You can read more about it in <a href="https://github.com/subzey/js1k2015/tree/master/postmortem" target=_blank>his post mortem</a> and the discussion in <a href="https://github.com/Siorki/RegPack/issues/21" target=_blank>this RegPack ticket</a>.
  <br>It was very exciting to discover this new technique and save about 50 bytes on a demo we thought we couldn't compress anymore!</p>
  <br>
  <img src="images/js1k15-1.png" width=200>
  <br>
  <br>
  <hr>
  <br>
  <p>➾ I gathered the best code-golfed games and apps made during the past months by "the codegolf team" into three compilations:
  <br><br>- <a href="http://js1k.com/2015-hypetrain/demo/2121" target=_blank>Mini Apps Collection</a><br>Featuring 7 apps! Mini Code Editor, HTML & CSS minifier, hex viewer, dataURI converter, spritesheet and JSPerf.<br>(1477b minified, 1024b regpacked)
  <br><br>- <a href="http://js1k.com/2015-hypetrain/demo/2100" target=_blank>Mini Games Collection #1</a><br>Mine Sweeper, Pop Tiles, and Game of Life.<br>(1221b minified, 1023b regpacked)
  <br><br>- <a href="http://js1k.com/2015-hypetrain/demo/2145" target=_blank>Mini Games Collection #2</a><br>Simon with sound and 2048.<br>(1220b minified, 1022b regpacked)
  <br><br>It took a lot of time to fit each of these compilations in 1k, which involved removing some features not compatible with js1k's rules (like accessing "top" and localStorage"), managing to inject big chunks of HTML and JS into the shim with many "document.write", "innerHTML" and "outerHTML"-based hacks, and optimizing the whole code for a better RegPack compression (by repeating code as much as possible, sometimes in very silly ways)...
  <br><br>Thanks to @p01, @subzey, @aemkei, @LauckAndLoad, @bburky, @mathias and @veubeke for their contribution in each of these projects!
  <br>You can read more about these apps and games (and their original projects) by clicking the "demo details" button on each demo.
  </p>
  <br>
  <br>
  <img src="images/js1k15-2.png" width=700>
  <br>
  <br>
  <hr>
  <br>
  <p>➾The theme was "Hype Train", so I couldn't resist making <a href="http://js1k.com/2015-hypetrain/demo/2160" target=_blank>this little hommage</a> to asdfmovie's sequence <a href="https://www.youtube.com/watch?v=5DjOL2we8ko" target=_blank>I like trains</a>. The code has nothing special, just a lot of points coordinates and a loop displaying them with moveTo and lineTo's. This kind of "monotonous" source code packs very well (1472b minified - 902b regpacked)
  <br>
  <br>
  <img src="images/js1k15-3.png"></p>
  <br>
  <hr>
  <br>
  <p>➾ The biggest challenge was of course my "serious" entry, <a href="http://js1k.com/2015-hypetrain/demo/2316" target=_blank>hypeRcube</a>!</p>
  <p>With all the success of the 3D demos during the past years, my idea was to produce the first 4D demo of JS1k, featuring an "hypercube" (the 4D equivalent of a 3D cube). I had no precise idea of what I would (or could) do in 1k, but I aimed for some kind of animated / rotating hypercube, like the ones we can see on <a href="http://en.wikipedia.org/wiki/Tesseract" target=_blank>wikipedia's gifs</a>.</p>
  <p>It took more than 10 iterations (10 more or less big rewrites) to become what it is today, and each of these rewrites was marked by a new exciting feature, a compression breakthrough, or a funny bug that made me understand that I was not on the good path. You can tke a look at these beta versions here:</p>
  <p>&bull; <a href="demos/hypercube/0.html">Proof of concept</a>, very laggy but featuring an intro, perspective, camera rotation and the 6 4D rotations (3.1kb minified, and only 1.3kb regpacked, due to heavy code reuse). This PoC convinced me that doing a 4D demo for js1k was possible! (<a href="https://twitter.com/MaximeEuziere/status/566610056540852225" target=_blank>tweet</a>)
  <p>&bull; <a href="demos/hypercube/1.html">Beta #1</a>, with more reactive buttons, and intensive golfing (2.0kb minified, 1.1kb regpacked) 
  <p>&bull; <a href="demos/hypercube/2.html">Beta #2</a>, almost fitting in 1k (1.9kb minified, 1037b regpacked)
  <p>&bull; <a href="demos/hypercube/3.html">Beta #3</a>, golfed intensively (1.6kb minified, 963b regpacked). From this point I knew that I would be able to add many more features and graphical enhancements in my 1kb demo!<br>Actually, I added features and golfed them at the same time to stay as close as possible to 1kb.
  <p>&bull; <a href="demos/hypercube/4.html">Beta #4</a>, adding colors, and allowing to play/pause animations... but it's so slow ! (1.5B minified, 1022b regpacked) - <a href="https://twitter.com/MaximeEuziere/status/566615949009498113" target=_blank>funny</a>... <a href="https://twitter.com/MaximeEuziere/status/566629132935901184" target=_blank>bugs</a>.
  <p>&bull; <a href="demos/hypercube/5.html">Beta #5</a>, enhancing speed and adding a perspective slider going from an isometric view (2.5D) to an exaggerated 3D view... (1.5kb minified, 1030b regpacked)
  <p>&bull; <a href="demos/hypercube/6.html">Beta #6</a>, adding two color pickers and optimizing the workflow for RegPack (reusing the vars produced by RegPack and putting all the code in a string that will execute itself repeatedly using a timeout (1.58kb minified, 1042b regpacked) - the main achievement here was to achieve drawing the hypercube in a single pass, using only connected edges and not passing more than one time by the same edge, thanks to <a href="images/js1k15-4.png" target=_blank>this <s>wonderful</s> crazy path</a> I've drawn on paint (other funny <a href="https://twitter.com/MaximeEuziere/status/566947180267982849" target=_blank>bug</a>)
  <p>&bull; <a href="demos/hypercube/7.html">Beta #7</a>, YAY EPILEPTIC PARTY! very buggy but I find it artistic. (see <a href="https://twitter.com/MaximeEuziere/status/567068576239345665" target=_blank>gif</a>)
  <p>&bull; <a href="demos/hypercube/8.html">Beta #8</a>, stabilized and golfed a bit more (1.56kb minified, 974b regpacked)
  <p>&bull; <a href="demos/hypercube/9.html">Beta #9</a>, I tried to fill the hypercube in red but it was a bad idea. (<a href="https://twitter.com/MaximeEuziere/status/569130388939010049" target=_blank>related tweet</a>)
  <p>&bull; <a href="demos/hypercube/10.html">Beta #10</a> finished, with an extra feature to slow down or speed up the animation (1.57kb minified, 1021b regpacked)
  <p>Making this demo helped me understand better the 4th dimension, and even if I only scratched the surface, I find it amazing. I was surprised to see so many features and graphic effects fit in 1kb, thanks to many epic golfing tricks, but also hand-made line-drawing (see demo #6), as well as dirty hacks to optimize the code for RegPack (repeating big chunks as much as possible to reduce entropy), and faking the perspective effect by just drawing lines on a canvas and making the points closer to each other to give the impression that they are further from the camera...</p>
  <p>To achieve so many things, the secret holds in two words: passion and organization. If you want to see how organized it is, you can read the source code below. I detailed it as much as I could to make it useful for anyone wanting to discover the tricks used inside.
  <p>Thanks for your attention and see you next year!
  <br>
  <br>
  <img src="images/js1k15-5.png">
  <br>
  <br>
  </p>
  <hr>
  <br>
  <p><h3>Source code</h3>
  <p><b>Commented (5735b)</b>
  <br>
  <button onclick=commentedhypercube.style.display='block';this.style.display='none'>Show</button>
  <pre id=commentedhypercube class=code style=display:none>// Golf & build process
// ====================

// The content of the following loop function above is:
// * golfed
// * minified with Closure Compiler
// * cleaned (bacause CC leaves unnecessary spaces)
// * RegPacked (NB: in RegPack settings, add "a b c _ X Y Z" to the list of unrenamable vars)
// and the result is submitted to js1k


// What happens in this demo
// =========================
// - When the demo loads, Regpack generates and evals a string: _.
// - It also leaves the variable g to null
// - When _ is eval'ed, it draws the current frame and sets a timeout to re-eval itself, and so on
      

// Variables
// =========

// a: canvas
// b: body
// c: canvas context2d
// d: which animation (0: none, 1: X, 2: Y, 3: Z)
// e: animation direction (1 = forward, 3 = backwards)
// f: array containing the coordinates of all the points of the tesseract (to read 3 by 3). They are arranged to form a hamiltonian path where all edges are used only once (see http://img.ctrlv.in/img/15/02/14/54dfca5f4c396.png)
// g: null at the beginning, then truthy while the demo plays
// h: rotation state (0: pause, 1: play)
// i: iterator
// j: lines color's input
// k: perspective (-10 to 10: 2.5d do exaggerated 3D)
// l: mouse X
// m: mouse Y
// n: demo state (0: pause, 1: play)
// o: demo frame counter
// p: rotation frame counter
// q: number of frames in an animation loop
// r: unused
// s: unused
// t: temp var
// u: X coordinate of each point projected on a cube (0 => 1, 1 => 1, 2 => 2, 3 => 2)
// v: Y coordinate of each point projected on a cube
// w: Z coordinate of each point projected on a cube
// x: X coordinate of each point in the tesseract
// y: Y coordinate of each point in the tesseract
// z: Z coordinate of each point in the tesseract


// This simulates the state of _ and g after unpacking.
_ = "";
g = null;

loop = function(){

// ==============
// RegPacked code
// ==============

// Initializations (only at the first frame, when g is null)
// ---------------

if(!g){

  // Variables
  d =
  e =
  h = 
  k = 
  o = 
  n =
  p = 
  l =
  m = 0;
  
  // Body background
  b.style.background = "#112233";

  // Points coordinates (full version: [[0,0,0],[3,0,0],[3,3,0],[2,2,1],[2,1,1],[3,0,0],[3,0,3],[2,1,2],[2,2,2],[1,2,2],[1,2,1],[1,1,1],[2,1,1],[2,1,2],[1,1,2],[1,1,1],[0,0,0],[0,0,3],[1,1,2],[1,2,2],[0,3,3],[3,3,3],[3,0,3],[0,0,3],[0,3,3],[0,3,0],[3,3,0],[3,3,3],[2,2,2],[2,2,1],[1,2,1],[0,3,0],[0,0,0]] )
  g = f = "030000300330221211300303212222122121111211212112111000003112122033333303003033030330333222221121030000".split("");
  
  // Inputs & buttons
  document.write("&lt;center>&lt;input type=range style=width:6em oninput=k=value/5-9>&lt;input type=color value=#112233 oninput=b.style.background=value>&lt;input type=color value=#ffffff id=j>&lt;p>&lt;button onclick=p=1==d?q-p:q;h=1;d=1;e=1>X&lt;button onclick=p=1==d?q-p:q;h=1;d=1;e=3>-X&lt;button onclick=p=2==d?q-p:q;h=1;d=2;e=1>Y&lt;button onclick=p=2==d?q-p:q;h=1;d=2;e=3>-Y&lt;button onclick=p=3==d?q-p:q;h=1;d=3;e=1>Z&lt;button onclick=p=3==d?q-p:q;h=1;d=3;e=3>-Z&lt;/button>&lt;p>&lt;button onclick=h=1-h>pause&lt;button onclick=if(q&lt;2048)p*=2,q*=2>slow&lt;button onclick=if(4&lt;q)p/=2,q/=2>fast");
  
  q = 256;
  
  // When mouse moves
  onmousemove = function(e){
    
    // Get X
    l = (a.width - e.pageX * 2) / 50;
    
    // Get Y
    m = (350 - e.pageY * 2) / 30;
    
    // Start animation
    n = 1;
  };
}

// Main loop
// =========

// If demo has started, increment frame counter
if(n){
  o++;
}

// If current animation is not in pause, play it. Reset it when it's finished (to loop)
if(h){
  p = (p + q - 1) % q;
}

// Flush canvas (doesn't work on IE T_T )
a.width += 0;


// Loop on all the points
for(i = f.length; i-=3;){

  // Get its "real" position (in the tesseract)
  x = +f[i];
  y = +f[i+1];
  z = +f[i+2];
  
  // Get its projected position on a cube
  u = x &lt; 2 ? 1 : 2;
  v = y &lt; 2 ? 1 : 2;
  w = z &lt; 2 ? 1 : 2;
  
  
  // During the first 170 frames, animate from 0d (point) to 1d (line) to 2D (square) to 3D (cube) to 4d (tesseract)
  if(o &lt; 170){
  
    x = (
      o &lt; 30                                // if o &lt; 30
      ? 1.5 + (i &lt; 30 ? .01 : 0)            // x = 1.5 + a little X delta to show the initial dot on non-Firefox browsers (T_T)
      : o &lt; 50                              // else if o &lt; 50
        ? 1.5 + (u - 1.5) * (o - 30) / 20   // x = a value between 1.5 and the closest position from the center
        : o &lt; 150                           // else if o &lt; 170
          ? u                               // x = the closest position
          : u + (x - u) * (o - 150) / 20    // x = a value between the closest position and the final position
    );
    
    y = (
      o &lt; 70                                // if o &lt; 70
      ? 1.5                                 // y = 1.5
      : o &lt; 90                              // else if o &lt; 90
        ? 1.5 + (v - 1.5) * (o - 70) / 20   // y = a value between 1.5 and the closest position from the center
        : o &lt; 150                           // else if o &lt; 170
          ? v                               // y = the closest position
          : v + (y - v) * (o - 150) / 20    // y = a value between the closest position and the final position
    );
    
    z = (
      o &lt; 110                               // if o &lt; 110
      ? 1.5                                 // z = 1.5
      : o &lt; 130                             // else if o &lt; 130
        ? 1.5 + (w - 1.5) * (o - 110) / 20  // z = a value between 1.5 and the closest position from the center
        : o &lt; 150                           // else if o &lt; 170
          ? w                               // z = the closest position
          : w + (z - w) * (o - 150) / 20    // z = a value between the closest position and the final position
    );
  }
  
  // After the introduction, when the buttons are clicked, 4D animations are performed
  else {
    
    // X / Y / Z animations
    t = ([x,x,y,z][d] + e) % 4;
    u = x &lt; 2 ? [0,1,1,0][t] : 3 - [0,1,1,0][t];
    v = y &lt; 2 ? [0,1,1,0][t] : 3 - [0,1,1,0][t];
    w = z &lt; 2 ? [0,1,1,0][t] : 3 - [0,1,1,0][t];
    
    if(d == 1){
      u = t;
    }
    
    if(d == 2){
      v = t;
    }
    
    if(d == 3){
      w = t;
    }
    
    // x,y,z in-between
    x = x + (u - x) * p / q;
    y = y + (v - y) * p / q;
    z = z + (w - z) * p / q;
  }
  
  c.lineTo(
    a.width / 2 - 100 + x * 60 - (x - 1.5) * (z - 1.5) * (k + 9) + l * (z - 1.5),
    80 + y * 60 - (y - 1.5) * (z - 1.5) * (k + 9) + m * (z - 1.5)
  );
}

// Decrease line width progressively from 35 to 2.
c.lineWidth = o &lt; 99 ? 35 - o / 3 : 2;

// Set lines style
c.lineCap = c.lineJoin = "round";
c.strokeStyle = j.value;

// Draw the lines
c.stroke();

// Draw the next frame in 30ms.
setTimeout(_,30);

// =====================
// End of RegPacked code
// =====================

};

// This simulates the timeout inside the packed code
loop();
setInterval(loop, 30);</pre>
  <p><b>Minified (1550b)</b>
  <br>
  <button onclick=minifiedhypercube.style.display='block';this.style.display='none'>Show</button>
  <pre id=minifiedhypercube class=code style=display:none>g||(d=e=h=k=o=n=p=l=m=0,b.style.background="#112233",g=f="030000300330221211300303212222122121111211212112111000003112122033333303003033030330333222221121030000".split(""),document.write("&lt;center>&lt;input type=range style=width:6em oninput=k=value/5-9>&lt;input type=color value=#112233 oninput=b.style.background=value>&lt;input type=color value=#ffffff id=C>&lt;p>&lt;button onclick=p=1==d?J-p:J;h=1;d=1;e=1>X&lt;button onclick=p=1==d?J-p:J;h=1;d=1;e=3>-X&lt;button onclick=p=2==d?J-p:J;h=1;d=2;e=1>Y&lt;button onclick=p=2==d?J-p:J;h=1;d=2;e=3>-Y&lt;button onclick=p=3==d?J-p:J;h=1;d=3;e=1>Z&lt;button onclick=p=3==d?J-p:J;h=1;d=3;e=3>-Z&lt;/button>&lt;p>&lt;button onclick=h=1-h>pause&lt;button onclick=if(J&lt;2048)p*=2,J*=2>slow&lt;button onclick=if(4&lt;J)p/=2,J/=2>fast"),J=256,onmousemove=function(r){l=(a.width-2*r.pageX)/50;m=(350-2*r.pageY)/30;n=1});n&&o++;h&&(p=(p+J-1)%J);a.width+=0;for(i=f.length;i-=3;)S=+f[i],y=+f[i+1],T=+f[i+2],u=2>S?1:2,v=2>y?1:2,w=2>T?1:2,170>o?(S=30>o?1.5+(30>i?.01:0):50>o?1.5+(u-1.5)*(o-30)/20:150>o?u:u+(S-u)*(o-150)/20,y=70>o?1.5:90>o?1.5+(v-1.5)*(o-70)/20:150>o?v:v+(y-v)*(o-150)/20,T=110>o?1.5:130>o?1.5+(w-1.5)*(o-110)/20:150>o?w:w+(T-w)*(o-150)/20):(t=([S,S,y,T][d]+e)%4,u=2>S?[0,1,1,0][t]:3-[0,1,1,0][t],v=2>y?[0,1,1,0][t]:3-[0,1,1,0][t],w=2>T?[0,1,1,0][t]:3-[0,1,1,0][t],1==d&&(u=t),2==d&&(v=t),3==d&&(w=t),S+=(u-S)*p/J,y+=(v-y)*p/J,T+=(w-T)*p/J),c.lineTo(a.width/2-100+60*S-(S-1.5)*(T-1.5)*(k+9)+l*(T-1.5),80+60*y-(y-1.5)*(T-1.5)*(k+9)+m*(T-1.5));c.lineWidth=99>o?35-o/3:2;c.lineCap=c.lineJoin="round";c.strokeStyle=C.value;c.stroke();setTimeout(_,30)</pre>
  <p><b>Packed (1024b)</b>
  <br>
  <button onclick=packedhypercube.style.display='block';this.style.display='none'>Show</button>
  <pre id=packedhypercube class=code style=display:none>for(_='on~e=R-1.5)QQ*(PPo-O30N0N000M0+60*L0)/20KinputIroundHbutt~G11F=(E0>o?DD1.5BB+(A212@=t),idthtylePTPk+9)+)*p/J?1:2,=+f[i;R1>;c.stroke-2*r.page ~I=&lt;G ~click=p===d&&(;R3>-33[0,1,1,0][t]F2valuea.w>&lt;I typR	=2>c.lineb.s.backgH=)*(o-15KK:15D	color =#?:3-,==d?J-p:J;h=1;d=g||(d=Rh=k=o=n=p=l=m=0,"#2",g=f="MN002@FN0N3@22@@F12F100000312200N0N0N03222221M".split(""),document.write("&lt;center	range s=w:6emk=/5-92ffffff id=C>&lt;p>11X11X22Y22Y33Z33Z&lt;/G>&lt;p>h=1-h>pauseif(J&lt;2048)p*=2,J*slowif(4&lt;J)p/=2,J/fast"),J=256,~mousemovRfuncti~(r){lEX)/50;mE350Y)/N;n=1});n&&o++;h&&(pEp+J-1)%J);+=0;for(i=f.length;i-=3;)S],y+1],T+2],uSvywT17D(S=3AN>i?.01:0):5AuO3u:u+(S-u,y=7B:9AvO7v:v+(y-v,T=FB:13AwOFw:w+(T-w):(tE[S,S,y,T][d]+e)%4,uSvywT1u2v3wS+Eu-S,y+Ev-y,T+Ew-T),To(/2-10LS-(Sl*(TQ,8Ly-(ym*(TQ);W=99>o?35-o/3:2;Cap=Join="H"S=C.();setTimeout(_,N)';g=/[^ -?CJS-}]/.exec(_);)with(_.split(g))_=join(shift());eval(_) &lt;3</pre>
  <hr>
  <p>In case you were wondering, yeah, I used almost all the alphabet as variable names. This demo contains a big state machine needing all those variables. And yes, it's a heart at the end of the RegPacked code, because I had 3 bytes left and "eval(_) <3" is totally valid. It's useless but it's my way to say that the demo was made with love! :D
  <p>Cheers,
  <br><b>Xem</b>
  <br>
  <br>
  PS: <a href="https://twitter.com/js1k/status/569436901901520896" target=_blank style="font-size: 25px">please retweet if you liked it!</a>
</div>

<div class=section id=js13k2014>
	<h2>JS13k 2014 post-mortem </h2>
	<h3>september 2014</h3>
  <p><a href=//js13kgames.com>JS13kgames</a> is an annual code golfing competition where you can build (desktop / mobile / server-based) HTML5 games that have to fin in a 13kb zip.</p>
  <p>13kb is <a href=//twitter.com/mrspeaker/status/234946942214496256>like, infinity</a> for extreme code golfers, but we decided to give it a try anyway:</p>
  <p>I made <b>AlcheMixer</b> by myself, you can try it <a href=//js13kgames.com/entries/alchemixer>here</a></p>
  <p>I also made <b>Quintessence</b> with @subzey and @nderscore, you can try it <a href=//js13kgames.com/entries/quintessence>here</a> and read @subzey's great notes <a href=//gist.github.com/subzey/b18c482922cd17693d65>here</a>!</p>
  <p>Sadly, we didn't have time, and didn't even need, to golf the source code of those games, as they were way under the 13kb mark at the end of the month... But it was fun anyway!</p>
  <p>Hope you like them! For the record, AlcheMixer was ranked 72th in the desktop games category and Quintessence 8th in the mobile games category.</p>
  <p>Cheers, @MaximeEuziere</p> 
</div>

<div class=section id=dom>
	<h2>DOM oddities</h2>
	<h3>july-october 2014</h3>
  <p>This article will cover a few oddities I found by writing bizarre HTML and inspecting the DOM. I'll update it when I find new things:
  <hr>
  <p><b>Head</b>
  <p>The HEAD element is hidden by default on all Web pages.
  <br>
  It can contain elements such as META, TITLE, LINK, STYLE, SCRIPT and BASE.
  <br>
  But what happens when you force them to be visible, and editable? Here's the answer: <a href=//xem.github.io/show>Show</a> !
  <br>
  <br>
  <iframe src="https://xem.github.io/show" width=700 height=700></iframe>
  <p>As you can see, all those elements can behave like regular DIVs. Even the META, LINK and BASE can become containers, even if they are generally used as self-contained elements (without children nor closing tag). Some browsers even allow to edit the TITLE block and update the browser's titlebar accordingly. Also, the LINK element is shown as an Anchor even though it's not really clickable.
  <hr>
  <p><b>Paragraphs</b>
  <p>&bull; A paragraph can't contain another paragraph. If you try to do something like &lt;p>&lt;p>&lt;/p>&lt;/p>, not two but three neighbours &lt;P>s are added in the DOM: the outer one, the inner one, and an empty one caused by the final &lt;/p>. Anyway, they won't be nested:
  <br>
  <br>
  <iframe src="https://xem.github.io/miniCodeEditor/1.1/#%7Fp%20{%20background%3A%20%23def%3B%20padding%3A%2010px%20}%7F%3Cp%3EOuter%3Cp%3Einner%3C/p%3E%3C/p%3E1" width=700 height=400></iframe>
  <p>Same thing if you change their display to "inline", they can't be nested at all:
  <br>
  <br>
  <iframe src="https://xem.github.io/miniCodeEditor/1.1/#%7Fp%20{%0A%20%20display%20%3A%20inline%3B%20%0A%20%20background%3A%20%23def%3B%0A%20%20padding%3A%2010px%3B%0A%20%20margin%3A%2010px%0A}%7F%3Cp%3EOuter%20%3Cp%3Einner%3C/p%3E%3C/p%3E1" width=700 height=400></iframe>
  <br>
  ... Unless you write the inner paragraph with JS:
  <br><br>
  <iframe src="http://xem.github.io/miniCodeEditor/1.1/#p.innerHTML%20%3D%20%22%3Cp%3EYo%22p%20%7B%20background%3A%20%23def%3B%20border%3A%201px%20dotted%20red%20%7D%3Cp%20id%3Dp%3E1" width=700 height=400></iframe>
  <br>
  <hr>
  <p><b>Anchors</b>
  <br>
  Anchors (&lt;A>) behave like paragraphs in the sense that they can't be nested:
  <br>
  <br>
  <iframe src="https://xem.github.io/miniCodeEditor/1.1/#%7Fa%20{%20background%3A%20%23def%3B%20margin%3A%2010px%3B%20padding%3A%2010px%20}%7F%3Ca%3ELink%201%0A%3Ca%3Elink%202%0A1" width=700 height=400></iframe>
  <br>
  But something strange happens when you try to nest an anchor in a paragraph in an anchor:
  <br>
  <br>
  <iframe src="https://xem.github.io/miniCodeEditor/1.1/#%7Fa%20{%20float%3A%20left%3B%20padding%3A%2010px%3B%20margin%3A%2010px%3B%20background%3A%20%23def%20}%7F%3Ca%3ELink%201%0A%3Cp%3E%0A%3Ca%3ELink%2021" width=700 height=400></iframe>
  <br>
  That's right, a third empty A is added into the DOM! Go figure...
  <br>
  <hr>
  <br>
  <p><b>HTML, HEAD and BODY</b>
  <br>
  <p>The HTML, HEAD and BODY tags are optional in the HTML source, but are automatically added in the DOM by the browsers. Did you know they can be removed too?</p>
  <iframe src="http://xem.github.io/miniCodeEditor/1.1/#%3Chtml%20id%3Dhtml%3E%0A%3Chead%20id%3Dhead%3E%0A%20%20%3Cstyle%3Ebody%20%7Bbackground%3A%20%23def%20%7D%3C/style%3E%0A%3C/head%3E%0A%3Cbody%20id%3Dbody%3E%0A%20%20%3Cbutton%20onclick%3Dhtml.remove%28%29%3ERemove%20HTML%3C/button%3E%0A%20%20%3Cbutton%20onclick%3Dhead.remove%28%29%3ERemove%20HEAD%3C/button%3E%0A%20%20%3Cbutton%20onclick%3Dbody.remove%28%29%3ERemove%20BODY%3C/button%3E%0A%3C/body%3E%0A%3C/html%3E1" width=700 height=400></iframe>
  <br>
  <p>There's another thing that browsers do automatically: they place some HTML tags in the HEAD and other tags in the BODY, as long as they are in the right order: </p>
  <iframe src="http://xem.github.io/miniCodeEditor/1.1/#%7F%7F%3Ctitle%3Etitle%3C/title%3E%0A%3Cmeta%20charset%3Dutf-8%3E%0A%3Clink%20rel%3Dstylesheet%20href%3Dstyle.css%3E%0A%3Cp%3Eparagraph%3C/p%3E%0A%3Cbr%3E%0A%3Cbutton%20onclick%3Dalert%28document.documentElement.innerHTML%29%3ESee%20the%20DOM%3C/button%3E1" width=700 height=400></iframe>
  <br>
  <br>
  <p>But if your HTML source contains HEAD-related elements after BODY-related elements, they'll be in the body (but they'll stay hidden, of course):</p>
  <iframe src="http://xem.github.io/miniCodeEditor/1.1/#%7F%7FHi%0A%3Ctitle%3Etitle%3C/title%3E%0A%3Cmeta%20charset%3Dutf-8%3E%0A%3Clink%20rel%3Dstylesheet%20href%3Dstyle.css%3E%0A%3Cbr%3E%0A%3Cbutton%20onclick%3Dalert%28document.documentElement.innerHTML%29%3ESee%20the%20DOM%3C/button%3E1" width=700 height=400></iframe>
  <br>
  <br>
  <br>
  <hr>
  <br>
  <br>
  <b>To be continued...</b>
</div>

<div class=section id=js1k_2pgames>
	<h2>JS1k 2014 post-mortem: 2P Games</h2>
	<h3>march 2014</h3>
  <p>Welcome again, to the making-of of <a href= target=_blank>2P Games classic</a> and <a href=//js1k.com/2014-dragons/demo/1933 target=_blank>2P Games ++</a>, my team projects for <a href=//js1k.com target=_blank>JS1k</a> 2014.
  <p>I've made these games with the awesome code golfer <b>Subzey</b>, who helped me in many code-golfing projects last year<br>(<a href=//github.com/xem/miniCodeEditor target=_blank>a JSfiddle clone</a>, <a href=//github.com/xem/chip8 target=_blank>a chip8 emulator</a>, <a href=//github.com/xem/paste target=_blank>a Pastebin clone</a>, <a href=//github.com/xem/JSciissors target=_blank>a JS packer</a>,  <a href=//gist.github.com/xem/7086007 target=_blank>a JS-to-unicode converter</a>, ...)
  <hr>
  <p><h3>Source code</h3>
  <p><b>Commented (5735b)</b>
  <br>
  <button onclick=commented2pg.style.display='block';this.style.display='none'>Show</button>
  <pre id=commented2pg class=code style=display:none>/** Globals **/
// a: init function
// b: body
// c, d, e: board size
// f: rules (0: reversi / 1: find 4 / 2: XnO / 3: XnO 3D)
// g: game state (0: game over / 1: playing)
// h: HTML
// i, j, k, l: loop vars
// m: model (array filled with -1/0/1)
// p: current player(1: O / -1: X)
// q: onclick

/** Specific vars for init function **/
// i: lines
// j: columns
// k: cell number

/** Specific vars for play function **/
// c,d,e: params

// XnO, XnO3D, Find 4
// r: sum of the marks that are needed to win

// Reversi:
// s: cell is playable (0: not playable / 1: playable)
// t: direction is playable
// u, v: loop vars
// w: score

/** Unicode space: " " **/


// Draw function (redraw everything after each move)
// c: reset (if == 0)
a=function(c,d,e){
  
  // Init cell number, HTML
  l=0;
  h="&lt;center>&lt;font face=arial>&lt;p>&lt;button onclick=m=[];f=2;a(p=g=s=1)>XnO&lt;button onclick=m=[];f=3;a(p=g=s=1)>XnO3D&lt;button onclick=m=[];f=1;a(p=g=s=1)>Find4&lt;button onclick=m=[];f=w=0;m[27]=m[36]=-1;m[28]=m[35]=1;a(p=g=s=1)>Flip&lt;/button>&lt;p>";
  
  // Show HTML and game status
  
  if(c){

    // Loop on tables, write table HTML
    for(i="1113"[f];i--;){
    
      h+="&lt;/table>&lt;p>&lt;table border>";
    
      // Loop on lines
      for(j="8633"[f];j--;)

        // Write line HTML, loop on cells
        for(h+="&lt;tr>",k="8733"[f];k--;)
        
          // Write cell HTML
          h+="&lt;th width=20 onclick=q("+[l,7-j,7-k]+") id=t"+l+">"+"X.O"[1+(m[l]=m[l++]||0)];
    }
  
    h+="&lt;/table>&lt;p>";
    
    // Board not full
    if(~m.indexOf(0)){
    
      h+=(
        g
        ?
          
        // Game not over: show next
        "XnO"[p+1]+" next&lt;p>"
        
        :
        
        // Game over (not reversi): show winner
        "XnO"[-p+1]+" won"
      )
      
      // Reversi
      if(!f){
      
        // Leader, pass button
        h+=(w?w>0?"O>X":"X>O":"O=X")+"&lt;p>&lt;button onclick=a(p=-p)>pass";
      }
    }
    
    // Board full
    else{

      h+=
      
      f
      
      ?
      
      // Not reversi: show winner or draw
      (g?"draw":"XnO"[-p+1]+" won")
      
      :
        
      // Reversi: show winner or draw
      (w?w>0?"O won":"X won":"draw")
    }
  }

  b.innerHTML=h;
}

a();

// onclick
// c: current cell number
// d: current cell's line
// e: current cell's column
q=function(c,d,e){
  
  // If the game is not over and the cell is empty
  if(g&&!m[c]){
  
    // XnO / XnO 3D
    if(f>1){
    
      // Put a mark
      // Update model, set total
      // Test victory
      for(i=3;i--;)
        for(j=3;j--;)
          if(
            k=i*9,
            l=j*3,
            ~[
              m[k+j]+m[k+j+3]+m[k+j+6], // Columns 2D
              m[k+l]+m[k+l+1]+m[k+l+2], // Lines 2D
              m[k+4]+m[k+0]+m[k+8], // Diagonals 2D
              m[k+4]+m[k+2]+m[k+6], // Diagonals 2D
              m[l+10]+m[l]+m[l+20], // Lines 3D
              m[l+10]+m[l+2]+m[l+18], // Lines 3D
              m[i+12]+m[i]+m[i+24], // Columns 3D
              m[i+12]+m[i+6]+m[i+18], // Columns 3D
              m[13]+m[0]+m[26], // Diagonals 3D
              m[13]+m[2]+m[24], // Diagonals 3D
              m[13]+m[6]+m[20], // Diagonals 3D
              m[13]+m[8]+m[18], // Diagonals 3D
              m[l+i]+m[l+i+9]+m[l+i+18] // Same cell in all tables
            ].indexOf((m[c]=p)*3)
          )
          g=0;
    }
    
    // Find 4
    if(f==1){
    
      // If a wrong cell is clicked, apply gravity
      for(;35>c&&!m[c+7];c+=7);

      // Test if 4 marks are aligned
      for(i=6;i--;)
        for(j=7;j--;)
          if(
            k=i*7+j,
            ~[
              j&lt;4&&m[k]+m[k+1]+m[k+2]+m[k+3], // Horizontally
              i&lt;3&&m[k]+m[k+7]+m[k+14]+m[k+21], // Vertically
              i&lt;3&&j&lt;4&&m[k]+m[k+8]+m[k+16]+m[k+24], // Diagonally 1
              i&lt;3&&j>2&&m[k]+m[k+6]+m[k+12]+m[k+18] // Diagonally 2
            ].indexOf((m[c]=p)*4)
          )
          g=0;
    }

    // Reversi
    if(!f){

      // Reset cell's playability
      s=0;

      // For each direction
      for(i=2;~i--;){
        for(j=2;~j--;){

          // Reset that direction's playability
          // If the neighbour is the opponent
          if(i|j&&(t=0,m[8*(d+i)+e+j]==-p)){

            // Loop on the next neighbours in that direction
            // If current color is found, stop, good direction
            // If an empty cell is found, stop, bad direction
            for(
              k=d+i,l=e+j;
              ~k&&k&lt;9&&~l&&l&lt;9&&(m[8*k+l]!=p||!(s=t=1))&&m[8*k+l];
              k+=i,l+=j
            );

            // If this direction is playable
            if(t){

              // Loop on the opposite neighbours
              for(
                u=d,v=e;
                u!=k||v!=l;
                u+=i,v+=j
              ){

                // Toggle them
                m[u*8+v]=p;
              }
            }
          }
        }
      }
      
      // Compute score
      w=0;
      for(i=64;i--;){
        w+=m[i];
      }
    }

    // Change player
    if(s)p=-p;
    
    // Redraw board
    a(1);
  }
}</pre>
  <p><b>Minified (1613b)</b>
  <br>
  <button onclick=minified2pg.style.display='block';this.style.display='none'>Show</button>
  <pre id=minified2pg class=code style=display:none>a=function(c,d,e){l=0;h="&lt;center>&lt;font face=arial>&lt;p>&lt;button onclick=m=[];f=2;a(p=g=s=1)>XnO&lt;button onclick=m=[];f=3;a(p=g=s=1)>XnO3D&lt;button onclick=m=[];f=1;a(p=g=s=1)>find4&lt;button onclick=m=[];f=w=0;m[27]=m[36]=-1;m[28]=m[35]=1;a(p=g=s=1)>flip&lt;/button>&lt;p>";if(c){for(i="1113"[f];i--;)for(h+="&lt;/table>&lt;p>&lt;table border>",j="8633"[f];j--;)for(h+="&lt;tr>",k="8733"[f];k--;)h+="&lt;th width=20 onclick=q("+[l,7-j,7-k]+") id=t"+l+">"+"X\xa0O"[1+(m[l]=m[l++]||0)];h+="&lt;/table>&lt;p>";~m.indexOf(0)?(h+=g?"XnO"[p+1]+" next&lt;p>": "XnO"[-p+1]+" won",f||(h+=(w?0&lt;w?"O>X":"X>O":"O=X")+"&lt;p>&lt;button onclick=a(p=-p)>pass")):h+=f?g?"draw":"XnO"[-p+1]+" won":w?0&lt;w?"O won":"X won":"draw"}b.innerHTML=h};a();q=function(c,d,e){if(g&&!m[c]){if(1&lt;f)for(i=3;i--;)for(j=3;j--;)if(k=9*i,l=3*j,~[m[k+j]+m[k+j+3]+m[k+j+6],m[k+l]+m[k+l+1]+m[k+l+2],m[k+4]+m[k+0]+m[k+8],m[k+4]+m[k+2]+m[k+6],m[l+10]+m[l]+m[l+20],m[l+10]+m[l+2]+m[l+18],m[i+12]+m[i]+m[i+24],m[i+12]+m[i+6]+m[i+18],m[13]+m[0]+m[26],m[13]+m[2]+m[24],m[13]+m[6]+m[20],m[13]+m[8]+m[18],m[l+i]+m[l+i+9]+m[l+i+18]].indexOf(3*(m[c]=p)))g=0;if(1==f){for(;35>c&&!m[c+7];c+=7);for(i=6;i--;)for(j=7;j--;)if(k=7*i+j,~[4>j&&m[k]+m[k+1]+m[k+2]+m[k+3],3>i&&m[k]+m[k+7]+m[k+14]+m[k+21],3>i&&4>j&&m[k]+m[k+8]+m[k+16]+m[k+24],3>i&&2&lt;j&&m[k]+m[k+6]+m[k+12]+m[k+18]].indexOf(4*(m[c]=p)))g=0}if(!f){s=0;for(i=2;~i--;)for(j=2;~j--;)if(i|j&&(t=0,m[8*(d+i)+e+j]==-p)){k=d+i;for(l=e+j;~k&&9>k&&~l&&9>l&&(m[8*k+l]!=p||!(s=t=1))&&m[8*k+l];k+=i,l+=j);if(t)for(u=d,v=e;u!=k||v!=l;u+=i,v+=j)m[8*u+v]=p}w=0;for(i=64;i--;)w+=m[i]}s&&(p=-p);a(1)}}</pre>
  <p><b>Packed (1024b)</b>
  <br>
  <button onclick=packed2pg.style.display='block';this.style.display='none'>Show</button>
  <pre id=packed2pg class=code style=display:none>for(_='+=Z];YonWhZVV"<U;a(S.indexOf(R18]]RQi+PL[K],KJ]+KIJP12IGl+FJF10IEtableC){Bif(A--;)@;H@Ak="draw"p+1]+"K8*XnO=0;=-p)k+]=w?0<w?"Ofor(i=<p>&&IHKki@H= wW"J13I],3>i3"[fY	buttW*(Kcp)))D=0U/C> Wclick==functiW(c,d,eB""[-Sp=D=s=1)><L=[Yf=alh="<center><fWt face=arial>233D1find4wK27K36-1;K28K351flip</>";AcB"111	i@<C border>",H="863	H@Utr>",k="873	k@Uth width=20M("+[l,7-H,7-k]+") id=t"+F">"+"X\\xa0O"[1+(KlKF+]||0)Y";~LR0)?(VD?""[ next": ,f||(V(>X":"X>O":"O=X")+"<a(p>pass")):Vf?D?:::"X:}b.innerHTML=h}S);MAD!Kc]BA1<f)3;39*i,l=3*H,~[KHH+3H+6JlF1F2J408J426ElIF20EF2IF18GiIP24GP6IP180I262I246I208I18JFiIFP9IFPQ3;A1==fB;35>c!Kc+7YcZ7);6;77*PH,~[4>123Kk714214>816242<612Q4}A!fBs2;~2;~H@Ai|H(t=0,(d+i)+e+HBk=d+i;l=e+H;~k9>k~l9>l(l]!=p||!(s=t=1))lY=i,F=H);At)u=d,T=e;u!=k||T!=l;uZi,TZH)u+Tp}w64;i@wZKi]}s(pS1)}}';g=/[^ -?DHLMOTX[-~]/.exec(_);)with(_.split(g))_=join(shift());eval(_)</pre>
  <hr>
  <p><h3>The idea</h3>
  <p>Subzey and I code-golfed <a href=//xem.github.io/MiniSweeper/ target=_blank>a minesweeper game in 480b</a> in 2013 and it was really fun and very instructive.
  <p>So, for JS1k 2014, I gave ourselves a big challenge: to fit as many 2-player games as possible in 1kb. Who knows, we could maybe fit three, four, five simple games in 1k...?
  <p>People have already made awesome 2-player games for JS1k (<a href=//js1k.com/2014-dragons/demo/1720 target=_blank>1</a>, <a href=//js1k.com/2013-spring/demo/1319 target=_blank>2</a>, <a href=//js1k.com/2011-dysentery/demo/941 target=_blank>3</a>, <a href=//js1k.com/2011-dysentery/demo/947 target=_blank>4</a>, <a href=//js1k.com/2010-first/demo/679 target=_blank>5</a>, <a href=//js1k.com/2010-first/demo/430 target=_blank>6</a>, <a href=//js1k.com/2010-first/demo/41 target=_blank>7</a>, <a href=//js1k.com/2010-first/demo/23 target=_blank>8</a>, <a href=//js1k.com/2010-first/demo/430 target=_blank>9</a>), but we've never seen game compilations, and that's why I chose to try that. I chose five board games:   Tic-Tac-Toe, Tic-Tac-Toe 3D, Four in a row, Reversi and Checkers.
  <br>
  <br>
  Then, we tried to implement those games separately, in good old HTML and JS (the boards are made with tables, not drawn on the canvas):
  <img src=images/2pg1.png width=700>
  <br>
  We quickly (and sadly) abandoned the last two games (reversi and checkers) because the first three already needed more than 2kb.
  <br>
  We gathered those 3 games into one, and golfed them as much as possible, until the whole demo could fit in 1kb. This process included reducing the graphics to the strict minimum (just tables, X and O's). It actually went under 750b, and from that point, we had to decide whether to enhance the graphics or add a fourth game. We decided to make 4 games in one (because that would be impressive), and make a 2k version with great graphics.
  <br>
  Besides the graphics, almost all our efforts have been made on the 1k version and its 4 games. Actually, we golfed that demo on three levels!
  <br>
  <hr>
  <p><b>1st level of golf: JS optimisation</b>
  <p>The first goal is indeed to have the shortest JS code possible.<br>
  A lot of effort has been made to fit the menu + the four playable games in 1613b.
  <p>The games needed a lot of variables, and we had to introduce 23 global vars. Almost all the alphabet, and most of them are heavily reused.
  <p>To save bytes and avoid any kind of DOM manipulation, all the elements on the screen are redrawn after each player's move.
  <p>Here's the program's structure:
  <pre class=code>// Draw function
a=function(c,d,e){
  
  // Init HTML (menu)
  // When a button of the menu is clicked, the game state is reset,
  // and the model m (an array representing the board) is initialized.
  h="&lt;center>&lt;font face=arial>&lt;p>&lt;button onclick=m=[];f=2;a(p=g=s=1)>XnO&lt;button onclick=m=[];f=3;a(p=g=s=1)>XnO3D&lt;button onclick=m=[];f=1;a(p=g=s=1)>Find4&lt;button onclick=m=[];f=w=0;m[27]=m[36]=-1;m[28]=m[35]=1;a(p=g=s=1)>Flip&lt;/button>&lt;p>";
  
  // If a game has been started
  if(c){

    // write table HTML (the board) according to the model
    // ... snip ...
    
    // Write informations under the board (current player, winner, ...)
    // ... snip ...

  }
  
  // Update page's &lt;body>
  b.innerHTML=h;
}

// Show the menu on load
a();

// Onclick (when a player clicks on the board to play)
q=function(c,d,e){
  
  // If the game is not over and the cell is empty
  if(g&&!m[c]){
  
    // Current player plays current game and updates the model
    // ... snip ...

    // Change player
    p=-p;
    
    // Redraw everything
    a(1);
  }
}</pre>
  <p>The board drawing snippet is very simple, and made of three loops. One for the boards, another one for the lines, and a last one for the cells of each line, depending on the model. "f" represents the current game (0: reversi / 1: find 4 / 2: XnO / 3: XnO 3D).
  <p>&lt;P>, &lt;TR> and &lt;TH> elements don't need to be closed.
  <p>&lt;TH> elements have the advantage of being bold and centered, but their borders are hidden when they are empty. That's why we use the blank character \xa0 in the empty cells. (i.e. the 0's in the model.)
  <pre class=code>// Loop on tables, write table HTML
for(i="1113"[f];i--;){

  h+="&lt;/table>&lt;p>&lt;table border>";

  // Loop on lines
  for(j="8633"[f];j--;)

    // Write line HTML, loop on cells
    for(h+="&lt;tr>",k="8733"[f];k--;)
    
      // Write cell HTML
      h+="&lt;th width=20 onclick=q("+[l,7-j,7-k]+") id=t"+l+">"+"X\xa0O"[1+(m[l]=m[l++]||0)];
}
h+="&lt;/table>&lt;p>";</pre>
<p>The rules of each game were reduced to their minimum after a lot of iterations. After each click, the game updates the model and checks for a victory:<p>
<p><b>Tic-Tac-Toe, Tic-Tac-Toe 3D:</b>
<pre class=code>for(i=3;i--;)
  for(j=3;j--;)
    if(
      k=i*9,
      l=j*3,

      // In the model, the players marks are represented as 1 and -1.
      // If 3 or -3 is found in this array representing all the possible alignments,
      // it means that a player has won.
      ~[
        m[k+j]+m[k+j+3]+m[k+j+6], // Columns 2D
        m[k+l]+m[k+l+1]+m[k+l+2], // Lines 2D
        m[k+4]+m[k+0]+m[k+8], // Diagonals 2D
        m[k+4]+m[k+2]+m[k+6], // Diagonals 2D
        m[l+10]+m[l]+m[l+20], // Lines 3D
        m[l+10]+m[l+2]+m[l+18], // Lines 3D
        m[i+12]+m[i]+m[i+24], // Columns 3D
        m[i+12]+m[i+6]+m[i+18], // Columns 3D
        m[13]+m[0]+m[26], // Diagonals 3D
        m[13]+m[2]+m[24], // Diagonals 3D
        m[13]+m[6]+m[20], // Diagonals 3D
        m[13]+m[8]+m[18], // Diagonals 3D
        m[l+i]+m[l+i+9]+m[l+i+18] // Same cell in all tables
      ].indexOf((m[c]=p)*3) // here, we update the model and test the alignments
    )
    g=0; // game over</pre>
<p><b>Find four:</b>
<pre class=code>// If a wrong cell is clicked, apply gravity
for(;35>c&&!m[c+7];c+=7);

// Test if 4 marks are aligned
for(i=6;i--;)
  for(j=7;j--;)
    if(
      k=i*7+j,
      ~[
        j&lt;4&&m[k]+m[k+1]+m[k+2]+m[k+3], // Horizontally
        i&lt;3&&m[k]+m[k+7]+m[k+14]+m[k+21], // Vertically
        i&lt;3&&j&lt;4&&m[k]+m[k+8]+m[k+16]+m[k+24], // Diagonally 1
        i&lt;3&&j>2&&m[k]+m[k+6]+m[k+12]+m[k+18] // Diagonally 2
      ].indexOf((m[c]=p)*4)
    )
    g=0;</pre>
<p><b>Reversi:</b>
<pre class=code>// Reset cell's playability
s=0;

// For each direction
for(i=2;~i--;){
  for(j=2;~j--;){

    // Reset that direction's playability
    // If the neighbour is the opponent
    if(i|j&&(t=0,m[8*(d+i)+e+j]==-p)){

      // Loop on the next neighbours in that direction
      // If current color is found, stop, good direction
      // If an empty cell is found, stop, bad direction
      for(
        k=d+i,l=e+j;
        ~k&&k&lt;9&&~l&&l&lt;9&&(m[8*k+l]!=p||!(s=t=1))&&m[8*k+l];
        k+=i,l+=j
      );

      // If this direction is playable
      if(t){

        // Loop on the opposite neighbours
        for(
          u=d,v=e;
          u!=k||v!=l;
          u+=i,v+=j
        ){

          // Toggle them
          m[u*8+v]=p;
        }
      }
    }
  }
}

// Compute score
w=0;
for(i=64;i--;){
  w+=m[i];
}</pre>
<p>After each move, all the screen is updated, including the board and the game status (leader, winner, draw, pass, etc...)<p>
<pre class=code>// Board not full
if(~m.indexOf(0)){

  h+=(
    g
    ?
      
    // Game not over: show next
    "XnO"[p+1]+" next&lt;p>"
    
    :
    
    // Game over (not reversi): show winner
    "XnO"[-p+1]+" won"
  )
  
  // Reversi
  if(!f){
  
    // Leader, pass button
    h+=(w?w>0?"O>X":"X>O":"O=X")+"&lt;p>&lt;button onclick=a(p=-p)>pass";
  }
}

// Board full
else{

  h+=
  
  f
  
  ?
  
  // Not reversi: show winner or draw
  (g?"draw":"XnO"[-p+1]+" won")
  
  :
    
  // Reversi: show winner or draw
  (w?w>0?"O won":"X won":"draw")
}</pre>
<p>All this code was minified with Google Closure Compiler and optimized manually.
<br>
<hr>
<p><b>2nd level of golf: RegPack optimization</b>
<p>The JS source could be much smaller than that, but when you deal with JS packers, the main rule is not to be short, it is to repeat yourself as much as possible. That's why many snippets of the code are arranged (and sometimes "unoptimized" to have a better result in a JS packer.
<br>
<hr>
<p><b>3rd level of golf: make the packed code smaller</b>
<p>During the development of this game, RegPack v3 was being developed by Siorki. Subzey and I used this tool up to its limits and helped the author improving it via Github. We also tweaked the regexp in the final result to lose a few extra bytes and fit the whole thing in 1k!
<pre class=code>for(_='/** snip **/';g=/[^ -?DHLMOTX[-~]/.exec(_);)with(_.split(g))_=join(shift());eval(_)</pre>
<br>
<hr>
<p><b>The 2K version</b>
<p>The only change in the "++" version is high-quality graphics. Here, the boards and the players marks can get the right shape, colors, borders, texts, which enhances the gaming experience a lot. Here's the code that changed in the "redraw" function:
<pre class=code>// Reversi
if(f==0){

  h+="&lt;table border>";
  for(j=8;j--;){
    h+="&lt;tr>";
    for(k=8;k--;){
      h+="&lt;th width=20 onclick=q("+[l,7-j,7-k]+") id=t"+l+" bgcolor=#5b5>"+["&lt;table bgcolor=0 width=20 height=20 class=i>&lt;/table>","\xa0","&lt;table bgcolor=#fff width=20 height=20 class=i>&lt;/table>"][1+(m[l]=m[l++]||0)];
    }
  }
  h+="&lt;/table>&lt;br>";

}

// 4 in a row
if(f==1){
  h+="&lt;table cellspacing=5 bgcolor=#aad>";
  for(j=6;j--;){
    h+="&lt;tr>";
    for(k=7;k--;){
      h+="&lt;th width=20 onclick=onclick=q("+[l,7-j,7-k]+") bgcolor=#fff style='border-radius:50%;overflow:hidden'>"+["&lt;table bgcolor=red width=20 height=20 class=i>&lt;/table>","\xa0","&lt;table bgcolor=yellow width=20 height=20 class=i>&lt;/table>"][1+(m[l]=m[l++]||0)];
    }
  }
  h+="&lt;/table>&lt;br>";
}

// Tic Tac Toe
if(f==2){
  h+="&lt;table style=border-collapse:collapse>";
  for(j=3;j--;){
    h+="&lt;tr>";
    for(k=3;k--;){
      h+="&lt;th width=20 onclick=q("+[l,7-j,7-k]+") style='"+(j?"border-bottom:2px solid;":"")+(k?"border-right:2px solid;":"")+"'>"+"X\xa0O"[1+(m[l]=m[l++]||0)];
    }
  }
  h+="&lt;/table>&lt;br>";
}

// Tic Tac Toe 3D
if(f==3){
  for(i=3;i--;){
    h+="&lt;table border style=margin-left:"+(4*(1-i))+"em>";
    for(j=3;j--;){
      h+="&lt;tr>";
      for(k=3;k--;){
        h+="&lt;th width=20 onclick=q("+[l,7-j,7-k]+")>"+"X\xa0O"[1+(m[l]=m[l++]||0)];
      }
    }
    h+="&lt;/table>&lt;br>";
  }
}

// Board not full
if(~m.indexOf(0)){

  h+=(
    g
    ?
      
    // Game not over: show next
    "Next player: &lt;b>"+
    [
      ["&lt;table bgcolor=0 width=20 height=20 class=i>&lt;/table>","\xa0","&lt;table bgcolor=#fff width=20 height=20 class=i>&lt;/table>"],
      ["&lt;table bgcolor=red width=20 height=20 class=i>&lt;/table>","\xa0","&lt;table bgcolor=yellow width=20 height=20 class=i>&lt;/table>"],
      "X\xa0O",
      "X\xa0O"
    ][f][p+1]+"&lt;/b>"
    
    :
    
    // Game over (not reversi): show winner
    "&lt;b>"+[
      ["&lt;table bgcolor=0 width=20 height=20 class=i>&lt;/table>","\xa0","&lt;table bgcolor=#fff width=20 height=20 class=i>&lt;/table>"],
      ["&lt;table bgcolor=red width=20 height=20 class=i>&lt;/table>","\xa0","&lt;table bgcolor=yellow width=20 height=20 class=i>&lt;/table>"],
      "X\xa0O",
      "X\xa0O"
    ][f][-p+1]+"&lt;/b> won!"
  )
  
  // Reversi
  if(!f){
  
    // Leader, pass button
    h+="&lt;p>&lt;button onclick=a(p=-p)>Pass";
  }
}

// Board full
else{

  h+=
  
  f
  
  ?
  
  // Not reversi: show winner or draw
  (g?"draw":
  [
    ["&lt;table bgcolor=0 width=20 height=20 class=i>&lt;/table>","\xa0","&lt;table bgcolor=#fff width=20 height=20 class=i>&lt;/table>"],
    ["&lt;table bgcolor=red width=20 height=20 class=i>&lt;/table>","\xa0","&lt;table bgcolor=yellow width=20 height=20 class=i>&lt;/table>"],
    "X\xa0O",
    "X\xa0O"
  ][f][-p+1]
  +" won!")
  
  :
    
  // Reversi: show winner or draw
  (w?w>0?"&lt;table bgcolor=#fff width=20 height=20 class=i>&lt;/table> won!":"&lt;table bgcolor=0 width=20 height=20 class=i>&lt;/table> won!":"Draw!")
}</pre>
<p>That's all folks! See ya!
<p>Maxime and Anton
</div>

<div class=section id=js1k_floppydragon>
	<h2>JS1k 2014 post-mortem: Floppy Dragon</h2>
	<h3>febuary 2014</h3>
  <p>Welcome to the making-of of <a href=//js1k.com/2014-dragons/demo/1704 target=_blank>Floppy Dragon</a>, my individual entry for <a href=//js1k.com target=_blank>JS1k</a> 2014.
  <p>In febuary 2014, all the Internet was talking about the game Flappy Bird, so I decided (for fun) to make a mini-game inspired by that, but featuring a dragon instead of a bird, and stalactites in a cave instead of pipes. I also wanted to introduce many cool details such as responsive display, nice animated graphics, random maps, increasing speed and difficulty, textual interface, etc. And, of course, it had to fit in 1k of JavaScript.
  <hr>
  <p><h3>Source code</h3>
  <p><b>Commented (2876b)</b>
  <br>
  <button onclick=commentedfd.style.display='block';this.style.display='none'>Show</button>
  <pre id=commentedfd class=code style=display:none>// Variables
// a: the canvas
// b: the body
// c: the canvas's 2d context
// d: (reused) game has started (0/1)
// e: game has ended (0/1)
// f: score
// g: the random map
// h: dragon's vertical speed
// i, j: dragon's coordinates x, y
// k: steps already passed (1 step = 20px)
// l: the game's framerate
// n: the game's loop function
// o: loop var
// p: dragon's drawing path
// v, w, y, z: temp vars

// Initialization
// Scale the scene as if it was 1000px high
c.scale(a.height/1E3,a.height/1E3);

// Reset
d=e=f=h=0;
g=[];
for(o=0;o<1E3;o++)
  g[o]=g[o+1E3]=8*Math.random()|1-1;
i=j=300;
k=20;
l=50;
g[20]=0;
g[40]=1;
g[60]=2;
g[80]=3;
g[100]=4;
g[110]=5;
g[120]=6;
g[140]=7;

// Controls (click / tap / press any key)
ontouchstart=onmousedown=onkeydown=function(){
  
  // If game is over, reset
  if(e){
    d=e=f=h=0;
    g=[];
    for(o=0;o<1E3;o++)
      g[o]=g[o+1E3]=8*Math.random()|1-1;
    i=j=300;
    k=20;
    l=50;
  }
  
  // If game is not over, start the game if it's not started, and jump
  else{
    h=45;
    d=1;
  }
};

// Game loop
(n=function(){

  // Background
  c.fillStyle="#E50";
  c.fillRect(0,0,4E4,4E4);
  
  // Walls
  c.fillStyle="#920";
  
  // Roof
  c.beginPath();
  c.moveTo(-k,0);
  for(o=2E3;o--;)
    o%20
    ?
    c.lineTo(40*o-k,20+4*g[o])
    :
    (c.lineTo(40*o-k,100*g[o]),c.lineTo(40*o-k-4,100*g[o]));
  c.lineTo(40*o-k,0);
  c.fill();
  
  // Ceiling
  c.beginPath();
  c.moveTo(-k,2E3);
  for(o=2E3;o--;)
    o%20
    ?
    c.lineTo(40*o-k,980-4*g[o])
    :
    (c.lineTo(40*o-k,100*(g[o]+3)),c.lineTo(40*o-k-4,100*(g[o]+3)));
  c.lineTo(40*o-k,1E3);
  c.fill();
  
  // Dragon
  p="fEFf&{{~_=,;=vviJ.jfVi/.OoyizyhkhEwf74)\n$fwwuvtU`"+(10<h?"iZ[*)yj:*im**y|Ktdww54#5Dy\iz[Kzi[Jiijk[e@1!":"zl]LfU{\lKtBUh{zzU66iigig5\n&iiyz{vfwwiyDfwiiE");
  c.fillStyle="#000";
  c.beginPath();
  c.moveTo(v=i-e,w=(j-=h)-e);
  for(o in p){
    y=8-2*(p.charCodeAt(o)>>4);
    z=16-2*(p.charCodeAt(o)&15);
    c.lineTo(v+=(e?y:z),w+=(e?-z:y));
  }
  c.fill();
  
  // Apply gravity if the game has started
  d&&(h-=6);
  
  // Loop on the map if we are far enough
  d&&!e&&(k+=20,4E4<k&&(k-=4E4));
  
  // Increase score and game speed after each obstacle
  !d||e||(k+280)%800||(f++,20<l&&l--);
  
  // Game over
  if(50>j||950<j||!((k+300)%800)&&(j<100*g[20*~~(k/800)+20]+50||j>100*g[20*~~(k/800)+20]+250))
    e=40;
  
  // Text
  c.fillStyle="#fff";
  c.font="6em Arial";
  d&&c.fillText(f,a.width/(a.height/1E3)/2-30*1,500);
  d||c.fillText("#FloppyDragon",a.width/(a.height/1E3)/2-30*11,500);
  e&&c.fillText("score",a.width/(a.height/1E3)/2-30*4,400);
  c.fillText(e?"restart":!d?"start":"",a.width/(a.height/1E3)/2-30*5,600);
  
  // Loop
  setTimeout(n,l)
})()</pre>
  <p><b>Minified (1507b)</b>
  <br>
  <button onclick=minifiedfd.style.display='block';this.style.display='none'>Show</button>
  <pre id=minifiedfd class=code style=display:none>c.scale(a.height/1E3,a.height/1E3);d=e=f=h=0;g=[];for(o=0;1E3>o;o++)g[o]=g[o+1E3]=8*Math.random()|0;i=j=300;k=20;l=50;ontouchstart=onmousedown=onkeydown=function(){if(e){d=e=f=h=0;g=[];for(o=0;1E3>o;o++)g[o]=g[o+1E3]=8*Math.random()|0;i=j=300;k=20;l=50}else h=45,d=1};(n=function(){c.fillStyle="#E50";c.fillRect(0,0,4E4,4E4);c.fillStyle="#920";c.beginPath();c.moveTo(-k,0);for(o=2E3;o--;)o%20?c.lineTo(40*o-k,20+4*g[o]):(c.lineTo(40*o-k,100*g[o]),c.lineTo(40*o-k-4,100*g[o]));c.lineTo(40*o-k,0);c.fill();c.beginPath();c.moveTo(-k,2E3);for(o=2E3;o--;)o%20?c.lineTo(40*o-k,980-4*g[o]):(c.lineTo(40*o-k,100*(g[o]+3)),c.lineTo(40*o-k-4,100*(g[o]+3)));c.lineTo(40*o-k,1E3);c.fill();p="fEFf&{{~_=,;=vviJ.jfVi/.OoyizyhkhEwf74)\n$fwwuvtU`"+(10<h?"iZ[*)yj:*im**y|Ktdww54#5Dy\iz[Kzi[Jiijk[e@1!":"zl]LfU{\lKtBUh{zzU66iigig5\n&iiyz{vfwwiyDfwiiE");c.fillStyle="#000";c.beginPath();c.moveTo(v=i-e,w=(j-=h)-e);for(o in p)y=8-2*(p.charCodeAt(o)>>4),z=16-2*(p.charCodeAt(o)&15),c.lineTo(v+=e?y:z,w+=e?-z:y);c.fill();d&&(h-=6);d&&!e&&(k+=20,4E4<k&&(k-=4E4));!d||e||(k+280)%800||(f++,20<l&&l--);if(50>j||950<j||!((k+300)%800)&&(j<100*g[20*~~(k/800)+20]+50||j>100*g[20*~~(k/800)+20]+250))e=40;c.fillStyle="#fff";c.font="6em Arial";d&&c.fillText(f,a.width/(a.height/1E3)/2-30,500);d||c.fillText("#FloppyDragon",a.width/(a.height/1E3)/2-330,500);e&&c.fillText("score",a.width/(a.height/1E3)/2-120,400);c.fillText(e?"restart":d?"":"start",a.width/(a.height/1E3)/2-150,600);setTimeout(n,l)})()</pre>
  <p><b>Packed (1024b)</b>
  <br>
  <button onclick=packedfd.style.display='block';this.style.display='none'>Show</button>
  <pre id=packedfd class=code style=display:none>_='c.scale(,	;ontouchH=onmousedown=onkeydowif(e){	}else h=45,d=1};(Eq";Rect(0,0,^,^9Q"-k,0Q+N),0()-k,2E3980-(+3)N(+3)),Y(p="fEFf&{{~_=,;=vviJ.jfVi/.OoyizyhkhEwf74)\\n$fwwuvtU`"+(10<h?"iZ[*)yj:*im**y|Ktdww54#5Dy\\iz[Kzi[Jiijk[e@1!":"zl]LfU{\\lKtBUh{zzU66iigig5\\n&iiyz{vfwwiyDfwiiE"0"v=i-e,w=(j-=h)-eG in p)y=8>>4),z=16&15),Iv+=e?y:z,w+=e?-z:y(dW(h-=6dW!eW(k+=Q,^<kW(k-=^)!dXeX(k+280)%8X(f++,Q<lWl--if(q>jX9q<jX!((k+3)%8)W(j<qXj>2q))e=40;fff";c.font="6em Arial";dWf1,5dX"#FloppyDragon"11,5eW"score"4,4e?"reH":d?"":"H"5,6setTimeout(n,l)})()I40*o-k,a.width/()/2-30*	d=e=f=h=0;g=[];G=0;Y>o;o++)=g[o+Y]=8*Math.random()|0;i=j=3;k=Q;l=qc.fill;c.beginPath(c.moveTo(Style="#G=2E3;o--;)o%Q?,a.height/Y1*g[Q*~~(k/8)+Q]+);g[o]-2*(p.charCodeAt(o)Text(00n=function(){4*):(,1*Gfor(oHstartIc.lineTo(N),-4,1*Q20W&&X||Y1E3^4E4q50';for(Y in $='q^YXWQNIHG	')with(_.split($[Y]))_=join(pop());eval(_)</pre>
  <hr>
  <p><h3>Responsive display</h3>
  <img src=images/fd1.png width=700>
  <p>In JS1k entries, <b>a</b> represents a fullscreen canvas, and <b>c</b> represents the 2D context of this canvas. On load, the canvas' width and height are automatically set to the innerWidth and innerHeight of the window. There are many ways to draw into this canvas, but I chose the following approach:<br>
  First, I scale the canvas' context with this ratio:
  <pre class=code>c.scale(a.height/1E3,a.height/1E3);</pre>
  Then, the game just has to draw on the canvas' context as if it was 1000px high and infinitely long, and the drawing will spread on all the screen.
  <p>For the orange background, I simply draw a huge rectangle on the canvas when I start rendering each frame:
  <pre class=code>// Background
c.fillStyle="#E50";
c.fillRect(0,0,4E4,4E4);</pre>
  <hr>
  <p><h3>Random map</h3>
  <img src=images/fd2.png width=700>
  <p>In the source code of Floppy Dragon, there's a little piece of code that initializes the game. This code is executed on load, but also when the player loses and decides to try again. In this snippet, I generate an array <b>g</b> with 1000 random integers between 0 and 7, stored from index 0 and index 1000:
  <pre class=code>g=[];
for(o=0;o<1E3;o++)
  g[o]=g[o+1E3]=8*Math.random()|1-1;</pre>
  <p>In the game loop, this array is used as a heightmap to draw the upper and lower walls of the cave, and the obstacles:<br>
  A new "step" is drawn every 40px to make the walls look less flat, and an obstacle is drawn every 20 steps. All these points depend on the heightmap values. The obstacles use these values x 100.
  <p>To sum up, the walls are just two big polygons that are drawn with a very similar code, the only difference is that they are mirrored and show the obstacles in a complementary way (a 300px gap is kept between each pair of stalactites)
  In the following code, k represents the horizontal offset of the scene. This rendering is performed at each frame.
  <pre class=code>// Draw the walls
c.fillStyle="#920";

// Roof
c.beginPath();
c.moveTo(-k,0);
for(o=2E3;o--;)
  o%20
  ?
  // Wall
  c.lineTo(40*o-k,20+4*g[o])
  :
  // Obstacle
  (c.lineTo(40*o-k,100*g[o]),c.lineTo(40*o-k-4,100*g[o]));
c.lineTo(40*o-k,0);
c.fill();

// Ceiling
c.beginPath();
c.moveTo(-k,2E3);
for(o=2E3;o--;)
  o%20
  ?
  // Wall 
  c.lineTo(40*o-k,980-4*g[o])
  :
  // Obstacle
  (c.lineTo(40*o-k,100*(g[o]+3)),c.lineTo(40*o-k-4,100*(g[o]+3)));
c.lineTo(40*o-k,1E3);
c.fill();</pre>
  <p>The maps repeats itself every 1000 steps, thanks to this code that goes 4000px back as soon as the game scrolls more than 4000px:
  <pre>// Loop on the map if we are far enough
  d&&!e&&(k+=20,4E4&lt;k&&(k-=4E4));</pre>
  <hr>
  <p><h3>User interface</h3>
  <p>The user interface is made of different texts showing the game name, the score, and a start / restart message. These texts are centered and scaled. In the following code, <b>d</b> is set if the game is started, <b>f</b> is the score, and <b>e</b> is set if the game is over.
  <pre class=code>// Text
  c.fillStyle="#fff";
  c.font="6em Arial";
  d&&c.fillText(f,a.width/(a.height/1E3)/2-30*1,500);
  d||c.fillText("#FloppyDragon",a.width/(a.height/1E3)/2-30*11,500);
  e&&c.fillText("score",a.width/(a.height/1E3)/2-30*4,400);
  c.fillText(e?"restart":!d?"start":"",a.width/(a.height/1E3)/2-30*5,600);</pre>
  <p>User interface also means controls, and the controls are simple: press any key or click or tap to start, flap, or restart. When those events are fired, the "reset sequence" is executed (if the game is over), or the dragon flaps (if the game is running, or starting). <b>h</b> represents the vertical speed of the dragon, <b>i</b> and <b>j</b> represent its coordinates, and <b>l</b> is the game's speed.
  <pre>// Controls
ontouchstart=onmousedown=onkeydown=function(){
  
  // If game is over, reset
  if(e){
    d=e=f=h=0;
    g=[];
    for(o=0;o<1E3;o++)
      g[o]=g[o+1E3]=8*Math.random()|1-1;
    i=j=300;
    k=20;
    l=50;
  }
  
  // If game is not over, start the game if it's not started, and jump
  else{
    h=45;
    d=1;
  }
};</pre>
  <p>Talking about framerate, as I explained earlier, the game's speed is increasing. A variable (<b>l</b>) holds the number of milliseconds between each frame. It starts at 50 and is decremented after each obstacle passed, with a lower limit of 20. The rendering function is called recursively with the corresponding timeout:
  <pre class=code>// Game loop
(n=function(){

  // ... snip ...
  
  // Increase score and game speed after each obstacle
  !d||e||(k+280)%800||(f++,20&lt;l&&l--);
  
  // ... snip ...
  
  // Loop
  setTimeout(n,l)
})()</pre>
  <p>At each frame, we also apply gravity (i.e. increment the vertical coordinate of the dragon)
  <pre class=code>// Apply gravity if the game has started
d&&(h-=6);</pre>
  <p>Finally, we have to detect when the game is lost (when the dragon's head hits the floor or the ceiling or an obstacle. Here's how it is done:
  <pre class=code>// Game over
if(50>j||950<j||!((k+300)%800)&&(j<100*g[20*~~(k/800)+20]+50||j>100*g[20*~~(k/800)+20]+250))
  e=1;</pre>
  <hr>
  <p><h3>Draw the dragon</h3>
  <p>Last but not least, when all the game mechanics are ready, and the code is minified and packed, I have only 360 bytes left to draw the hero of the game: the dragon.
  I thought I could simply use a unicode character such as <a href=//www.fileformat.info/info/unicode/char/1f409/index.htm target=_blank>U+1F409</a> or <a href=//www.fileformat.info/info/unicode/char/1f432/index.htm target=_blank>U+1F432</a>. But these models are not very good-looking, and they aren't displayed correctly on all browsers.
  <p>I could also use pixel art (<a href=//js1k.com/2014-dragons/demo/1659 target=_blank>like this</a>) or bezier curves (<a href=//js1k.com/2014-dragons/demo/1648 target=_blank>like that</a>) but this would have used too many characters to draw what I had in mind.
  <p>So I decided to draw a shape made of tiny lines, and compress it with a home-made technique:
  <img src=images/fd3.png>
  <p>The shape starts at the neck of the dragon. Each point of the shape has coordinates very close to the previous point. My goal was to store the X and Y coordinates of each point in an unique ASCII character. So I stored the X offset in the first 3 bits of each character (range: -4 to +4), and the Y offset in the last 4 bits (range: -8 to +8).
  <p>As a result, I was able to represent the dragon's body plus the two different wings shapes in just 196 characters (most of these are invisible).
  <pre class=code>p="fEFf&{{~_=,;=vviJ.jfVi/.OoyizyhkhEwf74)\n$fwwuvtU`"+(10&lt;h?"iZ[*)yj:*im**y|Ktdww54#5Dy\iz[Kzi[Jiijk[e@1!":"zl]LfU{\lKtBUh{zzU66iigig5\n&iiyz{vfwwiyDfwiiE");</pre>
  <p>And here is the code that draws the full shape at the good coordinates. Note that the coordinates are inverted when the dragon dies, in order to draw the falling animation.
  <pre class=code>
  c.fillStyle="#000";
  c.beginPath();
  c.moveTo(v=i,w=(j-=h));
  for(o in p){
    y=8-2*(p.charCodeAt(o)>>4);
    z=16-2*(p.charCodeAt(o)&15);
    c.lineTo(v+=(e?y:z),w+=(e?-z:y));
  }
  c.fill();</pre>
  <br>
  <hr>
  <p>To finish, a few final optimizations and JScrush helped me fit this game in 1024 bytes, and I submitted it two weeks after the beginning of the contest. It had the honor to be mentioned <a href=//twitter.com/js1k/status/433406361087401984 target=_blank>here</a> and <a href=//qfox.nl/weblog/312 target=_blank>here</a> by Peter van der Zee, who organizes JS1k every year.
  <p>Cheers,<br>
  Maxime
  <br>
  <br>
</div>


<div class=section id=implicitgetelementbyid_en>
  <img src=../english.png class=lang onclick="implicitgetelementbyid_en.style.display='none';implicitgetelementbyid_fr.style.display='block'">
	<h2>Implicit getElementById's</h2>
	<h3>october 2013</h3>
	<div id=getelementbyid>
		<p>What is the most useful JavaScript function, but also the most annoying to write? <b>document.getElementById()</b>, of course! It is so useful, and so long, that every decent JS library contains an alias for to call it easily (generally <b>$()</b>).</p>
    <p>But did you know that we often don't even need to call it? Indeed, all the browsers in use today (including IE6+) allow to access to an HTML element by using directly its <b>id</b> as a global var! It's a non-standard feature, yet it works very well everywhere.</p>
    <pre>&lt;div id="myId">&lt;/div>
&lt;script>
  alert(myId);                            // --> [object HTMLDivElement]
  alert(myId.id);                         // --> "myId"
  alert(window.myId.id);                  // --> "myId"
  alert(this.myId.id);                    // --> "myId"
  alert(self.myId.id);                    // --> "myId"
  alert('myId' in window);                // --> true
  alert(window.hasOwnProperty("myId"));   // --> true
&lt;/script></pre>
    <p>So "myId" is a property of window, but it's not "enumerable", so we can't see it by ny making a loop or a console.dir() on the window object:</p>
    <pre>
// Display the content of window:
console.dir(window);                      // myId is not présent.

// Loop through the properties of window:
var present = false;
for(var i in window){
  if(i == 'myId'){
    present = true;
  }
}
alert(present);                           // --> false
    </pre>
    <p>I experimented with this "feature" and found some funny things:</p>
    <p><b>An implicit id can't have the same name as a protected JS keyword:</b></p>
    <pre>&lt;div id=function>&lt;/div>
&lt;script>alert(function) // SyntaxError: Unexpected token )&lt;/script></pre>
		<br>
    <p><b>An implicit getElementById can't overload a native global var, such as window.screen:</b></p>
    <pre>&lt;div id=screen><&lt;/div>

&lt;script>
  screen.innerHTML = "screen";          // --> nothing happens
  alert(screen);                        // --> [object Screen]
&lt;/script></pre>
		<br>
    <p><b>Also, it can't redefine a global var defined earlier</b></p>
    <pre>&lt;script>
  global0 = 1;
&lt;/script>

&lt;div id=global0><&lt;/div>

&lt;script>
  global0.innerHTML = "global0";        // --> nothing happens
  alert(global0);                       // --> 1
&lt;/script></pre>
		<br>
    <p><b>A global var defined with the "window." prefix can overload an implicit getElementById</b></p>
    <pre>&lt;div id=global1>&lt;/div>

&lt;script>
  global1.innerHTML = "global1";        // --> the div contains the text "global1" 
  console.log(global1);                 // --> [object HTMLDivElement]
  window.global1 = 1;                   // Try to overload global1
  console.log(global1);                 // --> 1
&lt;/script></pre>
    <br>
    <p><b>If we try to overloas an implicit getElementById with a global var defined without any prefix, this is what happens:</b></p>
    <pre>&lt;div id=global2>&lt;/div>

&lt;script>
  global2.innerHTML = "global2";        // --> the div contains the text "global2" 
  try{global2 = 1}                      // Try to overload global2
  catch(e){alert(e)}                    // --> TypeError on IE < 9 / no error on other browsers
  console.log(global2);                 // --> [object HTMLDivElement] on IE < 9 / 1 on other browsers
&lt;/script></pre>
    <br>
    <p><b>Finally, if we try to overload an implicit getElementById with a global var defined with a "var", this is what happens:</b></p>
    <pre>&lt;div id=global3>&lt;/div>

&lt;script>
  global3.innerHTML = "global3";        // --> Uncaught TypeError: Cannot set property 'innerHTML' of undefined
  console.log(global3);                 // --> undefined
  var global3 = 1;                      // --> Try to overload global3
  console.log(global3);                 // --> 1
&lt;/script></pre>
    <br>
    <p>In this case, the keyword "var" on line 3 changes the order in which the JS code is parsed, and it breaks the lines 1 and 2.</p>
    <hr>
    <p>To conclude, this technique is useful in some particular cases where we don't want to use a heavy library nor call the long function <b>document.getElementById()</b>, especially in code golfing contests. But in real life, it's safer to use the good old native methods because the implicit <b>document.getElementById</b> comes with several traps, and can lead to hours of debugging...</p>
		<br>
		Cheers!
		<br>
		<b>@MaximeEuziere</b>
	</div>
</div>

<div class=section id=implicitgetelementbyid_fr style=display:none>
  <img src=../francais.png class=lang onclick="implicitgetelementbyid_fr.style.display='none';implicitgetelementbyid_en.style.display='block'">
	<h2>Les "getElementById" implicites</h2>
	<h3>octobre 2013</h3>
	<div id=getelementbyid_fr>
		<p>Quelle fonction JavaScript est la plus utile, et la plus embêtante à écrire? <b>document.getElementById()</b>, bien sûr! C'est tellement utile, et tellement long que toute librairie JS digne de ce nom crée un alias (généralement <b>$()</b>) pour pouvoir l'appeler facilement.</p>
    <p>Mais saviez-vous qu'on n'a, bien souvent, même pas besoin de l'appeler? En effet, tous les navigateurs qu'on peut trouver en circulation aujourd'hui (y compris IE6+) permettent d'accéder à un élément HTML en utilisant directement son <b>id</b> comme une variable globale! C'est un fonctionnement complètement non-standard, mais qui a le bon goût de marcher partout, et extrêmement bien.</p>
    <pre>&lt;div id="monId">&lt;/div>
&lt;script>
  alert(monId);                           // --> [object HTMLDivElement]
  alert(monId.id);                        // --> "monId"
  alert(window.monId.id);                 // --> "monId"
  alert(this.monId.id);                   // --> "monId"
  alert(self.monId.id);                   // --> "monId"
  alert('monId' in window);               // --> true
  alert(window.hasOwnProperty("monId"));  // --> true
&lt;/script></pre>
    <p>"monId" est bien une propriété window, mais il n'est pas énumérable, autrement dit, on ne tombera pas dessus si on fait une boucle ou un console.dir():</p>
    <pre>
// On affiche le contenu de window:
console.dir(window);                      // monId n'est pas présent.

// On itère sur les propriétés de window:
var present = false;
for(var i in window){
  if(i == 'monId'){
    present = true;
  }
}
alert(present);                           // --> false
    </pre>
    <p>J'ai fait quelques expériences avec cette "fonctionnalité", et j'ai découvert des choses rigolotes:</p>
    <p><b>Un id implicite ne peut pas avoir le même nom qu'un mot-clé JavaScript protégé</b></p>
    <pre>&lt;div id=function>&lt;/div>
&lt;script>alert(function) // SyntaxError: Unexpected token )&lt;/script></pre>
		<br>
    <p><b>Un getElementById implicite ne peut pas écraser une variable globale native, par exemple window.screen:</b></p>
    <pre>&lt;div id=screen><&lt;/div>

&lt;script>
  screen.innerHTML = "screen";          // --> rien ne se passe
  alert(screen);                        // --> [object Screen]
&lt;/script></pre>
		<br>
    <p><b>Il ne peut pas non plus écraser une variable globale définie auparavant:</b></p>
    <pre>&lt;script>
  global0 = 1;
&lt;/script>

&lt;div id=global0><&lt;/div>

&lt;script>
  global0.innerHTML = "global0";        // --> rien ne se passe
  alert(global0);                       // --> 1
&lt;/script></pre>
		<br>
    <p><b>Une variable globale définie avec le préfixe "window." peut écraser un getElementById implicite</b></p>
    <pre>&lt;div id=global1>&lt;/div>

&lt;script>
  global1.innerHTML = "global1";        // --> la div contient le texte "global1" 
  console.log(global1);                 // --> [object HTMLDivElement]
  window.global1 = 1;                   // Essayons d'écraser global1
  console.log(global1);                 // --> 1
&lt;/script></pre>
    <br>
    <p><b>Si on essaye d'écraser un getElementById implicite avec une variable globale définie sans aucun préfixe, voici ce qui se passe:</b></p>
    <pre>&lt;div id=global2>&lt;/div>

&lt;script>
  global2.innerHTML = "global2";        // --> la div contient le texte "global2" 
  try{global2 = 1}                      // Essayons d'écraser global2
  catch(e){alert(e)}                    // --> TypeError sur IE < 9 / pas d'erreur ailleurs
  console.log(global2);                 // --> [object HTMLDivElement] sur IE < 9 / 1 ailleurs
&lt;/script></pre>
    <br>
    <p><b>Et enfin, si on essaye d'écraser un getElementById implicite avec une variable globale définie avec un "var", voici ce qui se passe:</b></p>
    <pre>&lt;div id=global3>&lt;/div>

&lt;script>
  global3.innerHTML = "global3";        // --> Uncaught TypeError: Cannot set property 'innerHTML' of undefined
  console.log(global3);                 // --> undefined
  var global3 = 1;                      // --> Essayons d'écraser global3
  console.log(global3);                 // --> 1
&lt;/script></pre>
    <br>
    <p>Dans ce cas-là, la présence du mot-clé "var" à la ligne 3 change l'ordre dans lequel le code JS est parsé, et ça fait bugger les lignes 1 et 2.</p>
    <hr>
    <p>En conclusion, cette astuce est pratique dans quelques cas particuliers où on souhaite ni installer une lourde librairie, ni appeler la longue fonction <b>document.getElementById()</b>, notamment dans des épreuves de code golfing. Mais dans le cadre professionnel, il est plus prudent de continuer à utiliser les bonnes vieilles méthodes natives car les pièges des <b>document.getElementById</b> implicites sont nombreux, et ça peut mener à des heures de débogage...</p>
		<br>
		A bientôt!
		<br>
		<b>@MaximeEuziere</b>
	</div>
</div>

<div class=section id=textshadows_en>
  <img src=../english.png class=lang onclick="textshadows_en.style.display='none';textshadows_fr.style.display='block'">
	<h2>The joys of text-shadow... on IE.</h2>
	<h3>septembre 2013</h3>
	<div id=text-shadow_en>
		<p>We don't present <b>text-shadow</b> anymore, this CSS property allowing to set a shadow to a text.<br>(see: <a href="http://www.w3.org/TR/css3-text/#text-shadow" target=_blank>the specs</a>, <a href="https://developer.mozilla.org/fr/docs/CSS/text-shadow" target=-blank>the MDN page</a>)</p>
		<p>Many browsers have some small implementation problems, but the worst are, of course, the old IE. More precisely, IE &lt; 10.</p>
		<p>However, those browsers have access to proprietary "filters", created by Microsoft, and allowing to achieve a similar effect.<br>Sometimes, we have no other choice than using them. This article explains how.</p>
		<p>Two filters allow to simulate shadows: Shadow and Glow.</p>
		<p><b>Here is the "Shadow" version:</b></p>
		<p>CSS:</p>
		<pre style="white-space: nowrap; overflow: auto">h1 {
<br>
&nbsp; text-shadow: 2px 2px 3px #ff0000; /* IE10+, Firefox 3.5+, Opera 9.5+, Chrome, Safari, and mobile browsers */
<br>
&nbsp; filter:progid:DXImageTransform.Microsoft.Shadow(color='#ff0000', Direction=135, Strength=3); zoom: 1; /* IE 6-9 */
<br>
}</pre>
		<p>HTML:</p>
		<pre>&lt;h1>Shadowed title&lt;/h1></pre>
		<p>Rendu:</p>
  	<style class=hidden>h1.ombre1 { text-shadow: 2px 2px 3px #ff0000; filter:progid:DXImageTransform.Microsoft.Shadow(color='#ff0000', Direction=135, Strength=3); zoom: 1; }</style>
		<div class=demo>
			<h1 class=ombre1>Shadowed title</h1>
		</div>
		<p>If you look at this wonderful demo on an old IE (or on IE10 in legacy mode) you will see a shadow. But you will also notice that the text became all pixellized, and unfortunately, there is no solution for that.</p>
		<p>Please note that "Direction" is set in degrees (for example, 0 = up, 90 = right, 180 = bottom, 270 = left) and "Strength" vaguely corresponds to the shadow's spread. (in reality, it looks more like a perspective effect...)</p>
		<p><b>And here is the "Glow" version</b></p>
		<p>CSS:</p>
		<pre style="white-space: nowrap; overflow: auto">h1 {
<br>
&nbsp; text-shadow: 0px 0px 1px #ff0000; /* Good browsers */
<br>
&nbsp; filter: glow(color=#ff0000,strength=3); zoom: 1; /* IE 6-9 */
<br>
}</pre>
		<p>HTML:</p>
		<pre>&lt;h1>Glowing title&lt;/h1></pre>
		<p>Rendu:</p>
  	<style class=hidden>.ombre2 { text-shadow: 0px 0px 3px #ff0000; filter: glow(color=#ff0000,strength=1); zoom: 1; }</style>
		<div class=demo>
			<h1 class=ombre2>Glowing title</h1>
		</div>
		<p>The Glow filter mainly creates a halo around the text. But it's still quite ugly on IE. (you can have something less ugly if you don't exaggerate this much on the colours)</p>
		<hr>
		<p>Note that the filters can be combined, like the CSS3 text-shadows. It's useful, especially when we want a "text-stroke" effect.</p>
		<pre style="white-space: nowrap; overflow: auto">h1 {
<br>
&nbsp; text-shadow: 1px 1px 1px #ff0000, 1px -1px 1px #00ff00, -1px -1px 1px #0000ff, 1px 1px 1px #f0000f; /* Good browsers */
<br>
&nbsp; filter: progid:DXImageTransform.Microsoft.Shadow(color='#ff0000', Direction=0, Strength=1), progid:DXImageTransform.Microsoft.Shadow(color='#00ff00', Direction=90, Strength=1), progid:DXImageTransform.Microsoft.Shadow(color='#0000ff', Direction=180, Strength=1), progid:DXImageTransform.Microsoft.Shadow(color='#f0000f', Direction=270, Strength=1); zoom: 1; /* IE 6-9 */
<br>
}</pre>
		<p>HTML:</p>
		<pre>&lt;h1>Titre with many shadows&lt;/h1></pre>
		<p>Rendu:</p>
  	<style class=hidden>.ombre3 { text-shadow: 1px 1px 1px #ff0000, 1px -1px 1px #00ff00, -1px -1px 1px #0000ff, 1px 1px 1px #f0000f; filter: progid:DXImageTransform.Microsoft.Shadow(color='#ff0000', Direction=0, Strength=1), progid:DXImageTransform.Microsoft.Shadow(color='#00ff00', Direction=90, Strength=1), progid:DXImageTransform.Microsoft.Shadow(color='#0000ff', Direction=180, Strength=1), progid:DXImageTransform.Microsoft.Shadow(color='#f0000f', Direction=270, Strength=1); zoom: 1;}</style>
		<div class=demo>
			<h1 class=ombre3>Titre with many shadows</h1>
		</div>
		<p>Keep in mind that it's very verbose, and very ugly on IE, when it's not used correctly.</p>
		<hr>
		<p>Besides, I have an exclusive bug to show you:</p>
		<p>These browsers only work on block elements, not on inline elements.</p>
    <p>So if you need shadows on a &lt;span>, you'll have to write some nonsense like... <b>span { display: block }</b>.</p>
		<br>
		<br>
		Cheers!
		<br>
		<b>@MaximeEuziere</b>
	</div>
</div>

<div class=section id=textshadows_fr style=display:none>
  <img src=../francais.png class=lang onclick="textshadows_fr.style.display='none';textshadows_en.style.display='block'">
	<h2>Les joies du text-shadow... sur IE.</h2>
	<h3>septembre 2013</h3>
	<div id=text-shadow_fr>
		<p>On ne présente plus <b>text-shadow</b>, cette propriété CSS3 permettant d'appliquer une ombre à un texte.<br>(voir: <a href="http://www.w3.org/TR/css3-text/#text-shadow" target=_blank>les specs</a>, <a href="https://developer.mozilla.org/fr/docs/CSS/text-shadow" target=-blank>la page MDN</a>)</p>
		<p>Plusieurs navigateurs ont des petits soucis d'implémentation, mais les plus notables sont, bien évidemment, les vieux IE. Plus précisément, IE &lt; 10.</p>
		<p>Ceux-ci ont toutefois accès à des "filtres" créés par Microsoft, et qui permettant de produire un effet similaire.<br>Et parfois, on n'a pas le choix, il faut s'en servir. Voici comment faire.</p>
		<p>Deux filtres permettent de simuler des ombres: Shadow et Glow.</p>
		<p><b>Voici la version "Shadow":</b></p>
		<p>CSS:</p>
		<pre style="white-space: nowrap; overflow: auto">h1 {
<br>
&nbsp; text-shadow: 2px 2px 3px #ff0000; /* IE10+, Firefox 3.5+, Opera 9.5+, Chrome, Safari, et tous avigateurs mobiles */
<br>
&nbsp; filter:progid:DXImageTransform.Microsoft.Shadow(color='#ff0000', Direction=135, Strength=3); zoom: 1; /* IE 6-9 */
<br>
}</pre>
		<p>HTML:</p>
		<pre>&lt;h1>Titre ombré&lt;/h1></pre>
		<p>Rendu:</p>
  	<style class=hidden>h1.ombre1 { text-shadow: 2px 2px 3px #ff0000; filter:progid:DXImageTransform.Microsoft.Shadow(color='#ff0000', Direction=135, Strength=3); zoom: 1; }</style>
		<div class=demo>
			<h1 class=ombre1>Titre ombré</h1>
		</div>
		<p>Si vous regardez cette magnifique démo sur un vieux IE (ou sur IE10 en mode vieux IE) vous verrez bien une ombre. Mais vous verrez aussi que le texte est devenu tout pixellisé, et il n'y a hélas aucun moyen de corriger cela.</p>
		<p>Il est à noter que "Direction" s'exprime en degrés (par exemple, 0 = haut, 90 = droite, 180 = bas, 270 = gauche) et "Strength" correspond vaguement à l'étalement de l'ombre. (en réalité, ça ressemble plus à un effet de profondeur qu'à une ombre)</p>
		<p><b>Et voici la version "Glow"</b></p>
		<p>CSS:</p>
		<pre style="white-space: nowrap; overflow: auto">h1 {
<br>
&nbsp; text-shadow: 0px 0px 1px #ff0000; /* Bons navigateurs */
<br>
&nbsp; filter: glow(color=#ff0000,strength=3); zoom: 1; /* IE 6-9 */
<br>
}</pre>
		<p>HTML:</p>
		<pre>&lt;h1>Titre entouré d'ombre&lt;/h1></pre>
		<p>Rendu:</p>
  	<style class=hidden>.ombre2 { text-shadow: 0px 0px 3px #ff0000; filter: glow(color=#ff0000,strength=1); zoom: 1; }</style>
		<div class=demo>
			<h1 class=ombre2>Titre entouré d'ombre</h1>
		</div>
		<p>Le filtre Glow permet plutôt de créer un halo autour du texte. Cela dit, c'est bien moche sur IE. (oui, j'ai un peu exégéré avec mon texte en gras et mes ombres en rouge, il y a moyen de faire quelque chose qui soit... passable.)</p>
		<hr>
		<p></p>Il est à noter que les filters peuvent être additionés, tout comme les text-shadow CSS3. C'est pratique, notamment pour obtenir un effet à la "text-stroke" (pour dessiner le contour des lettres).</p>
		<pre style="white-space: nowrap; overflow: auto">h1 {
<br>
&nbsp; text-shadow: 1px 1px 1px #ff0000, 1px -1px 1px #00ff00, -1px -1px 1px #0000ff, 1px 1px 1px #f0000f; /* Bons navigateurs */
<br>
&nbsp; filter: progid:DXImageTransform.Microsoft.Shadow(color='#ff0000', Direction=0, Strength=1), progid:DXImageTransform.Microsoft.Shadow(color='#00ff00', Direction=90, Strength=1), progid:DXImageTransform.Microsoft.Shadow(color='#0000ff', Direction=180, Strength=1), progid:DXImageTransform.Microsoft.Shadow(color='#f0000f', Direction=270, Strength=1); zoom: 1; /* IE 6-9 */
<br>
}</pre>
		<p>HTML:</p>
		<pre>&lt;h1>Titre avec plusieurs ombres&lt;/h1></pre>
		<p>Rendu:</p>
  	<style class=hidden>.ombre3 { text-shadow: 1px 1px 1px #ff0000, 1px -1px 1px #00ff00, -1px -1px 1px #0000ff, 1px 1px 1px #f0000f; filter: progid:DXImageTransform.Microsoft.Shadow(color='#ff0000', Direction=0, Strength=1), progid:DXImageTransform.Microsoft.Shadow(color='#00ff00', Direction=90, Strength=1), progid:DXImageTransform.Microsoft.Shadow(color='#0000ff', Direction=180, Strength=1), progid:DXImageTransform.Microsoft.Shadow(color='#f0000f', Direction=270, Strength=1); zoom: 1;}</style>
		<div class=demo>
			<h1 class=ombre3>Titre avec plusieurs ombres</h1>
		</div>
		<p>Cela dit, c'est très verbeux, et également très moche sur IE si on s'en sert mal.</p>
		<hr>
		<p>A part ça, j'ai un petit bug bonus, en exclusivité:</p>
		<p>Ces filtres ne marchent que sur les blocs, et pas sur les éléments inline.</p>
		<p>Autrement dit, si on vous demande de mettre des ombres sur des <b>span</b>, la seule solution sera d'écrire le non-sens suivant: <b>span { display: block }</b> ... et prier pour que ça ne casse pas toute votre page...</p>
		<br>
		<br>
		A bientôt!
		<br>
		<b>@MaximeEuziere</b>
	</div>
</div>
	
	
<div class=section id=lists_en>
  <img src=../english.png class=lang onclick="lists_en.style.display='none';lists_fr.style.display='block'">
	<h2>Ordered and unordered lists</h2>
	<h3>august 2013</h3>
	<div id=listscontent_en>
		<p>HTML lists... we all know them by heart: they exist since the first versions of HTML and XHTML, and they almost didn't change since then. They also work on all browsers.</p>
		<p>Let's study their HTML.<br><b>&lt;ul></b> means "unordered list", <b>&lt;ol></b> means "ordered list", et <b>&lt;li></b> means "list item".<br>Here is their simplest form (note that the &lt;/li> are optionals)</p>
		<p><b>Demo:</b></p>
		<pre>&lt;ul>
  &lt;li>Element 1
  &lt;li>Element 2
  &lt;li>Element 3
&lt;/ul>

&lt;ol>
  &lt;li>Element 1
  &lt;li>Element 2
  &lt;li>Element 3
&lt;/ol></pre>
		Result:
		<div class=demo>
			<ul>
				<li>Element 1
				<li>Element 2
				<li>Element 3
			</ul>
			<br>
			<ol>
				<li>Element 1
				<li>Element 2
				<li>Element 3
			<ol>
		</div>
		<p>The <b>li</b> can also contain <b>ul</b> or <b>ol</b> sub-lists. (but we'll talk about that later)</p>
		<p>The lists also have specific attributes:</p>
		<ul>
			<li><b>&lt;ul></b> (and its <b>&lt;li></b>s) can have a "type" attribute, with the value "circle", "square" or "disc". This allows to change their ticks ("circle" by default).</li>
			<li><b>&lt;ol></b> (and its <b>&lt;li></b>s) can also have a "type" attribute, with values like "A", "a", "I", "i", "1". This allows to set their number notation ("1" by default).</li>
			<li>You should avoid the type attribute, and use CSS instead (we'll come to this later)</li>
			<li><b>&lt;ol></b> can have a "start" attribute telling where the numbering should begin, and its <b>&lt;li></b>s can have a "value" attribute to change their default number, and the following ones. (This works on IE6+)</li>
		</ul>
		<p><b>Démo:</b></p>
		<pre>&lt;ol start="10">
  &lt;li>Element 10
  &lt;li>Element 11
  &lt;li>Element 12
  &lt;li value="20">Element 20
  &lt;li>Element 21
  &lt;li>Element 22
  &lt;li value="5">Element 5
  &lt;li>Element 6
  &lt;li>Element 7
&lt;/ol></pre>
		Ce qui donne:
		<div class=demo>
			<ol start="10">
				<li>Element 10
				<li>Element 11
				<li>Element 12
				<li value="20">Element 20
				<li>Element 21
				<li>Element 22
				<li value="5">Element 5
				<li>Element 6
				<li>Element 7
			</ol>
		</div>
		<ul>
			<li>And finally,  <b>&lt;ol></b> can have a "reversed" attribute (appeared with HTML5) allowing to count the elements from bottom up. But since it doesn't work on IE &lt; 11, you should rather set a decreasing "value" to each <b>&lt;li></b> to get the same effect.</li>
		</ul>
		<hr>
		<p>Now let's see their default CSS code, and their dedicated CSS properties:</p>
		<p><b>&lt;ul></b> and <b>&lt;ol></b> are normal blocks (display: block). They have a default padding-left that depends on the browser (around 40px). The ticks are included in this padding and they can't be selected as normal text with the mouse.</p>
		<p><b>&lt;ul></b> has disc-shaped bullets (list-style: disc outside none).</p>
		<p><b>&lt;ol></b> has numbers in front of each element (list-style: decimal outside none).</p>
		<p><b>&lt;li></b> have a special display (display: list-item), almost identical to display: block. They also have a list-style (inherited), but they can overload it individually.</p>
		<p>
		The <b>list-style</b> property is a shorthand notation allowing to set three parameters:<br>
		<ul>
			<li><b>list-style-type</b> (that can have <a href="https://developer.mozilla.org/fr/docs/CSS/list-style-type" target=_blank>many many values</a>),</li>
			<li><b>list-style-position</b> (that can have the value "inside", "outside" or "inherit". Inside allows them to contain their own ticks, instead of letting them stay in their parent's padding.)</li>
			<li><b>list-style-image</b>, which is "none" by default, but it can also be the url of an image. If the URL is invalid (or if the image isn't fount), there is a fallback on the default list-style-type (disc, decimal, ...).</li>
		</ul>
		</p>
		<hr>
		<p>Now let's see the different problems that lists can cause us:</p>
		<p>&nbsp;&bull;
			If you apply a <a href="http://meyerweb.com/eric/tools/css/reset/" target=_blank>CSS reset</a> to your page, it will delete the paddings on <b>ul</b> and <b>ol</b> elements, and their ticks will be hidden.
			<br>
			<b>Solution 1</b>: put the ticks inside the <b>li</b> with this rule:
			<pre>ul, ol { list-style-position: inside }</pre>
			The ticks reappear, but we still lose the indentation of nested lists.
			<br>
			<pre>&lt;ul>
  &lt;li>list
  &lt;li>list
    &lt;ol>
      &lt;li>sub-list
      &lt;li>sub-list
    &lt;/ol>
&lt;/ul></pre>
			<div class=demo>
				<ul style="list-style-position: inside; margin: 0; padding: 0;">
				<li style="margin: 0; padding: 0;">list
				<li style="margin: 0; padding: 0;">list
					<ol style="list-style-position: inside; margin: 0; padding: 0; display: block">
						<li style="margin: 0; padding: 0;">sub-list
						<li style="margin: 0; padding: 0;">sub-list
					</ol>
				</ul>
			</div>

			<b>Solution 2 (the good one)</b>: don't change the ticks position, but re-set a padding-left to the lists, like this:
			<br>
			<pre>ul, ol { padding-left: 2em }</pre>
			Result:
			<div class=demo>
				<ul>
				<li>list
				<li>list
					<ol style="display:block">
						<li>sub-list</li>
						<li>sub-list</li>
					</ol>
				</ul>
			</div>
			Indeed, the padding-left are cumulative, and so the nested lists are correctly indented. 
		</p>
		<p>
		&nbsp;&bull; If we nest ordered lists, their numbers will stay the same (decimal notation). A good typographic practice is to do this:
			<pre>ol { list-style-type: decimal }
ol ol { list-style: upper-alpha }
ol ol ol { list-style:  lower-roman }
ol ol ol ol { list-style: lower-alpha }</pre>
			<br>
			Which allows nested lists as pretty as this, with up to four levels:
			<div class=demo>
			<ol>
				<li>level 1</li>
				<li>item</li>
				<li>item</li>
				<li><ol>
						<li>level 2</li>
						<li>item</li>
						<li>item</li>
						<li><ol>
								<li>level 3</li>
								<li>item</li>
								<li>item</li>
								<li><ol>
										<li>level 4</li>
										<li>item</li>
										<li>item</li>
									</ol>
							</ol>
					</ol>
			</ol>
			</div>
		</p>
		<p>
		&nbsp;&bull;
				The CSS resets generally set a vertical-align: baseline and a line-height: 1.5em to all the elements of the page, and this causes a problem on IE &lt; 8 when we have nested lists.
				<br>
				Indeed, if you watch the following list on IE &lt; 8, you will see the numbers "fall" at the bottom of the sub-lists, and the ticks will be misaligned with the text ahead.
				<br>
				<div class=demo>
				<ol>
					<li>level 1</li>
					<li>item</li>
					<li>item</li>
					<li style="vertical-align: baseline"><ol>
							<li>level 2</li>
							<li>item</li>
							<li>item</li>
							<li style="vertical-align: baseline"><ol>
									<li>level 3</li>
									<li>item</li>
									<li>item</li>
									<li style="vertical-align: baseline"><ol>
											<li>level 4</li>
											<li>item</li>
											<li>item</li>
										</ol>
								</ol>
						</ol>
				</ol>
			</div>
			<p>To fix the "falling" ticks, use this CSS dode:</p>
			<pre>ol, ul, li { vertical-align: top }</pre>
			<p>To fix the alignment between the ticks and the text, there is no miracle solution, but five possible approaches:</p>
			<ul>
				<li>Consider that an offset of a few pixels is not a big deal on IE &lt; 8, and do nothing.</li>
				<li>Put a "1em" line-height on all the page.</li>
				<li>Let the default line-height to "1.5em", but set the &lt;li>'s line-height to "1em" and their padding to "0.25em 0", which will do the job, unless the text of the &lt,li> spreads on two lines or more, because these lines would be very close.</li>
				<li>Replace the default tick with an image that looks like a tick, but with a few pixels of vertical offset.</li>
				<li>
					Or... (and this is the solution I recommend) put an element (like a &lt;span>) in each &lt;li>, and apply this style:
					<pre>li span { *position: relative; *top: -0.5em }</pre>
					Result:
					<div class=demo>
						<ul>
							<li><span style="*position: relative; *top: -0.5em">Item 1</span></li>
							<li><span style="*position: relative; *top: -0.5em">Item 2</span></li>
							<li><span style="*position: relative; *top: -0.5em">Item 3</span></li>
						</ul>
					</div>
				</li>
			</ul>
			<p>However, there is a bug on all the NEWER versions of IE (except IE6 and 7!), which you can see here:</p>
			<div class=demo>
			<ol>
				<li>level 1</li>
				<li>item</li>
				<li>item</li>
				<li><ol style="display: block">
						<li>level 2</li>
						<li>item</li>
						<li>item</li>
						<li><ol style="display: block">
								<li>level 3</li>
								<li>item</li>
								<li>item</li>
								<li><ol style="display: block">
										<li>level 4</li>
										<li>item</li>
										<li>item</li>
									</ol>
							</ol>
					</ol>
			</ol>
			</div>
			<p>Each sub-list has a huge gap on top. It's not a margin or a padding, it's an IE bug. To get rid of it, you can set float: left to the lists (but it could lead to flow issues), or put them in display: inline-block (that's what I recommend):</p>
			<pre>li ul, li ol { display: inline-block }</pre>
			<p>So, everything is correct now.</p>
			<p>Other list-related bugs and their solutions are described <a href="http://stylisticweb.com/design-tutorials/15-ie6-bugs-and-simple-solutions" target=_blank>here</a>, but I won't talk about them because they are too much specific.</p>
			<hr>
			<p>Instead, let's talk about the original things that we can do with HTML lists:</p>
			<ul>
				<li>
					A &lt;li> can live without a &lt;ol> or a &lt;ul> around it. In this case, it will have a circle-shaped tick (on all the browsers).
				</li>
				<li>
					A &lt;ul> / &lt;ol> can contain elements that are not &lt;li>. (or even some text). These elements won't have a tick or a number.
				</li>
				<li>
					There are several easy ways to display a list on many columns.<br><a href="http://alistapart.com/article/multicolumnlists" target=_blank>This article</a> is exhaustive on this subject.
				</li>
				<li>
					A list can look like a file tree with a simple 1px image and some ingenious CSS code: <a href="http://css-tricks.com/style-a-list-with-one-pixel/" target=_blank>take a look at this</a>.
				</li>
				<li>
					The &lt;li> elements can use one (or many) unicode character(s) as their ticks, thanks to CSS3 (and it works on IE8+):
					<pre>li { list-style: none }
li:before { content: ">>"; margin:0 1em 0 -3em;  }</pre>
          Result:
					<style style="display: none">
					.custombullet li { list-style: none }
					.custombullet li:before { content: ">>"; margin: 0 1em 0 -3em; }
					</style>
					<div class=demo>
						<ul class=custombullet>
							<li>Item 1</li>
							<li>Item 2</li>
							<li>Item 3</li>
						</ul>
					</div>
				</li>
			</ul>
			<p>I'll stop here, and I invite you to look at <a href="//xem.github.io/Blog" target="_blank">my last project, Basis</a>: a basic "boilerplate" for HTML/CSS/JS pages, with a custom CSS reset that contains all these best practices, and many others.</p>
			<br>
			<br>
			Cheers!
			<br>
			<b>@MaximeEuziere</b>
	</div>
</div>

<div class=section id=lists_fr style=display:none>
  <img src=../francais.png class=lang onclick="lists_fr.style.display='none';lists_en.style.display='block'">
	<h2>Les listes ordonnées et non-ordonnées</h2>
	<h3>août 2013</h3>
	<div id=listscontent_fr>
		<p>Les listes HTML... tout le monde les connaît par coeur: elles existent depuis les toutes premières versions d'HTML et XHTML, et sont restées quasiment inchangées jusqu'à aujourd'hui. Elles fonctionnent d'ailleurs sur tous les navigateurs.</p>
		<p>Etudions tout d'abord leur HTML.<br><b>&lt;ul></b> signifie "unordered list", <b>&lt;ol></b> signifie "ordered list", et <b>&lt;li></b> signifie "list item".<br>Voici leur écriture la plus simple: (vous noterez que les &lt;/li> sont optionnels)</p>
		<p><b>Démo:</b></p>
		<pre>&lt;ul>
  &lt;li>Element 1
  &lt;li>Element 2
  &lt;li>Element 3
&lt;/ul>

&lt;ol>
  &lt;li>Element 1
  &lt;li>Element 2
  &lt;li>Element 3
&lt;/ol></pre>
		Ce qui donne:
		<div class=demo>
			<ul>
				<li>Element 1
				<li>Element 2
				<li>Element 3
			</ul>
			<br>
			<ol>
				<li>Element 1
				<li>Element 2
				<li>Element 3
			<ol>
		</div>
		<p>Les <b>li</b> peuvent à leur tour contenir des sous-listes <b>ul</b> ou <b>ol</b>. (mais nous en reparlerons plus tard)</p>
		<p>Les listes ont également des attributs spécifiques:</p>
		<ul>
			<li>L'<b>&lt;ul></b> (et ses <b>&lt;li></b>) peuvent avoir un attribut type, ayant comme valeur "circle", "square" ou "disc". Cela permet de changer leurs puces (par défaut à "circle").</li>
			<li>L'<b>&lt;ol></b> (et ses <b>&lt;li></b>) peuvent aussi avoir un attribut type, ayant comme valeur "A", "a", "I", "i", "1". Cela permet de changer leurs numérotations (par défaut à "1").</li>
			<li>L'attribut type est toutefois à éviter, il vaut mieux faire ces modifications avec du CSS. (on va en reparler)</li>
			<li>L'<b>&lt;ol></b> peut avoir un attribut "start" disant où doit commencer la numérotation, et ses <b>&lt;li></b> peuvent avoir un attribut "value" changeant le numéro de l'élément courant, et de ceux qui suivent. (et c'est compatible IE6+)</li>
		</ul>
		<p><b>Démo:</b></p>
		<pre>&lt;ol start="10">
  &lt;li>Element 10
  &lt;li>Element 11
  &lt;li>Element 12
  &lt;li value="20">Element 20
  &lt;li>Element 21
  &lt;li>Element 22
  &lt;li value="5">Element 5
  &lt;li>Element 6
  &lt;li>Element 7
&lt;/ol></pre>
		Ce qui donne:
		<div class=demo>
			<ol start="10">
				<li>Element 10
				<li>Element 11
				<li>Element 12
				<li value="20">Element 20
				<li>Element 21
				<li>Element 22
				<li value="5">Element 5
				<li>Element 6
				<li>Element 7
			</ol>
		</div>
		<ul>
			<li>Et enfin, <b>&lt;ol></b> peut avoir un attribut "reversed" (apparu en HTML5) servant à compter à l'envers (de bas en haut). Mais vu qu'il ne fonctionne pas sur IE &lt; 11, il est préférable de mettre directement des "value" décroissantes à chaque <b>&lt;li></b> pour obtenir cet effet.</li>
		</ul>
		<hr>
		<p>Voyons maintenant leur code CSS par défaut, et les propriétés CSS qui leurs sont dédiées:</p>
		<p><b>&lt;ul></b> et <b>&lt;ol></b> sont des blocs classiques (display: block). Ils ont un padding-left qui varie selon les navigateurs (environ 40px). Les puces sont incluses dans ce padding et ne peuvent pas être sélectionnées à la souris, en tant que texte.</p>
		<p>L'<b>&lt;ul></b> a des puces en forme de disque (list-style: disc outside none).</p>
		<p>L'<b>&lt;ol></b> a des numéros en face de chaque élément (list-style: decimal outside none).</p>
		<p>Les <b>&lt;li></b> ont un affichage particulier (display: list-item), quasiment identique à du display: block. Ils ont également un list-style hérité de leur parent, mais qui peut être surchargé individuellement.</p>
		<p>
		La propriété CSS <b>list-style</b> est une écriture shorthand qui peut être utilisée pour fixer trois paramètres:<br>
		<ul>
			<li><b>list-style-type</b> (pouvant avoir <a href="https://developer.mozilla.org/fr/docs/CSS/list-style-type" target=_blank>une multitude de valeurs</a>),</li>
			<li><b>list-style-position</b> (qui peut avoir comme valeur "inside", "outside" et "inherit", inside leur permettant de contenir leurs puces, au lieu de les laisser dans le padding du parent.)</li>
			<li><b>list-style-image</b>, qui est par défaut à "none", mais qu'on peut remplacer par l'url d'une image. Si l'URL est invalide (ou si l'image est absente), c'est le list-style-type (disque, décimal, ...) qui sera utilisé comme fallback.</li>
		</ul>
		</p>
		<hr>
		<p>Voyons maintenant les différents problèmes que les listes peuvent nous poser:</p>
		<p>&nbsp;&bull;
			Si vous appliquez un <a href="http://meyerweb.com/eric/tools/css/reset/" target=_blank>CSS reset</a> à votre page, celui-ci va supprimer les paddings des <b>ul</b> et des <b>ol</b>, ce qui cachera leurs puces.
			<br>
			<b>Solution 1</b>: mettre les puces dans les <b>li</b> grâce à cette règle:
			<pre>ul, ol { list-style-position: inside }</pre>
			Les puces réapparaissent, mais on perd l'indentation des listes imbriquées.
			<br>
			<pre>&lt;ul>
  &lt;li>liste
  &lt;li>liste
    &lt;ol>
      &lt;li>sous-liste
      &lt;li>sous-liste
    &lt;/ol>
&lt;/ul></pre>
			<div class=demo>
				<ul style="list-style-position: inside; margin: 0; padding: 0;">
				<li style="margin: 0; padding: 0;">liste
				<li style="margin: 0; padding: 0;">liste
					<ol style="list-style-position: inside; margin: 0; padding: 0; display: block">
						<li style="margin: 0; padding: 0;">sous-liste
						<li style="margin: 0; padding: 0;">sous-liste
					</ol>
				</ul>
			</div>

			<b>Solution 2 (la bonne)</b>: ne pas toucher à la position des puces, mais remettre un padding-left aux listes, comme ceci:
			<br>
			<pre>ul, ol { padding-left: 2em }</pre>
			Ce qui donne:
			<div class=demo>
				<ul>
				<li>liste
				<li>liste
					<ol style="display:block">
						<li>sous-liste</li>
						<li>sous-liste</li>
					</ol>
				</ul>
			</div>
			En effet, les padding-left s'additionnent, ce qui permet à la sous-liste d'être plus indentée que sa liste parente. 
		</p>
		<p>
		&nbsp;&bull; Si on imbrique plusieurs listes ordonnées, leurs numérotations seront identiques (notation décimale). Une bonne pratique typographique consiste à faire ceci:
			<pre>ol { list-style-type: decimal }
ol ol { list-style: upper-alpha }
ol ol ol { list-style:  lower-roman }
ol ol ol ol { list-style: lower-alpha }</pre>
			<br>
			Ce qui permet d'avoir des listes imbriquées aussi jolies que ceci, quand quatre listes ordonnées sont imbriquées:
			<div class=demo>
			<ol>
				<li>level 1</li>
				<li>item</li>
				<li>item</li>
				<li><ol>
						<li>level 2</li>
						<li>item</li>
						<li>item</li>
						<li><ol>
								<li>level 3</li>
								<li>item</li>
								<li>item</li>
								<li><ol>
										<li>level 4</li>
										<li>item</li>
										<li>item</li>
									</ol>
							</ol>
					</ol>
			</ol>
			</div>
		</p>
		<p>
		&nbsp;&bull;
				Les CSS resets mettent généralement un vertical-align: baseline et un line-height: 1.5em à tous les éléments de la page, et ça pose problème sur IE &lt; 8 dans le cas où on a des listes imbriquées.
				<br>
				En effet, en regardant la liste suivante sur IE &lt; 8, vous verrez les numéros "tomber" tout en bas des sous-listes, et les puces seront mal alignées avec les textes en face.
				<br>
				<div class=demo>
				<ol>
					<li>level 1</li>
					<li>item</li>
					<li>item</li>
					<li style="vertical-align: baseline"><ol>
							<li>level 2</li>
							<li>item</li>
							<li>item</li>
							<li style="vertical-align: baseline"><ol>
									<li>level 3</li>
									<li>item</li>
									<li>item</li>
									<li style="vertical-align: baseline"><ol>
											<li>level 4</li>
											<li>item</li>
											<li>item</li>
										</ol>
								</ol>
						</ol>
				</ol>
			</div>
			<p>Pour corriger les puces qui "tombent", utilisez ce CSS:</p>
			<pre>ol, ul, li { vertical-align: top }</pre>
			<p>Pour corriger l'alignement entre les puces et le texte, il n'y a pas de solution miracle, mais cinq approches possibles:</p>
			<ul>
				<li>Soit considérer que quelques pixels de décalage sur IE &lt; 8, c'est pas grave, et ne rien faire.</li>
				<li>Soit mettre un line-height à "1em" sur toute la page.</li>
				<li>Soit laisser le line-height par défaut à "1.5em", mais mettre le line-height des &lt;li> à "1em" et leur padding à "0.25em 0", ce qui fera quasiment le même effet qu'un line-height: 1.5em, l'inconvénient étant que si le texte d'un &lt;li> s'étale sur deux lignes, ces lignes seront très collées.</li>
				<li>Soit remplacer la puce par une image qui a l'apparence d'une puce, mais décalée de quelques pixels vers le bas.</li>
				<li>
					Soit (et c'est la solution que je préconise) mettre un élément (par exemple &lt;span>) dans chaque &lt;li>, et appliquer ce style:
					<pre>li span { *position: relative; *top: -0.5em }</pre>
					Ce qui donne:
					<div class=demo>
						<ul>
							<li><span style="*position: relative; *top: -0.5em">Item 1</span></li>
							<li><span style="*position: relative; *top: -0.5em">Item 2</span></li>
							<li><span style="*position: relative; *top: -0.5em">Item 3</span></li>
						</ul>
					</div>
				</li>
			</ul>
			<p>Il y a par contre un bug présent sur tous les derniers IE parus (sauf IE6 et 7!), et que vous pouvez observer ici:</p>
			<div class=demo>
			<ol>
				<li>level 1</li>
				<li>item</li>
				<li>item</li>
				<li><ol style="display: block">
						<li>level 2</li>
						<li>item</li>
						<li>item</li>
						<li><ol style="display: block">
								<li>level 3</li>
								<li>item</li>
								<li>item</li>
								<li><ol style="display: block">
										<li>level 4</li>
										<li>item</li>
										<li>item</li>
									</ol>
							</ol>
					</ol>
			</ol>
			</div>
			<p>Chaque sous-liste est décalée vers le bas. Ce n'est pas une marge ni un padding, c'est un bug d'IE. Pour s'en débarasser, vous pouvez soit mettre les sous-listes en float:left (ce qui pose des problèmes de flot), soit (et c'est la bonne solution) les mettre en inline-block:</p>
			<pre>li ul, li ol { display: inline-block }</pre>
			<p>Avec ça, tout rentre dans l'ordre.</p>
			<p>D'autres bugs IE6/7 relatfs aux listes, et leurs solutions, sont détaillés <a href="http://stylisticweb.com/design-tutorials/15-ie6-bugs-and-simple-solutions" target=_blank>ici</a>, mais je n'en parlerai pas car ils apparaissent dans des cas trop spécifiques.</p>
			<hr>
			<p>Parlons plutôt des choses originales qu'on peut faire avec des listes HTML:</p>
			<ul>
				<li>
					Un &lt;li> peut ne pas avoir d'&lt;ol> ou d'&lt;ul> autour. Il sera alors précédé d'un cercle (et ce, sur tous les navigateurs).
				</li>
				<li>
					Un &lt;ul> / &lt;ol> peut contenir autre choses que des &lt;li>. (des éléments HTML ou du texte). Ceux-ci seront dénués de puces ou de numéros.
				</li>
				<li>
					Il existe des moyens simples pour faire en sorte qu'une liste s'affiche sur plusieurs colonnes.<br><a href="http://alistapart.com/article/multicolumnlists" target=_blank>Cet article</a> traite ce sujet de façon exhaustive.
				</li>
				<li>
					Une liste peut ressembler à une arborescence avec une image de 1px et du CSS ingénieux: <a href="http://css-tricks.com/style-a-list-with-one-pixel/" target=_blank>voyez plutôt</a>.
				</li>
				<li>
					Les &lt;li> peuvent avoir des caractères unicode comme puces, grâce au CSS3 (et ça marche sur IE8+):
					<pre>li { list-style: none }
li:before { content: ">>"; margin:0 1em 0 -3em;  }</pre>
				Ce qui donne:
					<style style="display: none">
					.custombullet li { list-style: none }
					.custombullet li:before { content: ">>"; margin: 0 1em 0 -3em; }
					</style>
					<div class=demo>
						<ul class=custombullet>
							<li>Item 1</li>
							<li>Item 2</li>
							<li>Item 3</li>
						</ul>
					</div>
				</li>
			</ul>
			<p>Sur ce, je m'arrête là, et je vous invite à jeter un oeil à <a href="//xem.github.io/Blog" target="_blank">mon dernier projet, Basis</a>: un point de départ (ou "boilerplate", comme on dit outre-France) pour faire des pages HTML/CSS/JS, avec un CSS reset maison qui inclut toutes ces techniques pour bien gérer les listes (imbriquées) sur tous les navigateurs.</p>
			<br>
			<br>
			A bientôt!
			<br>
			<b>@MaximeEuziere</b>
	</div>
</div>



<div class=section id=contenteditable_en>
  <img src=../english.png class=lang onclick="contenteditable_en.style.display='none';contenteditable_fr.style.display='block'">
	<h2>The HTML5 contenteditable attribute</h2>
	<h3>july 2013</h3>
	<div id=contenteditablecontent_en>
		<p>The <b>contenteditable</b> attribute makes any HTML element editable with the mouse and/or the keyboard.</p>
		<p>
		This attribute is one of the <a href="http://dev.w3.org/html5/markup/global-attributes.html">HTML5 global attributes</a>, so it can be applied to all HTML5 elements.
		<br>
		It's also one of those features that existed in browsers for a long time before W3C standardization.
		<br>
		Indeed, <a href="http://caniuse.com/contenteditable">we can use this attribute</a> on browser as old as IE 5 and Firefox 3! Microsoft created it, by the way.
		</p>
		<p>
		It's easy to use: like <b>id</b> or <b>class</b>, you can use <b>contenteditable="true"</b> on any element, or simply <b>contenteditable</b>.
		<br>
		Note that this attribute is inherited by default. So the value <b>contenteditable="inherit"</b> is completely useless (but it exists).
		<br>
		However, if you want to make an element editable, but not its children, these children must have <b>contenteditable="false"</b>.
		</p>
		<p contenteditable><b>Example:</b> click on this paragraph to edit the text inside.</p>
		<hr>
		<p>Here's the list of crazy facts about <b>contenteditable</b>:</p>
		<ul>
			<li>
				Like we saw earlier, we can make an element non-editable if its parent is editable. The non-editable element can still be selected, moved and deleted.
				<p contenteditable><b>Example:</b> In this editable paragraph, <b contenteditable="false">this text in bold</b> can't be edited, but you can move and delete it with the mouse.</p>
				On Firefox, we can't move text from an editable container to another editable container... that's a bug.
			</li>
			<li>
				Firefox allows to resize images that have or inherit the <b>contenteditable</b> behavior.<br><br>
				<b>Example:</b><br>
				<p contenteditable> Click on this image <img src="http://placehold.it/200x50" style="vertical-align: middle"> to resize it.</p>
			</li>
			<li>
				Any HTML code can be inserted in an editable element
				<div contenteditable><b>Example:</b> You can copy-paste here<br><br>- The content of another Webpage:<br><br><br><br>- The content of a Word / Excel document:<br><br><br><br></div>
			</li>
			<li>
				Thanks to this attribute, we can make complete WYSIWYG editors, like <a href="http://ckeditor.com/demo#full">CKEditor</a>.
			</li>
			<li>
				You can also access to a quick notepad by typing <b>data:text/html, &lt;html contenteditable></b> in the address bar of your browser (or by clicking <a href="data:text/html, <html contenteditable>" target="_blank">here</a>).
				This trick comes from <a href="https://coderwall.com/p/lhsrcq">Jose Jesus Perez Aguinaga</a>.
				You can find many variations of this notepad <a href="https://news.ycombinator.com/item?id=5135194" target="_blank">here</a>. 
			</li>
			<li>If you make a <b>style</b> element visible and editable, this can make a crazy auto-recursive editor, in which you can edit in real time the style of the block you're writing into.<br>Try it:<br>
				<style spellcheck="false" contenteditable>style[contenteditable] {
	display: block;          /* make <style> blocks visible */
	white-space: pre;        /* presentation */
	font-family: monospace;  /* typography */
	background: #ddeeff;     /* background color */
	color: #112233;          /* text color */
}</style>
			</li>
			<li>
				<b>script</b> elements can also be visible and editable (here's an exemple). However, the JavaScript code isn't executed when you edit it. It's a simple text block.<br>
				<script contenteditable>console.log("Log unique");</script>
				<br>
				(open your F12 console to see this message)
				<br>
				But JavaScript itself allows to detect changes happening in a <b>script</b> element and execute its content.<br>
				Warning: don't do this at home (XSS attacks can occur). This example is only a proof of concept.<br> 
				<script id="js" contenteditable>// This block has the id "js".
var js = document.getElementById("js");
js.onkeyup = function(){
	eval(js.innerText);
}
console.log("Log at each edition");</script>
				<br>
				This works fine on Chrome and IE 10. Sadly, Firefox and IE9 can't listen to keystrokes events on <b>script</b> elements... But you can replace them with textareas, which are natively editable.
			</li>
		</ul>
		<br>
		<br>
		Cheers!
		<br>
		<b>@MaximeEuziere</b>
	</div>
</div>

<div class=section id=contenteditable_fr style=display:none>
  <img src=../francais.png class=lang onclick="contenteditable_fr.style.display='none';contenteditable_en.style.display='block'">
	<h2>L'attribut contenteditable en HTML5</h2>
	<h3>juillet 2013</h3>
	<div id=contenteditablecontent_fr>
		<p>L'attribut <b>contenteditable</b> permet de rendre le contenu de n'importe quel élément HTML éditable avec le clavier et/ou la souris.</p>
		<p>
		Cet attribut fait partie des <a href="http://dev.w3.org/html5/markup/global-attributes.html">attributs globaux HTML5</a>, ce qui signifie qu'il peut potentiellement être appliqué à tous les éléments HTML5.
		<br>
		Il fait également partie de ces fonctionnalités qui ont existé dans les navigateurs bien avant d'avoir été standardisées par le W3C.
		<br>
		En effet, <a href="http://caniuse.com/contenteditable">on retrouve cet attribut</a> sur des navigateurs aussi anciens qu'IE 5 et Firefox 3! C'est d'ailleurs Microsoft qui l'a créé.
		</p>
		<p>
		Pour l'utiliser, rien de plus simple: tout comme vous pouvez appliquer un attribut <b>id</b> ou <b>class</b> à un élément HTML, vous pouvez utiliser <b>contenteditable="true"</b>, ou tout simplement <b>contenteditable</b>.
		<br>
		Il est à noter que cet attribut est hérité par défaut. La valeur <b>contenteditable="inherit"</b> est donc complètement inutile.
		<br>
		Par contre, si vous voulez rendre un élément éditable mais pas ses descendants, ceux-ci doivent avoir <b>contenteditable="false"</b>.
		</p>
		<p contenteditable><b>Exemple:</b> cliquer sur ce paragraphe pour éditer le texte qui s'y trouve.</p>
		<hr>
		<p>Voici maintenant la liste des trucs dingues concernant <b>contenteditable</b>:</p>
		<ul>
			<li>
				Comme on l'a vu plus haut, on peut rendre un élément non éditable alors que son parent est éditable. L'élément non éditable pourra toutefois être sélectionné, déplacé et supprimé.
				<p contenteditable><b>Exemple:</b> Dans ce paragraphe éditable, on ne peut pas éditer <b contenteditable="false">ce texte en gras</b> mais on peut le supprimer et le déplacer à l'aide de la souris.</p>
				Sur Firefox, on ne peut pas déplacer du texte d'un bloc éditable à un autre bloc éditable. C'est un bug.
			</li>
			<li>
				Firefox permet de redimensionner les images qui ont l'attribut <b>contenteditable</b> (ou qui en héritent)<br><br>
				<b>Exemple:</b><br>
				<p contenteditable> Cliquez sur cette image <img src="http://placehold.it/200x50" style="vertical-align: middle"> pour la redimensionner.</p>
			</li>
			<li>
				On peut insérer n'importe quel code HTML dans un élément éditable
				<div contenteditable><b>Exemple:</b> copiez-collez ci-dessous<br><br>- Le contenu d'une autre page Web:<br><br><br><br>- Le contenu d'un document Word ou Excel:<br><br><br><br></div>
			</li>
			<li>
				Grâce à cet attribut, on peut faire des éditeurs WYSIWYG ultra-complets, comme <a href="http://ckeditor.com/demo#full">CKEditor</a>.
			</li>
			<li>
				On peut aussi avoir accès à un bloc-notes d'appoint en tapant <b>data:text/html, &lt;html contenteditable></b> dans la barre d'adresse de son navigateur (ou en cliquant <a href="data:text/html, <html contenteditable>" target="_blank">ici</a>).
				On doit cette astuce à <a href="https://coderwall.com/p/lhsrcq">Jose Jesus Perez Aguinaga</a>.
				Vous trouverez <a href="https://news.ycombinator.com/item?id=5135194" target="_blank">ici</a> de nombreuses variations de ce bloc-botes. 
			</li>
			<li>Rendre un élément <b>style</b> visible et éditable peut mener à un éditeur auto-récursif assez dingue, étant donné que vous pouvez editer en direct le style du bloc dans lequel vous écrivez.<br>Essayez ci-dessous:<br>
				<style spellcheck="false" contenteditable>#contenteditable_fr style[contenteditable] {
	display: block;          /* rendre vidible les blocs <style> */
	white-space: pre;        /* présentation */
	font-family: monospace;  /* typographie */
	background: #ddeeff;     /* couleur de fond */
	color: #112233;          /* couleur de texte */
}</style>
			</li>
			<li>
				On peut aussi rendre les éléments <b>script</b> visibles et éditables (en voici un exemple). Toutefois, le code JavaScript n'est pas réexécuté automatiquement à chaque modification.<br>
				<script contenteditable>console.log("Log unique");</script>
				<br>
				(ouvrez votre console F12 pour voir ce message)
				<br>
				Mais JavaScript, justement, permet de détecter les changements qui ont lieu dans un élément <b>script</b> et exécuter son contenu.<br>
				Attention toutefois, évaluer du code JS venant de vos visiteurs peut être dangereux. L'exemple qui suit n'est qu'un proof of concept!<br> 
				<script id="js" contenteditable>// Ce bloc script a l'id "js".
var js = document.getElementById("js");
js.onkeyup = function(){
	eval(js.innerText);
}
console.log("Log à chaque modification");</script>
				<br>
				Cela fonctionne très bien sur Chrome et IE 10. Firefox et IE9 sont hélas capricieux et il est compliqué de leur faire exécuter du code JS à chaque modification d'un élément <b>script</b>... A vrai dire, je ne suis même pas sûr que ça soit possible. Faute de mieux, on peut continuer à utiliser des textarea, qui sont nativement éditables et envoient les bons événements.
			</li>
		</ul>
		<br>
		<br>
		A bientôt!
		<br>
		<b>@MaximeEuziere</b>
	</div>
</div>


<div class=section id=doctype_en style=display:none>
  <img src=../english.png class=lang onclick="doctype_en.style.display='none';doctype_fr.style.display='block'">
	<h2>The HTML5 Doctype</h2>
	<h3>june 2013</h3>
  coming soon
	<!--div id=doctype>
		<p>Le doctype n'est pas un élément HTML comme les autres, c'est un préambule qui sert à dire au navigateur comment il doit afficher le reste de la page.</p>
		<p>Ce préambule existe depuis HTML2 et XHTML1. Toutefois, jusqu'à l'apparition d'HTML5, les doctypes étaient de très longues chaînes impossibles à mémoriser par coeur, et pour peu qu'on fasse une faute de frappe, les navigateurs pouvaient mal le prendre, en particulier IE qui applique des règles d'affichage ancestrales (qu'on appelle aussi "mode quirks") en cas de doctype absent ou invalide.</p>
		<p>Bref: ce qu'il faut retenir, c'est que maintenant, le doctype s'écrit comme ceci: <b>&lt;!doctype html></b>, et qu'il doit être placé tout au début du document HTML. Il est suivi de l'élément racine, à savoir <b>&lt;html></b>.</p>
		</p>Oui mais comment on fait du XHTML5 alors? La réponse est simple: ça n'existe pas. Il n'y a qu'un HTML5, et il n'est ni "X" ni "strict" ni "transitional". et ça ne l'empêche pas de bien marcher, même sur les IE préhistoriques.</p>
		<hr>
		<p>Voici maintenant la liste tant attendue des trucs de ouf concernant <b>le doctype HTML5</b>:</p>
		<ul>
			<li>Le <b>doctype</b> est insensible à la casse et peut contenir plusieurs espaces avant et après le mot "html". Vous pouvez donc l'écrire <b>&lt;!DoCtYpE &nbsp; &nbsp; HtMl &nbsp; ></b> si ça vous chante.</li>
			<li>Le <b>doctype</b> HTML5 peut contenir <a href="http://www.w3.org/html/wg/drafts/html/master/syntax.html#the-doctype" target="_blank">d'autres informations</a>, mais aucune n'est utile quand on écrit son HTML à la main ou avec un IDE moderne.
			<li>
				Le <b>doctype</b> et l'élément <b>title</b> sont les deux seuls éléments obligatoires dans un document HTML5 valide.
				<br>
				Voici le plus petit valide document HTML5:
				<pre>&lt;!doctype html>
&lt;title>&lt;/title></pre>
			</li>
			<li>
				Le doctype ne peut pas être lu, ni modifié en JavaScript, mais on peut tout de même savoir si le navigateur est en mode quirks ou en mode compatibilité comme ceci:
				<pre>if(document.compatMode === 'CSS1Compat'){
	// On est pas en mode quirks!
}
if(document.compatMode === 'BackCompat'){
	// On est en mode compatibilité!
}</pre>
				<button onclick="alert(document.compatMode!=='CSS1Compat')">Est-on en mode quirks?</button>
				<button onclick="alert(document.compatMode!=='BackCompat')">Est-on en mode compatibilité?</button> (si les deux sont "false", tout va bien)
			</li>
			<li>A propos du "mode compatibilité", qui pousse IE7, IE8, IE9 et IE10 à afficher les pages Web avec le moteur de rendu de leur prédécésseur (E6, IE7, IE8 et IE9, respectivement), de nombreuses raisons font que ce mode s'active sur IE, mais le plus souvent, c'est dû au fait qu'on visionne une page HTML qui se trouve sur son PC, ou sur un réseau local. Pour éviter ce désagrément, ouvrez IE, faites "alt" pour que le menu du haut apparaisse, allez sur "outils > paramètres d'affichage de compatibilité" et décochez "Afficher les sites intranet dans Affichage de compatibilité". Faites "OK" et redémarrez IE. C'est réglé!</li>
			<li>
				Sur IE < 9, le <b>doctype</b>, du fait qu'il commence par un <b>!</b>, est considéré comme un <b>commentaire HTML</b>. En voici la preuve:
				<pre>// Récupérons le nom du premier élément HTML de cette page dans le DOM
var premier_element = document.getElementsByTagName("*")[0].tagName;</pre>
				<button onclick="alert(document.getElementsByTagName('*')[0].tagName)">Quel est le nom du premier élément du DOM?</button> ("!" sur IE < 9, "HTML" ailleurs)
				<br>
				<br>
				(Les IE < 9 sont d'ailleurs les seuls navigateurs à inclure les commentaires (sauf les commentaires conditionnels) dans <b>document.getElementsByTagName("*")</b>, comme décrit <a href="http://lea.verou.me/2009/02/20things-you-should-know-when-not-using-a-js-library/" target="_blank">ici</a>)
			</li>
			<li>
				Le <b>doctype</b> HTML5 fait apparaitre de vilaines scrollbars autour des <b>iframes</b> sur IE6, pour <a href="http://inmyexperience.com/2003/01/iframe-and-doctype-follies.html" target="_blank">d'obscures raisons</a>, alors que les doctypes d'avant HTML4 ne le faisaient pas. Le seul moyen de les faire disparaître est d'utiliser l'attribut (hélas non standard) <b>scrolling=no</b> sur vos iframes... si vous voulez supporter IE6, bien sûr, ce que je ne vous conseille pas de faire.</li>
				Démo: iframe normale<br>
				<iframe style="width: 200px; height: 40px; border: 1px solid black;"></iframe>
				<br><br>iframe sans scrollbars sur IE6<br>
				<iframe style="width: 200px; height: 40px; border: 1px solid black;" scrolling=no></iframe>
			</li>
			<li>Il y a un autre bug sur IE, y compris IE10 (et peut-être IE11, à confirmer): si votre page est en mode quirks, et qu'elle contient des <b>iframe</b> qui ont un doctype valide, ces <b>iframe</b> s'afficheront tout de même en mode quirks!
		</ul>
		<br>
			<br>
		A bientôt!
		<br>
		<b>@MaximeEuziere</b>
	</div-->
</div>

<div class=section id=doctype_fr>
  <img src=../francais.png class=lang onclick="doctype_fr.style.display='none';doctype_en.style.display='block'">
	<h2>Le doctype HTML5</h2>
	<h3>juin 2013</h3>
	<div id=doctype>
		<p>Le doctype n'est pas un élément HTML comme les autres, c'est un préambule qui sert à dire au navigateur comment il doit afficher le reste de la page.</p>
		<p>Ce préambule existe depuis HTML2 et XHTML1. Toutefois, jusqu'à l'apparition d'HTML5, les doctypes étaient de très longues chaînes impossibles à mémoriser par coeur, et pour peu qu'on fasse une faute de frappe, les navigateurs pouvaient mal le prendre, en particulier IE qui applique des règles d'affichage ancestrales (qu'on appelle aussi "mode quirks") en cas de doctype absent ou invalide.</p>
		<p>Bref: ce qu'il faut retenir, c'est que maintenant, le doctype s'écrit comme ceci: <b>&lt;!doctype html></b>, et qu'il doit être placé tout au début du document HTML. Il est suivi de l'élément racine, à savoir <b>&lt;html></b>.</p>
		</p>Oui mais comment on fait du XHTML5 alors? La réponse est simple: ça n'existe pas. Il n'y a qu'un HTML5, et il n'est ni "X" ni "strict" ni "transitional". et ça ne l'empêche pas de bien marcher, même sur les IE préhistoriques.</p>
		<hr>
		<p>Voici maintenant la liste tant attendue des trucs de ouf concernant <b>le doctype HTML5</b>:</p>
		<ul>
			<li>Le <b>doctype</b> est insensible à la casse et peut contenir plusieurs espaces avant et après le mot "html". Vous pouvez donc l'écrire <b>&lt;!DoCtYpE &nbsp; &nbsp; HtMl &nbsp; ></b> si ça vous chante.</li>
			<li>Le <b>doctype</b> HTML5 peut contenir <a href="http://www.w3.org/html/wg/drafts/html/master/syntax.html#the-doctype" target="_blank">d'autres informations</a>, mais aucune n'est utile quand on écrit son HTML à la main ou avec un IDE moderne.
			<li>
				Le <b>doctype</b> et l'élément <b>title</b> sont les deux seuls éléments obligatoires dans un document HTML5 valide.
				<br>
				Voici le plus petit valide document HTML5:
				<pre>&lt;!doctype html>
&lt;title>&lt;/title></pre>
			</li>
			<li>
				Le doctype ne peut pas être lu, ni modifié en JavaScript, mais on peut tout de même savoir si le navigateur est en mode quirks ou en mode compatibilité comme ceci:
				<pre>if(document.compatMode === 'CSS1Compat'){
	// On est pas en mode quirks!
}
if(document.compatMode === 'BackCompat'){
	// On est en mode compatibilité!
}</pre>
				<button onclick="alert(document.compatMode!=='CSS1Compat')">Est-on en mode quirks?</button>
				<button onclick="alert(document.compatMode!=='BackCompat')">Est-on en mode compatibilité?</button> (si les deux sont "false", tout va bien)
			</li>
			<li>A propos du "mode compatibilité", qui pousse IE7, IE8, IE9 et IE10 à afficher les pages Web avec le moteur de rendu de leur prédécésseur (E6, IE7, IE8 et IE9, respectivement), de nombreuses raisons font que ce mode s'active sur IE, mais le plus souvent, c'est dû au fait qu'on visionne une page HTML qui se trouve sur son PC, ou sur un réseau local. Pour éviter ce désagrément, ouvrez IE, faites "alt" pour que le menu du haut apparaisse, allez sur "outils > paramètres d'affichage de compatibilité" et décochez "Afficher les sites intranet dans Affichage de compatibilité". Faites "OK" et redémarrez IE. C'est réglé!</li>
			<li>
				Sur IE < 9, le <b>doctype</b>, du fait qu'il commence par un <b>!</b>, est considéré comme un <b>commentaire HTML</b>. En voici la preuve:
				<pre>// Récupérons le nom du premier élément HTML de cette page dans le DOM
var premier_element = document.getElementsByTagName("*")[0].tagName;</pre>
				<button onclick="alert(document.getElementsByTagName('*')[0].tagName)">Quel est le nom du premier élément du DOM?</button> ("!" sur IE < 9, "HTML" ailleurs)
				<br>
				<br>
				(Les IE < 9 sont d'ailleurs les seuls navigateurs à inclure les commentaires (sauf les commentaires conditionnels) dans <b>document.getElementsByTagName("*")</b>, comme décrit <a href="http://lea.verou.me/2009/02/20things-you-should-know-when-not-using-a-js-library/" target="_blank">ici</a>)
			</li>
			<li>
				Le <b>doctype</b> HTML5 fait apparaitre de vilaines scrollbars autour des <b>iframes</b> sur IE6, pour <a href="http://inmyexperience.com/2003/01/iframe-and-doctype-follies.html" target="_blank">d'obscures raisons</a>, alors que les doctypes d'avant HTML4 ne le faisaient pas. Le seul moyen de les faire disparaître est d'utiliser l'attribut (hélas non standard) <b>scrolling=no</b> sur vos iframes... si vous voulez supporter IE6, bien sûr, ce que je ne vous conseille pas de faire.</li>
				Démo: iframe normale<br>
				<iframe style="width: 200px; height: 40px; border: 1px solid black;"></iframe>
				<br><br>iframe sans scrollbars sur IE6<br>
				<iframe style="width: 200px; height: 40px; border: 1px solid black;" scrolling=no></iframe>
			</li>
			<li>Il y a un autre bug sur IE, y compris IE10 (et peut-être IE11, à confirmer): si votre page est en mode quirks, et qu'elle contient des <b>iframe</b> qui ont un doctype valide, ces <b>iframe</b> s'afficheront tout de même en mode quirks!
		</ul>
		<br>
			<br>
		A bientôt!
		<br>
		<b>@MaximeEuziere</b>
	</div>
</div>
  </div>
</body>
</html>
